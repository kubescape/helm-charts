all capabilities:
  1: |+
    raw: |+
      Thank you for installing kubescape-operator version 1.29.9.
      View your cluster's configuration scanning schedule:
      > kubectl -n kubescape get cj kubescape-scheduler -o=jsonpath='{.metadata.name}{"\t"}{.spec.schedule}{"\n"}'

      To change the schedule, set `.spec.schedule`:
      > kubectl -n kubescape edit cj kubescape-scheduler
      View your cluster's image scanning schedule:
      > kubectl -n kubescape get cj kubevuln-scheduler -o=jsonpath='{.metadata.name}{"\t"}{.spec.schedule}{"\n"}'

      To change the schedule, edit `.spec.schedule`:
      > kubectl -n kubescape edit cj kubevuln-scheduler

      View your image vulnerabilities scan summaries:
      > kubectl get vulnerabilitymanifestsummaries -A

      Detailed reports are also available:
      > kubectl get vulnerabilitymanifests -A

      kubescape-operator generates suggested network policies. To view them:
      > kubectl get generatednetworkpolicies -n <namespace>

  2: |
    apiVersion: batch/v1
    kind: CronJob
    metadata:
      annotations:
        helm.sh/resource-policy: keep
      labels:
        app: helm-release-upgrader
        app.kubernetes.io/component: helm-release-upgrader
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: helm-release-upgrader
      namespace: kubescape
    spec:
      failedJobsHistoryLimit: 1
      jobTemplate:
        spec:
          template:
            metadata:
              annotations: null
              labels:
                app: helm-release-upgrader
                app.kubernetes.io/component: helm-release-upgrader
                app.kubernetes.io/instance: RELEASE-NAME
                app.kubernetes.io/managed-by: Helm
                app.kubernetes.io/name: kubescape-operator
                app.kubernetes.io/part-of: kubescape
                app.kubernetes.io/version: 1.29.9
                helm.sh/chart: kubescape-operator-1.29.9
                kubescape.io/ignore: "true"
                tier: ks-control-plane
            spec:
              affinity: null
              containers:
                - env:
                    - name: HELM_CACHE_HOME
                      value: /data/helm-scratch-data/.cache
                    - name: HELM_CONFIG_HOME
                      value: /data/helm-scratch-data/.config
                    - name: HELM_DATA_HOME
                      value: /data/helm-scratch-data/.data
                  image: quay.io/kubescape/helm-release-upgrader:v0.1.0
                  imagePullPolicy: IfNotPresent
                  name: helm-release-upgrader
                  resources:
                    limits:
                      cpu: 500m
                      memory: 256Mi
                    requests:
                      cpu: 500m
                      memory: 256Mi
                  securityContext:
                    allowPrivilegeEscalation: false
                    readOnlyRootFilesystem: true
                  volumeMounts:
                    - mountPath: /data/helm-scratch-data
                      name: helm-scratch-data
              nodeSelector:
                kubernetes.io/os: linux
              restartPolicy: OnFailure
              securityContext:
                fsGroup: 1000
                runAsGroup: 1000
                runAsNonRoot: true
                runAsUser: 1000
              serviceAccountName: helm-release-upgrader
              tolerations: null
              volumes:
                - emptyDir:
                    sizeLimit: 500Mi
                  name: helm-scratch-data
      schedule: 0 14 * * *
      successfulJobsHistoryLimit: 3
  3: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      labels:
        app: helm-release-upgrader
        app.kubernetes.io/component: helm-release-upgrader
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: helm-release-upgrader
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
      podSelector:
        matchLabels:
          app.kubernetes.io/component: helm-release-upgrader
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Egress
  4: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations:
        helm.sh/resource-policy: keep
      labels:
        app: helm-release-upgrader
        app.kubernetes.io/component: helm-release-upgrader
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: helm-release-upgrader
    rules:
      - apiGroups:
          - '*'
        resources:
          - '*'
        verbs:
          - '*'
  5: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations:
        helm.sh/resource-policy: keep
      labels:
        app: helm-release-upgrader
        app.kubernetes.io/component: helm-release-upgrader
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: helm-release-upgrader
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: helm-release-upgrader
    subjects:
      - kind: ServiceAccount
        name: helm-release-upgrader
        namespace: kubescape
  6: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations:
        helm.sh/resource-policy: keep
      labels:
        app: helm-release-upgrader
        app.kubernetes.io/component: helm-release-upgrader
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: helm-release-upgrader
      namespace: kubescape
  7: |
    apiVersion: v1
    data:
      accessKey: ZjMwNGQ3M2ItZDQzYy00MTJiLTgyZWEtZTRjODU5NDkzY2U2
      account: OWU2YzBjMmMtNmJkMC00OTE5LTgxNWItNTUwMzBkZTdjOWEw
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: cloud-secret
        app.kubernetes.io/component: cloud-secret
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/infra: credentials
        tier: ks-control-plane
      name: cloud-secret
      namespace: kubescape
    type: Opaque
  8: |
    apiVersion: v1
    data:
      clusterData: |
        {
          "serviceDiscovery": true,
          "vulnScanURL": "kubevuln:8080",
          "kubevulnURL": "kubevuln:8080",
          "kubescapeURL": "kubescape:8080",
          "clusterName": "kind-kind",
          "storage": true,
          "relevantImageVulnerabilitiesEnabled": true,
          "namespace": "kubescape",
          "imageVulnerabilitiesScanningEnabled": true,
          "postureScanEnabled": true,
          "otelCollector": false,
          "nodeAgent": "true",
          "maxImageSize": 5.36870912e+09,
          "maxSBOMSize": 2.097152e+07,
          "keepLocal": false,
          "scanTimeout": "5m",
          "scanEmbeddedSBOMs": true,
          "vexGeneration": true,
          "useDefaultMatchers": true,
          "storeFilteredSbom": true,
          "continuousPostureScan": false,
          "listingURL": "http://grype-offline-db:80/databases",
          "relevantImageVulnerabilitiesConfiguration": "enable"
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/infra: config
        kubescape.io/tier: core
        tier: ks-control-plane
      name: ks-cloud-config
      namespace: kubescape
  9: |
    apiVersion: v1
    data:
      capabilities: |
        {
          "capabilities":{"admissionController":"enable","autoUpgrading":"enable","configurationScan":"enable","continuousScan":"enable","httpDetection":"enable","kubescapeOffline":"disable","linuxAudit":"enable","malwareDetection":"enable","manageWorkloads":"enable","networkEventsStreaming":"enable","networkPolicyService":"enable","nodeProfileService":"enable","nodeSbomGeneration":"enable","nodeScan":"enable","prometheusExporter":"enable","relevancy":"enable","runtimeDetection":"enable","runtimeObservability":"enable","scanEmbeddedSBOMs":"enable","seccompProfileService":"enable","syncSBOM":"enable","testing":{"nodeAgentMultiplication":{"enabled":false,"replicas":5}},"vexGeneration":"enable","vulnerabilityScan":"enable"},
          "components":{"autoUpdater":{"enabled":true},"clamAV":{"enabled":true},"cloudSecret":{"create":true,"name":"cloud-secret"},"customCaCertificates":{"name":"custom-ca-certificates"},"hostScanner":{"enabled":true},"kubescape":{"enabled":true},"kubescapeScheduler":{"enabled":true},"kubevuln":{"enabled":true},"kubevulnScheduler":{"enabled":true},"nodeAgent":{"enabled":true},"operator":{"enabled":true},"otelCollector":{"enabled":false},"prometheusExporter":{"enabled":true},"serviceDiscovery":{"enabled":true},"storage":{"enabled":true},"synchronizer":{"enabled":true}},
          "configurations":{"excludeJsonPaths":[".containers[*].env[?(@.name==\"KUBECONFIG\")]"],"otelUrl":"otelCollector.svc.monitoring:4317","persistence":"enable","priorityClass":{"daemonset":100000100,"enabled":true},"prometheusAnnotations":"disable"} ,
          "serviceScanConfig" :{"enabled":false,"interval":"1h"}
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-capabilities
        app.kubernetes.io/component: ks-capabilities
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: ks-capabilities
      namespace: kubescape
  10: |
    apiVersion: v1
    data:
      ca-certificates.crt: Zm9v
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: custom-ca-certificates
        app.kubernetes.io/component: custom-ca-certificates
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/infra: credentials
        tier: ks-control-plane
      name: custom-ca-certificates
      namespace: kubescape
    type: Opaque
  11: |
    apiVersion: v1
    data:
      matchingRules.json: |
        {"match":[{"apiGroups":["apps"],"apiVersions":["v1"],"resources":["deployments"]}],"namespaces":["default"]}
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: cs-matching-rules
      namespace: kubescape
  12: |
    apiVersion: scheduling.k8s.io/v1
    description: This priority class is for node-agent daemonset pods
    globalDefault: false
    kind: PriorityClass
    metadata:
      annotations: null
      labels:
        app: kubescape-critical
        app.kubernetes.io/component: kubescape-critical
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-critical
    value: 1.000001e+08
  13: |
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      labels:
        app: linux-audit-rules
        app.kubernetes.io/component: linux-audit-rules
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: linuxauditrules.kubescape.io
    spec:
      group: kubescape.io
      names:
        kind: LinuxAuditRule
        plural: linuxauditrules
        shortNames:
          - lar
          - linuxauditrule
          - auditrule
        singular: linuxauditrule
      scope: Namespaced
      versions:
        - additionalPrinterColumns:
            - description: Whether the Linux audit rules are enabled
              jsonPath: .spec.enabled
              name: Enabled
              type: boolean
            - description: Number of Linux audit rules defined
              jsonPath: .status.appliedRules
              name: Rules
              type: integer
            - description: Status of the Linux audit rules
              jsonPath: .status.conditions[?(@.type=="Ready")].status
              name: Status
              type: string
            - jsonPath: .metadata.creationTimestamp
              name: Age
              type: date
          name: v1
          schema:
            openAPIV3Schema:
              properties:
                spec:
                  properties:
                    enabled:
                      default: true
                      description: Controls whether these rules should be active
                      type: boolean
                    nodeSelector:
                      additionalProperties:
                        type: string
                      description: Node selector to target specific nodes
                      type: object
                    rateLimit:
                      description: Rate limiting configuration
                      properties:
                        burstSize:
                          description: Burst size for rate limiting
                          minimum: 1
                          type: integer
                        eventsPerSecond:
                          description: Maximum events per second
                          minimum: 1
                          type: integer
                      type: object
                    rules:
                      description: List of audit rule definitions
                      items:
                        properties:
                          description:
                            description: Human-readable description of what this rule monitors
                            type: string
                          enabled:
                            default: true
                            description: Controls whether this specific rule is active
                            type: boolean
                          fileWatch:
                            description: File system monitoring rule
                            properties:
                              exclude:
                                description: Exclude patterns (basic glob patterns)
                                items:
                                  type: string
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              paths:
                                description: Paths to monitor
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              permissions:
                                description: Permissions to monitor
                                items:
                                  enum:
                                    - read
                                    - write
                                    - attr
                                    - attribute
                                    - execute
                                  type: string
                                minItems: 1
                                type: array
                              recursive:
                                default: false
                                description: Recursive monitoring (future use)
                                type: boolean
                            required:
                              - paths
                              - permissions
                              - keys
                            type: object
                          name:
                            description: Unique name of this rule within the CRD
                            type: string
                          network:
                            description: Network monitoring rule (future extension)
                            properties:
                              addresses:
                                description: Addresses to monitor
                                items:
                                  type: string
                                type: array
                              direction:
                                description: Traffic direction
                                enum:
                                  - inbound
                                  - outbound
                                  - both
                                type: string
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              ports:
                                description: Ports to monitor
                                items:
                                  maximum: 65535
                                  minimum: 1
                                  type: integer
                                type: array
                              protocols:
                                description: Protocols to monitor
                                items:
                                  enum:
                                    - tcp
                                    - udp
                                    - icmp
                                  type: string
                                type: array
                            required:
                              - keys
                            type: object
                          priority:
                            default: 100
                            description: Priority for rule ordering (lower = higher priority)
                            maximum: 1000
                            minimum: 1
                            type: integer
                          process:
                            description: Process monitoring rule
                            properties:
                              arguments:
                                description: Command line argument patterns
                                items:
                                  type: string
                                type: array
                              executables:
                                description: Executables to monitor (path patterns)
                                items:
                                  type: string
                                type: array
                              filters:
                                description: Additional filters
                                items:
                                  properties:
                                    field:
                                      description: Field to filter on
                                      type: string
                                    operator:
                                      description: Comparison operator
                                      enum:
                                        - =
                                        - '!='
                                        - <
                                        - '>'
                                        - <=
                                        - '>='
                                      type: string
                                    value:
                                      description: Value to compare against
                                      type: string
                                  required:
                                    - field
                                    - operator
                                    - value
                                  type: object
                                type: array
                              groups:
                                description: Groups to monitor
                                items:
                                  type: string
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              users:
                                description: Users to monitor
                                items:
                                  type: string
                                type: array
                            required:
                              - keys
                            type: object
                          rawRule:
                            description: Raw auditctl format rule (fallback for complex rules)
                            type: string
                          syscall:
                            description: System call monitoring rule
                            properties:
                              action:
                                default: always
                                description: Action to take
                                enum:
                                  - always
                                  - never
                                type: string
                              architecture:
                                description: Architecture filters
                                items:
                                  enum:
                                    - b64
                                    - b32
                                  type: string
                                type: array
                              filters:
                                description: Filters for syscall parameters
                                items:
                                  properties:
                                    field:
                                      description: Field to filter on
                                      enum:
                                        - pid
                                        - ppid
                                        - uid
                                        - gid
                                        - euid
                                        - egid
                                        - auid
                                        - exe
                                        - comm
                                        - key
                                        - exit
                                        - success
                                        - dir
                                        - path
                                        - perm
                                        - arch
                                        - a0
                                        - a1
                                        - a2
                                        - a3
                                        - a4
                                        - a5
                                        - a6
                                        - a7
                                        - a8
                                        - a9
                                        - a10
                                        - a11
                                        - a12
                                        - a13
                                        - a14
                                        - a15
                                      type: string
                                    operator:
                                      description: Comparison operator
                                      enum:
                                        - =
                                        - '!='
                                        - <
                                        - '>'
                                        - <=
                                        - '>='
                                      type: string
                                    value:
                                      description: Value to compare against
                                      type: string
                                  required:
                                    - field
                                    - operator
                                    - value
                                  type: object
                                maxItems: 20
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              list:
                                default: exit
                                description: Audit list type
                                enum:
                                  - task
                                  - exit
                                  - user
                                  - exclude
                                type: string
                              syscalls:
                                description: System calls to monitor
                                items:
                                  type: string
                                minItems: 1
                                type: array
                            required:
                              - syscalls
                            type: object
                        required:
                          - name
                        type: object
                      type: array
                  type: object
                status:
                  properties:
                    appliedRules:
                      description: Number of rules successfully applied to the kernel
                      minimum: 0
                      type: integer
                    conditions:
                      description: Current conditions of the AuditRule
                      items:
                        properties:
                          lastTransitionTime:
                            description: Last time the condition transitioned
                            format: date-time
                            type: string
                          message:
                            description: Human-readable message about the transition
                            type: string
                          reason:
                            description: Reason for the condition's last transition
                            type: string
                          status:
                            description: Status of the condition
                            enum:
                              - "True"
                              - "False"
                              - Unknown
                            type: string
                          type:
                            description: Type of condition
                            enum:
                              - Ready
                              - Progressing
                              - Failed
                            type: string
                        required:
                          - type
                          - status
                          - lastTransitionTime
                        type: object
                      type: array
                    failedRules:
                      description: Rules that failed to apply
                      items:
                        properties:
                          error:
                            description: Error message describing the failure
                            type: string
                          lastAttempt:
                            description: When we last tried to apply this rule
                            format: date-time
                            type: string
                          name:
                            description: Name of the failed rule
                            type: string
                        required:
                          - name
                          - error
                        type: object
                      type: array
                    lastUpdated:
                      description: When the rules were last updated
                      format: date-time
                      type: string
                    observedGeneration:
                      description: Generation of the most recently observed AuditRule
                      type: integer
                  type: object
              type: object
          served: true
          storage: true
          subresources:
            status: {}
  14: |
    apiVersion: batch/v1
    kind: CronJob
    metadata:
      annotations: null
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        armo.tier: vuln-scan
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
    spec:
      failedJobsHistoryLimit: 1
      jobTemplate:
        spec:
          template:
            metadata:
              annotations:
                foo: bar
              labels:
                app: grype-offline-db
                app.kubernetes.io/component: grype-offline-db
                app.kubernetes.io/instance: RELEASE-NAME
                app.kubernetes.io/managed-by: Helm
                app.kubernetes.io/name: kubescape-operator
                app.kubernetes.io/part-of: kubescape
                app.kubernetes.io/version: 1.29.9
                armo.tier: vuln-scan
                bar: baz
                helm.sh/chart: kubescape-operator-1.29.9
                kubescape.io/ignore: "true"
                kubescape.io/tier: core
                tier: ks-control-plane
            spec:
              affinity: null
              automountServiceAccountToken: true
              containers:
                - args:
                    - |
                      kubectl rollout restart deployment -n kubescape grype-offline-db
                  command:
                    - /bin/sh
                    - -c
                  image: quay.io/kubescape/kubectl:1.30.3
                  imagePullPolicy: IfNotPresent
                  name: grype-offline-db
                  resources:
                    limits:
                      cpu: 100m
                      memory: 50Mi
                    requests:
                      cpu: 10m
                      memory: 10Mi
                  securityContext:
                    allowPrivilegeEscalation: false
                    readOnlyRootFilesystem: true
                    runAsNonRoot: true
                    runAsUser: 100
              imagePullSecrets:
                - name: foo
                - name: bar
              nodeSelector:
                kubernetes.io/os: linux
              restartPolicy: Never
              securityContext:
                seccompProfile:
                  type: RuntimeDefault
              serviceAccountName: grype-offline-db
              tolerations: null
      schedule: 5 0 * * *
      successfulJobsHistoryLimit: 3
  15: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: grype-offline-db
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          annotations:
            foo: bar
          labels:
            app: grype-offline-db
            app.kubernetes.io/component: grype-offline-db
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            bar: baz
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          containers:
            - image: quay.io/kubescape/grype-offline-db:latest
              imagePullPolicy: Always
              name: grype-offline-db
              ports:
                - containerPort: 8080
                  protocol: TCP
              resources:
                limits:
                  cpu: 150m
                  memory: 200Mi
                requests:
                  cpu: 150m
                  memory: 200Mi
              securityContext:
                allowPrivilegeEscalation: false
                runAsNonRoot: true
          imagePullSecrets:
            - name: foo
            - name: bar
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            seccompProfile:
              type: RuntimeDefault
          tolerations: null
  16: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
    spec:
      ingress:
        - from:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: kubevuln
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
          ports:
            - port: 8080
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: grype-offline-db
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
  17: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
    rules:
      - apiGroups:
          - apps
        resources:
          - deployments
        verbs:
          - get
          - patch
  18: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: grype-offline-db
    subjects:
      - kind: ServiceAccount
        name: grype-offline-db
        namespace: kubescape
  19: |
    apiVersion: v1
    kind: Service
    metadata:
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
    spec:
      ports:
        - port: 80
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  20: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
  21: |
    apiVersion: v1
    data:
      request-body.json: '{"commands":[{"CommandName":"kubescapeScan","args":{"scanV1":{}}}]}'
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: kubescape-scheduler
        app.kubernetes.io/component: kubescape-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-scheduler
      namespace: kubescape
  22: |
    apiVersion: batch/v1
    kind: CronJob
    metadata:
      annotations: null
      labels:
        app: kubescape-scheduler
        app.kubernetes.io/component: kubescape-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        armo.tier: kubescape-scan
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-scheduler
      namespace: kubescape
    spec:
      failedJobsHistoryLimit: 1
      jobTemplate:
        spec:
          template:
            metadata:
              annotations: null
              labels:
                app: kubescape-scheduler
                app.kubernetes.io/component: kubescape-scheduler
                app.kubernetes.io/instance: RELEASE-NAME
                app.kubernetes.io/managed-by: Helm
                app.kubernetes.io/name: kubescape-operator
                app.kubernetes.io/part-of: kubescape
                app.kubernetes.io/version: 1.29.9
                armo.tier: kubescape-scan
                helm.sh/chart: kubescape-operator-1.29.9
                kubescape.io/ignore: "true"
                kubescape.io/tier: core
                tier: ks-control-plane
            spec:
              affinity: null
              automountServiceAccountToken: false
              containers:
                - args:
                    - -method=post
                    - -scheme=http
                    - -host=operator:4002
                    - -path=v1/triggerAction
                    - -headers=Content-Type:application/json
                    - -path-body=/home/ks/request-body.json
                  image: quay.io/kubescape/http-request:v0.2.14
                  imagePullPolicy: IfNotPresent
                  name: kubescape-scheduler
                  resources:
                    limits:
                      cpu: 10m
                      memory: 20Mi
                    requests:
                      cpu: 1m
                      memory: 10Mi
                  securityContext:
                    allowPrivilegeEscalation: false
                    readOnlyRootFilesystem: true
                    runAsNonRoot: true
                    runAsUser: 100
                  volumeMounts:
                    - mountPath: /home/ks/request-body.json
                      name: kubescape-scheduler
                      readOnly: true
                      subPath: request-body.json
              imagePullSecrets:
                - name: foo
                - name: bar
              nodeSelector:
                kubernetes.io/os: linux
              restartPolicy: Never
              securityContext:
                seccompProfile:
                  type: RuntimeDefault
              serviceAccountName: kubescape
              tolerations: null
              volumes:
                - configMap:
                    name: kubescape-scheduler
                  name: kubescape-scheduler
      schedule: 1 2 3 4 5
      successfulJobsHistoryLimit: 3
  23: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      labels:
        app: kubescape-scheduler
        app.kubernetes.io/component: kubescape-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-scheduler
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
        - ports:
            - port: 4002
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: operator
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
      podSelector:
        matchLabels:
          app.kubernetes.io/component: kubescape-scheduler
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Egress
  24: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - pods
          - pods/proxy
          - namespaces
          - nodes
          - configmaps
          - services
          - serviceaccounts
          - endpoints
          - persistentvolumeclaims
          - persistentvolumes
          - limitranges
          - replicationcontrollers
          - podtemplates
          - resourcequotas
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - secrets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - admissionregistration.k8s.io
        resources:
          - mutatingwebhookconfigurations
          - validatingwebhookconfigurations
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apiregistration.k8s.io
        resources:
          - apiservices
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - deployments
          - statefulsets
          - daemonsets
          - replicasets
          - controllerrevisions
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - autoscaling
        resources:
          - horizontalpodautoscalers
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - coordination.k8s.io
        resources:
          - leases
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - discovery.k8s.io
        resources:
          - endpointslices
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - events.k8s.io
        resources:
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - hostdata.kubescape.cloud
        resources:
          - APIServerInfo
          - ControlPlaneInfo
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - networking.k8s.io
        resources:
          - networkpolicies
          - Ingress
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - cilium.io
        resources:
          - ciliumnetworkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - projectcalico.org
        resources:
          - networkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - networking.istio.io
        resources:
          - gateways
          - virtualservices
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - security.istio.io
        resources:
          - authorizationpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - policy
        resources:
          - poddisruptionbudgets
          - podsecuritypolicies
          - PodSecurityPolicy
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - rbac.authorization.k8s.io
        resources:
          - clusterroles
          - clusterrolebindings
          - roles
          - rolebindings
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - storage.k8s.io
        resources:
          - csistoragecapacities
          - storageclasses
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - networking.k8s.io
        resources:
          - ingresses
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - extensions
        resources:
          - Ingress
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - gateway.networking.k8s.io
        resources:
          - httproutes
          - gateways
          - gatewayclasses
          - tcproutes
          - tlsroutes
          - udproutes
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - namespaces
        verbs:
          - update
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - workloadconfigurationscans
          - workloadconfigurationscansummaries
        verbs:
          - create
          - get
          - update
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
  25: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: kubescape
    subjects:
      - kind: ServiceAccount
        name: kubescape
        namespace: kubescape
  26: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: kubescape
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          annotations:
            checksum/cloud-config: aaeeb6b6b35a5ebbb0893822c4bf9cd860fba6d3df3bc4e77c8dbdd5841db120
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/host-scanner-configmap: 6cf2370947bbd9d1c99183fc2c6dac64d0fcd79df984c60644c1f3634dd98bfb
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
          labels:
            app: kubescape
            app.kubernetes.io/component: kubescape
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - command:
                - ksserver
              env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: KS_DOWNLOAD_ARTIFACTS
                  value: "true"
                - name: RULE_PROCESSING_GOMAXPROCS
                  value: ""
                - name: KS_DEFAULT_CONFIGMAP_NAME
                  value: kubescape-config
                - name: KS_DEFAULT_CONFIGMAP_NAMESPACE
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: KS_CONTEXT
                  value: kind-kind
                - name: KS_DEFAULT_CLOUD_CONFIGMAP_NAME
                  value: ks-cloud-config
                - name: KS_ENABLE_HOST_SCANNER
                  value: "true"
                - name: KS_SKIP_UPDATE_CHECK
                  value: "false"
                - name: KS_HOST_SCAN_YAML
                  value: /home/nonroot/.kubescape/host-scanner.yaml
                - name: LARGE_CLUSTER_SIZE
                  value: "1500"
                - name: AZURE_SUBSCRIPTION_ID
                  valueFrom:
                    secretKeyRef:
                      key: aksSubscriptionID
                      name: kubescape-secret
                - name: AZURE_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: aksClientID
                      name: kubescape-secret
                - name: AZURE_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: aksClientSecret
                      name: kubescape-secret
                - name: AZURE_TENANT_ID
                  valueFrom:
                    secretKeyRef:
                      key: aksTenantID
                      name: kubescape-secret
                - name: AZURE_RESOURCE_GROUP
                  valueFrom:
                    secretKeyRef:
                      key: aksResourceGroup
                      name: kubescape-secret
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
                - name: KS_INCLUDE_NAMESPACES
                  value: my-namespace
              image: quay.io/kubescape/kubescape:v3.0.41
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 8080
                initialDelaySeconds: 3
                periodSeconds: 3
              name: kubescape
              ports:
                - containerPort: 8080
                  name: http
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 8080
                initialDelaySeconds: 3
                periodSeconds: 3
              resources:
                limits:
                  cpu: 600m
                  memory: 1Gi
                requests:
                  cpu: 250m
                  memory: 400Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /home/nonroot/.kubescape
                  name: kubescape-volume
                  subPath: config.json
                - mountPath: /home/nonroot/.kubescape/host-scanner.yaml
                  name: host-scanner-definition
                  subPath: host-scanner-yaml
                - mountPath: /home/nonroot/results
                  name: results
                - mountPath: /home/nonroot/failed
                  name: failed
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/services.json
                  name: services
                  readOnly: true
                  subPath: services.json
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
                - mountPath: /etc/ssl/certs/ca-certificates.crt
                  name: custom-ca-certificates
                  subPath: ca-certificates.crt
          imagePullSecrets:
            - name: foo
            - name: bar
          initContainers:
            - args:
                - -method=get
                - -scheme=https
                - -host=api.armosec.io
                - -path=api/v2/servicediscovery
                - -path-output=/data/services.json
              env:
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
              image: quay.io/kubescape/http-request:v0.2.14
              imagePullPolicy: IfNotPresent
              name: url-discovery
              resources:
                limits:
                  cpu: 100m
                  memory: 50Mi
                requests:
                  cpu: 10m
                  memory: 10Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: services
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: kubescape
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: custom-ca-certificates
              secret:
                secretName: custom-ca-certificates
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - emptyDir: {}
              name: services
            - configMap:
                name: host-scanner-definition
              name: host-scanner-definition
            - emptyDir: {}
              name: kubescape-volume
            - emptyDir: {}
              name: results
            - emptyDir: {}
              name: failed
  27: |
    apiVersion: v1
    data:
      host-scanner-yaml: "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: host-scanner\n  namespace: kubescape\n  annotations:\n    \n  labels:\n    helm.sh/chart: kubescape-operator-1.29.9\n    app.kubernetes.io/name: kubescape-operator\n    app.kubernetes.io/instance: RELEASE-NAME\n    app.kubernetes.io/component: host-scanner\n    app.kubernetes.io/version: \"1.29.9\"\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/part-of: kubescape\n    app: host-scanner\n    tier: ks-control-plane\n    kubescape.io/ignore: \"true\"\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: kubescape-operator\n      app.kubernetes.io/instance: RELEASE-NAME\n      app.kubernetes.io/component: host-scanner\n  template:\n    metadata:\n      annotations:\n        \n      labels:\n        helm.sh/chart: kubescape-operator-1.29.9\n        app.kubernetes.io/name: kubescape-operator\n        app.kubernetes.io/instance: RELEASE-NAME\n        app.kubernetes.io/component: host-scanner\n        app.kubernetes.io/version: \"1.29.9\"\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/part-of: kubescape\n        app: host-scanner\n        tier: ks-control-plane\n        kubescape.io/ignore: \"true\"\n        kubescape.io/tier: \"core\"\n        name: host-scanner\n    spec:\n      nodeSelector:\n        kubernetes.io/os: linux\n      affinity:\n      tolerations:\n        - effect: NoSchedule\n          key: node-role.kubernetes.io/control-plane\n          operator: Exists\n        - effect: NoSchedule\n          key: node-role.kubernetes.io/master\n          operator: Exists\n      imagePullSecrets:\n      - name: foo\n      - name: bar\n      containers:\n      - name: host-sensor\n        image: \"quay.io/kubescape/host-scanner:v1.0.76\"\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: true\n          privileged: true\n          readOnlyRootFilesystem: true\n          procMount: Unmasked\n        env:\n        - name: KS_LOGGER_LEVEL\n          value: \"info\"\n        - name: KS_LOGGER_NAME\n          value: \"zap\"\n        - name: OTEL_COLLECTOR_SVC\n          value: otelCollector.svc.monitoring:4317\n        ports:\n          - name: scanner # Do not change port name\n            containerPort: 7888\n            protocol: TCP\n        resources:\n          limits:\n            cpu: 0.4m\n            memory: 400Mi\n          requests:\n            cpu: 0.1m\n            memory: 200Mi\n        volumeMounts:\n        - mountPath: /host_fs\n          name: host-filesystem\n        startupProbe:\n          httpGet:\n            path: /readyz\n            port: 7888\n          failureThreshold: 30\n          periodSeconds: 1\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 7888\n          periodSeconds: 10\n      terminationGracePeriodSeconds: 120\n      dnsPolicy: ClusterFirstWithHostNet\n      serviceAccountName: node-agent\n      automountServiceAccountToken: false\n      volumes:\n      - hostPath:\n          path: /\n          type: Directory\n        name: host-filesystem\n      hostPID: true\n      hostIPC: true"
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: host-scanner-definition
      namespace: kubescape
  28: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
        - ports:
            - port: 80
              protocol: TCP
          to:
            - ipBlock:
                cidr: 169.254.169.254/32
        - ports:
            - port: 443
              protocol: TCP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: default
              podSelector:
                matchLabels:
                  component: apiserver
                  provider: kubernetes
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
      ingress:
        - from:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: operator
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
          ports:
            - port: http
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: kubescape
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
        - Egress
  29: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    rules:
      - apiGroups:
          - apps
        resources:
          - daemonsets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  30: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: kubescape
    subjects:
      - kind: ServiceAccount
        name: kubescape
        namespace: kubescape
  31: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-scc
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:openshift:scc:nonroot-v2
    subjects:
      - kind: ServiceAccount
        name: kubescape
        namespace: kubescape
  32: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    spec:
      ports:
        - name: http
          port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  33: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
  34: |
    apiVersion: monitoring.coreos.com/v1
    kind: ServiceMonitor
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-monitor
      namespace: kubescape
    spec:
      endpoints:
        - interval: 200s
          path: /v1/metrics
          port: http
          scrapeTimeout: 150s
      namespaceSelector:
        matchNames:
          - kubescape
      selector:
        matchLabels:
          app.kubernetes.io/component: kubescape
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
  35: |
    apiVersion: v1
    data:
      request-body.json: '{"commands":[{"commandName":"scan","designators":[{"designatorType":"Attributes","attributes":{}}]}]}'
    kind: ConfigMap
    metadata:
      labels:
        app: kubevuln-scheduler
        app.kubernetes.io/component: kubevuln-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-scheduler
      namespace: kubescape
  36: |
    apiVersion: batch/v1
    kind: CronJob
    metadata:
      annotations: null
      labels:
        app: kubevuln-scheduler
        app.kubernetes.io/component: kubevuln-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        armo.tier: vuln-scan
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-scheduler
      namespace: kubescape
    spec:
      failedJobsHistoryLimit: 1
      jobTemplate:
        spec:
          template:
            metadata:
              annotations: null
              labels:
                app: kubevuln-scheduler
                app.kubernetes.io/component: kubevuln-scheduler
                app.kubernetes.io/instance: RELEASE-NAME
                app.kubernetes.io/managed-by: Helm
                app.kubernetes.io/name: kubescape-operator
                app.kubernetes.io/part-of: kubescape
                app.kubernetes.io/version: 1.29.9
                armo.tier: vuln-scan
                helm.sh/chart: kubescape-operator-1.29.9
                kubescape.io/ignore: "true"
                kubescape.io/tier: core
                tier: ks-control-plane
            spec:
              affinity: null
              automountServiceAccountToken: false
              containers:
                - args:
                    - -method=post
                    - -scheme=http
                    - -host=operator:4002
                    - -path=v1/triggerAction
                    - -headers=Content-Type:application/json
                    - -path-body=/home/ks/request-body.json
                  image: quay.io/kubescape/http-request:v0.2.14
                  imagePullPolicy: IfNotPresent
                  name: kubevuln-scheduler
                  resources:
                    limits:
                      cpu: 10m
                      memory: 20Mi
                    requests:
                      cpu: 1m
                      memory: 10Mi
                  securityContext:
                    allowPrivilegeEscalation: false
                    readOnlyRootFilesystem: true
                    runAsNonRoot: true
                    runAsUser: 100
                  volumeMounts:
                    - mountPath: /home/ks/request-body.json
                      name: kubevuln-scheduler
                      readOnly: true
                      subPath: request-body.json
              imagePullSecrets:
                - name: foo
                - name: bar
              nodeSelector:
                kubernetes.io/os: linux
              restartPolicy: Never
              securityContext:
                seccompProfile:
                  type: RuntimeDefault
              serviceAccountName: kubevuln
              tolerations: null
              volumes:
                - configMap:
                    name: kubevuln-scheduler
                  name: kubevuln-scheduler
      schedule: 1 2 3 4 5
      successfulJobsHistoryLimit: 3
  37: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      labels:
        app: kubevuln-scheduler
        app.kubernetes.io/component: kubevuln-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln-scheduler
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
        - ports:
            - port: 4002
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: operator
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
      podSelector:
        matchLabels:
          app.kubernetes.io/component: kubevuln-scheduler
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Egress
  38: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
    rules:
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - vulnerabilitymanifests
          - vulnerabilitymanifestsummaries
          - openvulnerabilityexchangecontainers
          - sbomsyfts
          - sbomsyftfiltereds
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - containerprofiles
        verbs:
          - get
          - watch
          - list
  39: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: kubevuln
    subjects:
      - kind: ServiceAccount
        name: kubevuln
        namespace: kubescape
  40: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: kubevuln
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations:
            checksum/cloud-config: aaeeb6b6b35a5ebbb0893822c4bf9cd860fba6d3df3bc4e77c8dbdd5841db120
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
          labels:
            app: kubevuln
            app.kubernetes.io/component: kubevuln
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - args:
                - -alsologtostderr
                - -v=4
                - 2>&1
              env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: PRINT_POST_JSON
                  value: ""
                - name: CA_MAX_VULN_SCAN_ROUTINES
                  value: "1"
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
              image: quay.io/kubescape/kubevuln:v0.3.93
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /v1/liveness
                  port: 8080
                initialDelaySeconds: 3
                periodSeconds: 3
              name: kubevuln
              ports:
                - containerPort: 8080
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /v1/readiness
                  port: 8080
              resources:
                limits:
                  cpu: 1500m
                  ephemeral-storage: 10Gi
                  memory: 5000Mi
                requests:
                  cpu: 300m
                  ephemeral-storage: 5Gi
                  memory: 1000Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /tmp
                  name: tmp-dir
                - mountPath: /home/nonroot/anchore-resources/db
                  name: grype-db-cache
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/services.json
                  name: services
                  readOnly: true
                  subPath: services.json
                - mountPath: /home/nonroot/.cache/grype
                  name: grype-db
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
                - mountPath: /etc/ssl/certs/ca-certificates.crt
                  name: custom-ca-certificates
                  subPath: ca-certificates.crt
          imagePullSecrets:
            - name: foo
            - name: bar
          initContainers:
            - args:
                - -method=get
                - -scheme=https
                - -host=api.armosec.io
                - -path=api/v2/servicediscovery
                - -path-output=/data/services.json
              env:
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
              image: quay.io/kubescape/http-request:v0.2.14
              imagePullPolicy: IfNotPresent
              name: url-discovery
              resources:
                limits:
                  cpu: 100m
                  memory: 50Mi
                requests:
                  cpu: 10m
                  memory: 10Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: services
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: kubevuln
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: custom-ca-certificates
              secret:
                secretName: custom-ca-certificates
            - emptyDir: {}
              name: tmp-dir
            - emptyDir: {}
              name: grype-db-cache
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - emptyDir: {}
              name: services
            - name: grype-db
              persistentVolumeClaim:
                claimName: kubescape-kubevuln
  41: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
      ingress:
        - from:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: operator
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
          ports:
            - port: 8080
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: kubevuln
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
        - Egress
  42: |
    apiVersion: v1
    kind: PersistentVolumeClaim
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-kubevuln
      namespace: kubescape
    spec:
      accessModes:
        - ReadWriteOnce
      resources:
        requests:
          storage: 5Gi
  43: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln-scc
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:openshift:scc:nonroot-v2
    subjects:
      - kind: ServiceAccount
        name: kubevuln
        namespace: kubescape
  44: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
    spec:
      ports:
        - port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  45: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
  46: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
    rules:
      - apiGroups:
          - ""
        resources:
          - nodes
          - nodes/proxy
          - services
          - endpoints
          - namespaces
          - configmaps
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - pods
        verbs:
          - get
          - watch
          - list
          - delete
      - apiGroups:
          - ""
        resources:
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - deployments
          - daemonsets
          - statefulsets
          - replicasets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - applicationprofiles
          - networkneighborhoods
          - seccompprofiles
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - containerprofiles
          - sbomsyfts
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - runtimerulealertbindings
        verbs:
          - list
          - watch
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands/status
        verbs:
          - get
          - watch
          - list
          - update
          - patch
      - apiGroups:
          - events.k8s.io
        resources:
          - events
        verbs:
          - create
          - patch
          - get
  47: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: node-agent
    subjects:
      - kind: ServiceAccount
        name: node-agent
        namespace: kubescape
  48: |
    apiVersion: v1
    data:
      config.json: |
        {
            "applicationProfileServiceEnabled": true,
            "prometheusExporterEnabled": false,
            "runtimeDetectionEnabled": true,
            "httpDetectionEnabled": true,
            "networkServiceEnabled": true,
            "malwareDetectionEnabled": true,
            "hostMalwareSensorEnabled": false,
            "hostNetworkSensorEnabled": false,
            "nodeProfileServiceEnabled": true,
            "networkStreamingEnabled": true,
            "maxImageSize": 5.36870912e+09,
            "maxSBOMSize": 2.097152e+07,
            "sbomGenerationEnabled": true,
            "enableEmbeddedSBOMs": true,
            "seccompServiceEnabled": true,
            "auditDetectionEnabled": true,
            "auditDetection": {
              "exporters": {"stdoutExporter":true},
              "eventFilter": {
                "includeTypes": [1300,1302,1309,1307,1317,1007,1327,1303,1324,1306,1404,1326]
              }
            },
            "initialDelay": "2m",
            "updateDataPeriod": "10m",
            "nodeProfileInterval": "10m",
            "networkStreamingInterval": "2m",
            "maxSniffingTimePerContainer": "24h",
            "includeNamespaces": "my-namespace",
            "excludeLabels":{"baz":["qux"],"foo":["bar","baz"]},
            "exporters": {
              "httpExporterConfig":{"maxAlertsPerMinute":1000,"method":"POST","url":"http://synchronizer:8089/apis/v1/kubescape.io"},
              "alertManagerExporterUrls":[],
              "stdoutExporter":true,
              "syslogExporterURL": ""
            },
            "excludeJsonPaths":[".containers[*].env[?(@.name==\"KUBECONFIG\")]"],
            "ruleCooldown": {
                "ruleCooldownDuration": "1h",
                "ruleCooldownAfterCount": 1,
                "ruleCooldownOnProfileFailure": true,
                "ruleCooldownMaxSize": 20000
            }
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
  49: |
    apiVersion: v1
    data:
      clamd.conf: |-
        Foreground yes
        User root
        Debug no
        LeaveTemporaryFiles no
        LogTime no
        LogClean no
        LogVerbose no
        LocalSocket /run/clamav/clamd.sock
        LocalSocketGroup clamav
        LocalSocketMode 660
        MaxDirectoryRecursion 20
        ExtendedDetectionInfo yes
      freshclam.conf: |-
        Foreground yes
        DatabaseDirectory /var/lib/clamav
        UpdateLogFile /dev/stdout
        Debug no
        LogFileMaxSize 0
        LogTime yes
        DatabaseOwner root
        DNSDatabaseInfo current.cvd.clamav.net
        DatabaseMirror database.clamav.net
        MaxAttempts 3
        ScriptedUpdates no
        CompressLocalDatabase no
        TestDatabases yes
        Checks 0
        ConnectTimeout 30
        ReceiveTimeout 60
    kind: ConfigMap
    metadata:
      name: clamav
      namespace: kubescape
  50: |
    apiVersion: apps/v1
    kind: DaemonSet
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      selector:
        matchLabels:
          app.kubernetes.io/component: node-agent
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      template:
        metadata:
          annotations:
            checksum/cloud-config: aaeeb6b6b35a5ebbb0893822c4bf9cd860fba6d3df3bc4e77c8dbdd5841db120
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/node-agent-config: cae7f9a81d9a00201e96f02ecd6bbd99c3a9e083e2e91c4bdaa4db28f40d8d6b
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
            container.apparmor.security.beta.kubernetes.io/node-agent: unconfined
          labels:
            app: node-agent
            app.kubernetes.io/component: node-agent
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            cloud.google.com/matching-allowlist: armo-kubescape-node-agent-1.27
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity:
            nodeAffinity:
              requiredDuringSchedulingIgnoredDuringExecution:
                nodeSelectorTerms:
                  - matchExpressions:
                      - key: kubernetes.io/os
                        operator: In
                        values:
                          - linux
          automountServiceAccountToken: true
          containers:
            - image: quay.io/kubescape/klamav:1.3.1-34_alpha
              imagePullPolicy: IfNotPresent
              name: clamav
              resources:
                limits:
                  cpu: 300m
                  memory: 512Mi
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                capabilities:
                  add:
                    - SYS_PTRACE
                runAsUser: 0
              volumeMounts:
                - mountPath: /var/lib/clamav-tmp
                  name: clamdb
                - mountPath: /run/clamav
                  name: clamrun
                - mountPath: /etc/clamav
                  name: etc
                  readOnly: true
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: HOST_ROOT
                  value: /host
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
                - name: CLAMAV_SOCKET
                  value: /clamav/clamd.sock
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
                - name: SKIP_KERNEL_VERSION_CHECK
                  value: "true"
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
                - name: NAMESPACE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: KUBELET_ROOT
                  value: /var/lib/kubelet
                - name: NodeName
              image: quay.io/benarmosec/node-agent:test-v1
              imagePullPolicy: Always
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 7888
                initialDelaySeconds: 60
                periodSeconds: 3
              name: node-agent
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 7888
                initialDelaySeconds: 3
                periodSeconds: 3
              resources:
                limits:
                  cpu: 500m
                  memory: 1400Mi
                requests:
                  cpu: 100m
                  memory: 180Mi
              securityContext:
                capabilities:
                  add:
                    - SYS_ADMIN
                    - SYS_PTRACE
                    - NET_ADMIN
                    - SYSLOG
                    - SYS_RESOURCE
                    - IPC_LOCK
                    - NET_RAW
                    - AUDIT_READ
                    - AUDIT_WRITE
                    - AUDIT_CONTROL
                privileged: false
                runAsUser: 0
                seLinuxOptions:
                  type: spc_t
              volumeMounts:
                - mountPath: /host
                  name: host
                  readOnly: true
                - mountPath: /var/lib/kubelet
                  name: kubeletdir
                - mountPath: /run
                  name: run
                - mountPath: /var
                  name: var
                  readOnly: true
                - mountPath: /lib/modules
                  name: modules
                  readOnly: true
                - mountPath: /sys/kernel/debug
                  name: debugfs
                - mountPath: /sys/fs/cgroup
                  name: cgroup
                  readOnly: true
                - mountPath: /sys/fs/bpf
                  name: bpffs
                - mountPath: /data
                  name: data
                - mountPath: /profiles
                  name: profiles
                - mountPath: /boot
                  name: boot
                  readOnly: true
                - mountPath: /clamav
                  name: clamrun
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  readOnly: true
                  subPath: proxy.crt
                - mountPath: /etc/ssl/certs/ca-certificates.crt
                  name: custom-ca-certificates
                  readOnly: true
                  subPath: ca-certificates.crt
          hostPID: true
          imagePullSecrets:
            - name: foo
            - name: bar
          nodeSelector:
            kubernetes.io/os: linux
          priorityClassName: kubescape-critical
          securityContext: null
          serviceAccountName: node-agent
          tolerations: null
          volumes:
            - hostPath:
                path: /
              name: host
            - hostPath:
                path: /var/lib/kubelet
              name: kubeletdir
            - hostPath:
                path: /run
              name: run
            - hostPath:
                path: /var
              name: var
            - hostPath:
                path: /sys/fs/cgroup
              name: cgroup
            - hostPath:
                path: /lib/modules
              name: modules
            - hostPath:
                path: /sys/fs/bpf
              name: bpffs
            - hostPath:
                path: /sys/kernel/debug
              name: debugfs
            - hostPath:
                path: /boot
              name: boot
            - emptyDir: null
              name: data
            - emptyDir: null
              name: profiles
            - emptyDir: {}
              name: clamdb
            - emptyDir: {}
              name: clamrun
            - configMap:
                items:
                  - key: clamd.conf
                    path: clamd.conf
                  - key: freshclam.conf
                    path: freshclam.conf
                name: clamav
              name: etc
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: node-agent
              name: config
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: custom-ca-certificates
              secret:
                secretName: custom-ca-certificates
  51: |
    apiVersion: kubescape.io/v1
    kind: RuntimeRuleAlertBinding
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: all-rules-all-pods
    spec:
      namespaceSelector:
        matchExpressions:
          - key: kubernetes.io/metadata.name
            operator: In
            values:
              - my-namespace
      rules:
        - ruleName: Unexpected process launched
        - parameters:
            ignoreMounts: true
            ignorePrefixes:
              - /proc
              - /run/secrets/kubernetes.io/serviceaccount
              - /var/run/secrets/kubernetes.io/serviceaccount
              - /tmp
            includePrefixes:
              - /etc
              - /var/spool/cron/
              - /var/log/
              - /var/run/
              - /dev/shm/
              - /run/
              - /var/www/
              - /var/lib/docker/
              - /opt/
              - /usr/local/
              - /app/
              - /.dockerenv
              - /proc/self/environ
              - /var/lib/kubelet/
              - /etc/cni/net.d/
              - /var/run/secrets/kubernetes.io/
              - /var/run/secrets/kubernetes.io/serviceaccount/
              - /run/containerd/
              - /run/flannel/
              - /run/calico/
          ruleName: Unexpected file access
        - ruleName: Unexpected system call
        - ruleName: Unexpected capability used
        - ruleName: Unexpected domain request
        - ruleName: Unexpected Service Account Token Access
        - ruleName: Kubernetes Client Executed
        - ruleName: Exec from malicious source
        - ruleName: Kernel Module Load
        - ruleName: Exec Binary Not In Base Image
        - ruleName: Fileless Execution
        - ruleName: XMR Crypto Mining Detection
        - ruleName: Exec from mount
        - ruleName: Crypto Mining Related Port Communication
        - ruleName: Crypto Mining Domain Communication
        - ruleName: Read Environment Variables from procfs
        - ruleName: eBPF Program Load
        - ruleName: Symlink Created Over Sensitive File
        - ruleName: Unexpected Sensitive File Access
        - ruleName: Hardlink Created Over Sensitive File
        - ruleName: Exec to pod
        - ruleName: Port forward
        - ruleName: Malicious Ptrace Usage
        - ruleName: Cross-Site Scripting (XSS) Attempt
        - ruleName: SQL Injection Attempt
        - ruleName: Server-Side Request Forgery Attack Attempt
        - ruleName: Remote File Inclusion Attack Attempt
        - ruleName: Local File Inclusion Attempt
        - ruleName: XML External Entity Attack Attempt
        - ruleName: Server-Side Template Injection Attack
        - ruleName: Command Injection Attempt
        - ruleName: Unexpected Exec Source
        - ruleName: Unexpected Open Source
        - ruleName: Unexpected Symlink Source
        - ruleName: Unexpected Hardlink Source
        - ruleName: Unexpected io_uring Operation Detected
        - ruleName: ReDoS Attack
        - ruleName: Prototype Pollution Attack
        - ruleName: Execution of base64 Encoded Command
        - ruleName: Execution of interpreter command
        - ruleName: Code Sharing Site Access
        - ruleName: Web Application File Write Access
        - ruleName: Cron Job File Created or Modified
        - ruleName: Hidden File Created
        - ruleName: Reverse Shell Patterens Detected
        - ruleName: Unauthorized IMDS Connection Attempt
        - ruleName: Credentials Detection Attempts
        - ruleName: HTTP Request Smuggling Attempt
        - ruleName: P2P Tracker Connection Created
  52: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: default
              podSelector:
                matchLabels:
                  component: apiserver
                  provider: kubernetes
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
      podSelector:
        matchLabels:
          app.kubernetes.io/component: node-agent
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Egress
  53: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent-scc
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:openshift:scc:privileged
    subjects:
      - kind: ServiceAccount
        name: node-agent
        namespace: kubescape
  54: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      ports:
        - name: prometheus
          port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
  55: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
  56: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-admission-webhook
      namespace: kubescape
    spec:
      ports:
        - port: 443
          targetPort: 8443
      selector:
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  57: |
    apiVersion: v1
    data:
      tls.crt: bW9jay1jZXJ0LWNlcnQ=
      tls.key: bW9jay1jZXJ0LWtleQ==
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-admission-webhook.kubescape.svc-kubescape-tls-pair
      namespace: kubescape
    type: kubernetes.io/tls
  58: |
    apiVersion: admissionregistration.k8s.io/v1
    kind: ValidatingWebhookConfiguration
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: validation
    webhooks:
      - admissionReviewVersions:
          - v1
        clientConfig:
          caBundle: bW9jay1jYS1jZXJ0
          service:
            name: kubescape-admission-webhook
            namespace: kubescape
            path: /validate
            port: 443
        failurePolicy: Ignore
        name: validation.kubescape.admission
        rules:
          - apiGroups:
              - '*'
            apiVersions:
              - v1
            operations:
              - CREATE
              - UPDATE
              - DELETE
              - CONNECT
            resources:
              - pods
              - pods/exec
              - pods/portforward
              - pods/attach
              - clusterrolebindings
              - rolebindings
            scope: '*'
        sideEffects: None
  59: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
    rules:
      - apiGroups:
          - ""
        resources:
          - pods
          - nodes
          - namespaces
          - configmaps
          - services
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - secrets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - delete
          - patch
      - apiGroups:
          - apps
        resources:
          - deployments
          - daemonsets
          - statefulsets
          - replicasets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - vulnerabilitymanifests
          - vulnerabilitymanifestsummaries
          - workloadconfigurationscans
          - workloadconfigurationscansummaries
          - openvulnerabilityexchangecontainers
          - containerprofiles
          - sbomsyfts
        verbs:
          - get
          - watch
          - list
          - delete
      - apiGroups:
          - kubescape.io
        resources:
          - runtimerulealertbindings
        verbs:
          - list
          - watch
          - get
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - delete
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands/status
        verbs:
          - get
          - watch
          - list
          - update
          - patch
  60: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: operator
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  61: |
    apiVersion: v1
    data:
      config.json: |
        {
          "includeNamespaces": "my-namespace",
          "namespace": "kubescape",
          "triggersecurityframework": true,
          "podScanGuardTime": "1h",
          "excludeJsonPaths":[".containers[*].env[?(@.name==\"KUBECONFIG\")]"],
          "httpExporterConfig":{"maxAlertsPerMinute":1000,"method":"POST","url":"http://synchronizer:8089/apis/v1/kubescape.io"}
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: operator
      namespace: kubescape
  62: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: operator
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          annotations:
            checksum/capabilities-config: e2505a6ee27b9f0c24db0a3803432019abf578f2877aeb5a78c7750a481d5b78
            checksum/cloud-config: aaeeb6b6b35a5ebbb0893822c4bf9cd860fba6d3df3bc4e77c8dbdd5841db120
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/matching-rules-config: c81857b415602f6b161db3199a16461c5acd8ba44ec7572189441f4f294a3614
            checksum/operator-config: a95183e6cda13e32fef088ea6e42d801059e551051281413c349d57f1e70dfc5
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
          labels:
            app: operator
            app.kubernetes.io/component: operator
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - env:
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: HELM_RELEASE
                  value: kubescape-operator-1.29.9
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
              image: quay.io/kubescape/operator:v0.2.109
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /v1/liveness
                  port: readiness-port
                initialDelaySeconds: 3
                periodSeconds: 3
              name: operator
              ports:
                - containerPort: 4002
                  name: trigger-port
                  protocol: TCP
                - containerPort: 8000
                  name: readiness-port
                  protocol: TCP
                - containerPort: 8443
                  name: admission-port
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /v1/readiness
                  port: readiness-port
                initialDelaySeconds: 10
                periodSeconds: 5
              resources:
                limits:
                  cpu: 300m
                  memory: 300Mi
                requests:
                  cpu: 50m
                  memory: 100Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /tmp
                  name: tmp-dir
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/capabilities.json
                  name: ks-capabilities
                  readOnly: true
                  subPath: capabilities.json
                - mountPath: /etc/config/matchingRules.json
                  name: cs-matching-rules
                  readOnly: true
                  subPath: matchingRules.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/ssl/certs/ca-certificates.crt
                  name: custom-ca-certificates
                  subPath: ca-certificates.crt
                - mountPath: /etc/certs
                  name: tls-certs
                  readOnly: true
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
          imagePullSecrets:
            - name: foo
            - name: bar
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: operator
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: custom-ca-certificates
              secret:
                secretName: custom-ca-certificates
            - name: tls-certs
              secret:
                secretName: kubescape-admission-webhook.kubescape.svc-kubescape-tls-pair
            - emptyDir: {}
              name: tmp-dir
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: capabilities
                    path: capabilities.json
                name: ks-capabilities
              name: ks-capabilities
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: operator
              name: config
            - configMap:
                items:
                  - key: matchingRules.json
                    path: matchingRules.json
                name: cs-matching-rules
              name: cs-matching-rules
  63: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: kubescape-scheduler
          namespace: kubescape
          labels:
            app: kubescape-scheduler
            tier: ks-control-plane
            kubescape.io/tier: "core"
            armo.tier: "kubescape-scan"
        spec:
          schedule: "1 2 3 4 5"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "kubescape-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  imagePullSecrets:
                  - name: foo
                  - name: bar
                  containers:
                  - name: kubescape-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubescape
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: kubescape-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-cronjob-template
      namespace: kubescape
  64: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: kubevuln-scheduler
          namespace: kubescape
          labels:
            app: kubevuln-scheduler
            tier: ks-control-plane
            kubescape.io/tier: "core"
            armo.tier: "vuln-scan"
        spec:
          schedule: "1 2 3 4 5"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "vuln-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  imagePullSecrets:
                  - name: foo
                  - name: bar
                  containers:
                  - name: kubevuln-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubevuln
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: kubevuln-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-cronjob-template
      namespace: kubescape
  65: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
        - ports:
            - port: 80
              protocol: TCP
          to:
            - ipBlock:
                cidr: 169.254.169.254/32
        - ports:
            - port: 8080
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: kubescape
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 8080
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: kubevuln
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 443
              protocol: TCP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: default
              podSelector:
                matchLabels:
                  component: apiserver
                  provider: kubernetes
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
      ingress:
        - ports:
            - port: admission-port
              protocol: TCP
        - from:
            - podSelector:
                matchLabels:
                  armo.tier: kubescape-scan
            - podSelector:
                matchLabels:
                  armo.tier: vuln-scan
          ports:
            - port: trigger-port
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: operator
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
        - Egress
  66: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: registry-scheduler
          namespace: kubescape
          labels:
            app: registry-scheduler
            kubescape.io/tier: "core"
            tier: ks-control-plane
            armo.tier: "registry-scan"
        spec:
          schedule: "0 0 * * *"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "registry-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  imagePullSecrets:
                  - name: foo
                  - name: bar
                  containers:
                  - name: registry-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubevuln
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: registry-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: registry-scan-cronjob-template
      namespace: kubescape
  67: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - configmaps
          - secrets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
      - apiGroups:
          - batch
        resources:
          - cronjobs
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  68: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: operator
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  69: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator-scc
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:openshift:scc:nonroot-v2
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  70: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      ports:
        - port: 4002
          protocol: TCP
          targetPort: 4002
      selector:
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  71: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
  72: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      labels:
        app: prometheus-exporter
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: prometheus-exporter
    rules:
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - configurationscansummaries
          - vulnerabilitysummaries
          - workloadconfigurationscansummaries
          - vulnerabilitymanifestsummaries
        verbs:
          - get
          - watch
          - list
  73: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      labels:
        app: prometheus-exporter
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: prometheus-exporter
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: prometheus-exporter
    subjects:
      - kind: ServiceAccount
        name: prometheus-exporter
        namespace: kubescape
  74: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: prometheus-exporter
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: prometheus-exporter
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: prometheus-exporter
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations: null
          labels:
            app: prometheus-exporter
            app.kubernetes.io/component: prometheus-exporter
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: ENABLE_WORKLOAD_METRICS
                  value: "true"
              image: quay.io/kubescape/prometheus-exporter:v0.2.7
              imagePullPolicy: IfNotPresent
              livenessProbe:
                initialDelaySeconds: 3
                periodSeconds: 3
                tcpSocket:
                  port: 8080
              name: prometheus-exporter
              ports:
                - containerPort: 8080
                  name: metrics
                  protocol: TCP
              readinessProbe:
                tcpSocket:
                  port: 8080
              resources:
                limits:
                  cpu: 50m
                  memory: 100Mi
                requests:
                  cpu: 10m
                  memory: 10Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/config
                  name: ks-cloud-config
                  readOnly: true
          imagePullSecrets:
            - name: foo
            - name: bar
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: prometheus-exporter
          tolerations: null
          volumes:
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
  75: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      labels:
        app: prometheus-exporter
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: prometheus-exporter
      namespace: kubescape
    spec:
      ingress:
        - ports:
            - port: 8080
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: prometheus-exporter
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
  76: |
    apiVersion: v1
    kind: Service
    metadata:
      labels:
        app: prometheus-exporter
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: prometheus-exporter
      namespace: kubescape
    spec:
      ports:
        - port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: null
  77: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      labels:
        app: prometheus-exporter
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: prometheus-exporter
      namespace: kubescape
  78: |
    apiVersion: monitoring.coreos.com/v1
    kind: ServiceMonitor
    metadata:
      annotations: null
      labels:
        app: prometheus-exporter
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: prometheus-exporter
      namespace: kubescape
    spec:
      endpoints:
        - interval: 60s
          path: /metrics
          targetPort: 8080
      namespaceSelector:
        matchNames:
          - kubescape
      selector:
        matchLabels:
          app.kubernetes.io/component: prometheus-exporter
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
  79: |
    apiVersion: v1
    data:
      proxy.crt: foo
    kind: Secret
    metadata:
      annotations:
        helm.sh/hook: pre-install,pre-upgrade
        helm.sh/hook-delete-policy: before-hook-creation
        helm.sh/hook-weight: "0"
      labels:
        app: kubescape-proxy-certificate
        app.kubernetes.io/component: kubescape-proxy-certificate
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-proxy-certificate
      namespace: kubescape
    type: Opaque
  80: |
    apiVersion: apiregistration.k8s.io/v1
    kind: APIService
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: v1beta1.spdx.softwarecomposition.kubescape.io
    spec:
      group: spdx.softwarecomposition.kubescape.io
      groupPriorityMinimum: 1000
      insecureSkipTLSVerify: true
      service:
        name: storage
        namespace: kubescape
      version: v1beta1
      versionPriority: 15
  81: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
    rules:
      - apiGroups:
          - ""
        resources:
          - namespaces
          - pods
          - services
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - admissionregistration.k8s.io
        resources:
          - mutatingwebhookconfigurations
          - validatingwebhookconfigurations
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - daemonsets
          - deployments
          - replicasets
          - statefulsets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - cronjobs
          - jobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - flowcontrol.apiserver.k8s.io
        resources:
          - prioritylevelconfigurations
          - flowschemas
        verbs:
          - get
          - watch
          - list
  82: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage:system:auth-delegator
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:auth-delegator
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  83: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: storage
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  84: |
    apiVersion: v1
    data:
      config.json: |
        {
          "cleanupInterval": "6h",
          "disableVirtualCRDs": false,
          "excludeJsonPaths": [".containers[*].env[?(@.name==\"KUBECONFIG\")]"],
          "defaultQueueLength": 100,
          "defaultWorkerCount": 2,
          "defaultMaxObjectSize": 400000,
          "queueManagerEnabled": true,
          "kindQueues": {"applicationprofiles":{"maxObjectSize":20000000,"queueLength":50,"workerCount":2},"containerprofiles":{"maxObjectSize":2500000,"queueLength":50,"workerCount":2},"networkneighborhoods":{"maxObjectSize":10000000,"queueLength":50,"workerCount":2},"openvulnerabilityexchangecontainers":{"maxObjectSize":500000,"queueLength":50,"workerCount":1},"sbomsyftfiltereds":{"maxObjectSize":50000000,"queueLength":50,"workerCount":1},"sbomsyfts":{"maxObjectSize":100000000,"queueLength":50,"workerCount":1},"vulnerabilitymanifests":{"maxObjectSize":50000000,"queueLength":50,"workerCount":1}},
          "serverBindPort": "8443"
        }
    kind: ConfigMap
    metadata:
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: storage
      namespace: kubescape
  85: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: storage
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations: null
          labels:
            app: storage
            app.kubernetes.io/component: storage
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          containers:
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
              image: quay.io/kubescape/storage:v0.0.220
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 8443
                  scheme: HTTPS
              name: apiserver
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 8443
                  scheme: HTTPS
              resources:
                limits:
                  cpu: 1500m
                  memory: 1500Mi
                requests:
                  cpu: 100m
                  memory: 400Mi
              securityContext:
                allowPrivilegeEscalation: false
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: data
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
          imagePullSecrets:
            - name: foo
            - name: bar
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: storage
          tolerations: null
          volumes:
            - name: data
              persistentVolumeClaim:
                claimName: kubescape-storage
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: storage
              name: config
  86: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: default
              podSelector:
                matchLabels:
                  component: apiserver
                  provider: kubernetes
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
      podSelector:
        matchLabels:
          app.kubernetes.io/component: storage
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Egress
  87: |
    apiVersion: v1
    kind: PersistentVolumeClaim
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-storage
      namespace: kubescape
    spec:
      accessModes:
        - ReadWriteOnce
      resources:
        requests:
          storage: 5Gi
  88: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage-auth-reader
      namespace: kube-system
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: extension-apiserver-authentication-reader
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  89: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage-scc
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:openshift:scc:nonroot-v2
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  90: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      ports:
        - name: https
          port: 443
          protocol: TCP
          targetPort: 8443
      selector:
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
  91: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
  92: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
    rules:
      - apiGroups:
          - storage.k8s.io
        resources:
          - storageclasses
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - rbac.authorization.k8s.io
        resources:
          - rolebindings
          - clusterrolebindings
          - roles
          - clusterroles
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - ""
        resources:
          - pods
          - namespaces
          - nodes
          - configmaps
          - persistentvolumes
          - services
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - apps
        resources:
          - deployments
          - statefulsets
          - daemonsets
          - replicasets
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - networking.k8s.io
        resources:
          - networkpolicies
          - ingresses
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - applicationprofiles
          - networkneighborhoods
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - patch
          - delete
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - knownservers
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - patch
          - delete
      - apiGroups:
          - cilium.io
        resources:
          - ciliumnetworkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - projectcalico.org
        resources:
          - networkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - networking.istio.io
        resources:
          - gateways
          - virtualservices
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - security.istio.io
        resources:
          - authorizationpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - gateway.networking.k8s.io
        resources:
          - httproutes
          - tcproutes
          - udproutes
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - patch
          - delete
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - sbomsyfts
          - sbomsyftfiltereds
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - seccompprofiles
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - patch
      - apiGroups:
          - networking.k8s.io
        resources:
          - networkpolicies
        verbs:
          - create
          - update
          - patch
      - apiGroups:
          - cilium.io
        resources:
          - ciliumnetworkpolicies
        verbs:
          - create
          - update
          - patch
      - apiGroups:
          - projectcalico.org
        resources:
          - networkpolicies
        verbs:
          - create
          - update
          - patch
      - apiGroups:
          - apps
        resources:
          - deployments
          - statefulsets
          - daemonsets
          - replicasets
        verbs:
          - update
          - patch
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - update
          - patch
      - apiGroups:
          - ""
        resources:
          - pods
        verbs:
          - update
          - patch
  93: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: synchronizer
    subjects:
      - kind: ServiceAccount
        name: synchronizer
        namespace: kubescape
  94: |
    apiVersion: v1
    data:
      config.json: |
        {
          "inCluster": {
            "includeNamespaces": "my-namespace",
            "resources": [
              {
                "group": "",
                "version": "v1",
                "resource": "services",
                "strategy": "patch"
              },
              {
                "group": "networking.k8s.io",
                "version": "v1",
                "resource": "ingresses",
                "strategy": "patch"
              },
              {
                "group": "gateway.networking.k8s.io",
                "version": "v1",
                "resource": "httproutes",
                "strategy": "patch"
              },
              {
                "group": "gateway.networking.k8s.io",
                "version": "v1",
                "resource": "tcproutes",
                "strategy": "patch"
              },
              {
                "group": "gateway.networking.k8s.io",
                "version": "v1",
                "resource": "udproutes",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "rolebindings",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "clusterrolebindings",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "clusterroles",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "roles",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "persistentvolumes",
                "strategy": "patch"
              },
              {
                "group": "storage.k8s.io",
                "version": "v1",
                "resource": "storageclasses",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "deployments",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "statefulsets",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "daemonsets",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "replicasets",
                "strategy": "patch"
              },
              {
                "group": "batch",
                "version": "v1",
                "resource": "jobs",
                "strategy": "patch"
              },
              {
                "group": "batch",
                "version": "v1",
                "resource": "cronjobs",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "pods",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "namespaces",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "nodes",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "configmaps",
                "strategy": "patch"
              },
              {
                "group": "networking.k8s.io",
                "version": "v1",
                "resource": "networkpolicies",
                "strategy": "patch"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "applicationprofiles",
                "strategy": "copy"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "knownservers",
                "strategy": "copy"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "networkneighborhoods",
                "strategy": "copy"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "sbomsyfts",
                "strategy": "copy"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "sbomsyftfiltereds",
                "strategy": "copy"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "seccompprofiles",
                "strategy": "copy"
              },
              {
                "group": "cilium.io",
                "version": "v2",
                "resource": "ciliumnetworkpolicies",
                "strategy": "patch"
              },
              {
                "group": "projectcalico.org",
                "version": "v3",
                "resource": "networkpolicies",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1",
                "resource": "gateways",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1",
                "resource": "virtualservices",
                "strategy": "patch"
              },
              {
                "group": "security.istio.io",
                "version": "v1",
                "resource": "authorizationpolicies",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1beta1",
                "resource": "gateways",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1beta1",
                "resource": "virtualservices",
                "strategy": "patch"
              },
              {
                "group": "security.istio.io",
                "version": "v1beta1",
                "resource": "authorizationpolicies",
                "strategy": "patch"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "servicesscanresults",
                "strategy": "patch"
              },
              {
                "group": "kubescape.io",
                "version": "v1alpha1",
                "resource": "operatorcommands",
                "strategy": "copy"
              }
            ]
          },
          "httpEndpoint": {
            "serverPort": "8089",
            "resources": [
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "networkstreams",
                "strategy": "copy"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "nodeprofiles",
                "strategy": "copy"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "runtimealerts",
                "strategy": "copy"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "registrystatuses",
                "strategy": "copy"
              }
            ]
          }
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
  95: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: synchronizer
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations:
            checksum/cloud-config: aaeeb6b6b35a5ebbb0893822c4bf9cd860fba6d3df3bc4e77c8dbdd5841db120
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
            checksum/synchronizer-configmap: df8fee4a6080fe9af89f3fa7c40b9f8dd98a7080c0ef7de7ce0eb07ac8ac1408
          labels:
            app: synchronizer
            app.kubernetes.io/component: synchronizer
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - command:
                - /usr/bin/client
              env:
                - name: HELM_RELEASE
                  value: kubescape-operator-1.29.9
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
              image: quay.io/kubescape/synchronizer:v0.0.116
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /healthz
                  port: 7888
                initialDelaySeconds: 10
                periodSeconds: 30
                timeoutSeconds: 10
              name: synchronizer
              resources:
                limits:
                  cpu: 200m
                  memory: 500Mi
                requests:
                  cpu: 100m
                  memory: 250Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/services.json
                  name: services
                  readOnly: true
                  subPath: services.json
                - mountPath: /etc/ssl/certs/ca-certificates.crt
                  name: custom-ca-certificates
                  subPath: ca-certificates.crt
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
          imagePullSecrets:
            - name: foo
            - name: bar
          initContainers:
            - args:
                - -method=get
                - -scheme=https
                - -host=api.armosec.io
                - -path=api/v2/servicediscovery
                - -path-output=/data/services.json
              env:
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
              image: quay.io/kubescape/http-request:v0.2.14
              imagePullPolicy: IfNotPresent
              name: url-discovery
              resources:
                limits:
                  cpu: 100m
                  memory: 50Mi
                requests:
                  cpu: 10m
                  memory: 10Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: services
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: synchronizer
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: custom-ca-certificates
              secret:
                secretName: custom-ca-certificates
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - emptyDir: {}
              name: services
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: synchronizer
              name: config
  96: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
        - ports:
            - port: 443
              protocol: TCP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: default
              podSelector:
                matchLabels:
                  component: apiserver
                  provider: kubernetes
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
      ingress:
        - from:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: node-agent
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
          ports:
            - port: 8089
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: synchronizer
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
        - Egress
  97: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - configmaps
          - secrets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
      - apiGroups:
          - batch
        resources:
          - cronjobs
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  98: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: synchronizer
    subjects:
      - kind: ServiceAccount
        name: synchronizer
        namespace: kubescape
  99: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer-scc
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:openshift:scc:nonroot-v2
    subjects:
      - kind: ServiceAccount
        name: synchronizer
        namespace: kubescape
  100: |
    apiVersion: v1
    kind: Service
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    spec:
      ports:
        - port: 8089
          protocol: TCP
          targetPort: 8089
      selector:
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  101: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
default capabilities:
  1: |+
    raw: |+
      Thank you for installing kubescape-operator version 1.29.9.
      View your cluster's configuration scanning schedule:
      > kubectl -n kubescape get cj kubescape-scheduler -o=jsonpath='{.metadata.name}{"\t"}{.spec.schedule}{"\n"}'

      To change the schedule, set `.spec.schedule`:
      > kubectl -n kubescape edit cj kubescape-scheduler
      View your cluster's image scanning schedule:
      > kubectl -n kubescape get cj kubevuln-scheduler -o=jsonpath='{.metadata.name}{"\t"}{.spec.schedule}{"\n"}'

      To change the schedule, edit `.spec.schedule`:
      > kubectl -n kubescape edit cj kubevuln-scheduler

      View your image vulnerabilities scan summaries:
      > kubectl get vulnerabilitymanifestsummaries -A

      Detailed reports are also available:
      > kubectl get vulnerabilitymanifests -A

      kubescape-operator generates suggested network policies. To view them:
      > kubectl get generatednetworkpolicies -n <namespace>

  2: |
    apiVersion: v1
    data:
      accessKey: ZjMwNGQ3M2ItZDQzYy00MTJiLTgyZWEtZTRjODU5NDkzY2U2
      account: OWU2YzBjMmMtNmJkMC00OTE5LTgxNWItNTUwMzBkZTdjOWEw
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: cloud-secret
        app.kubernetes.io/component: cloud-secret
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/infra: credentials
        tier: ks-control-plane
      name: cloud-secret
      namespace: kubescape
    type: Opaque
  3: |
    apiVersion: v1
    data:
      clusterData: |
        {
          "serviceDiscovery": true,
          "vulnScanURL": "kubevuln:8080",
          "kubevulnURL": "kubevuln:8080",
          "kubescapeURL": "kubescape:8080",
          "clusterName": "kind-kind",
          "storage": true,
          "relevantImageVulnerabilitiesEnabled": true,
          "namespace": "kubescape",
          "imageVulnerabilitiesScanningEnabled": true,
          "postureScanEnabled": true,
          "otelCollector": false,
          "nodeAgent": "true",
          "maxImageSize": 5.36870912e+09,
          "maxSBOMSize": 2.097152e+07,
          "keepLocal": false,
          "scanTimeout": "5m",
          "scanEmbeddedSBOMs": false,
          "vexGeneration": false,
          "useDefaultMatchers": false,
          "storeFilteredSbom": false,
          "continuousPostureScan": false,
          "listingURL": "http://grype-offline-db:80/databases",
          "relevantImageVulnerabilitiesConfiguration": "enable"
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/infra: config
        kubescape.io/tier: core
        tier: ks-control-plane
      name: ks-cloud-config
      namespace: kubescape
  4: |
    apiVersion: v1
    data:
      capabilities: |
        {
          "capabilities":{"admissionController":"disable","autoUpgrading":"disable","configurationScan":"enable","httpDetection":"disable","kubescapeOffline":"disable","linuxAudit":"enable","malwareDetection":"disable","manageWorkloads":"disable","networkEventsStreaming":"disable","networkPolicyService":"enable","nodeProfileService":"disable","nodeSbomGeneration":"enable","nodeScan":"enable","prometheusExporter":"disable","relevancy":"enable","runtimeDetection":"disable","runtimeObservability":"enable","scanEmbeddedSBOMs":"disable","seccompProfileService":"disable","syncSBOM":"disable","testing":{"nodeAgentMultiplication":{"enabled":false,"replicas":5}},"vexGeneration":"disable","vulnerabilityScan":"enable"},
          "components":{"autoUpdater":{"enabled":false},"clamAV":{"enabled":false},"cloudSecret":{"create":true,"name":"cloud-secret"},"customCaCertificates":{"name":"custom-ca-certificates"},"hostScanner":{"enabled":true},"kubescape":{"enabled":true},"kubescapeScheduler":{"enabled":true},"kubevuln":{"enabled":true},"kubevulnScheduler":{"enabled":true},"nodeAgent":{"enabled":true},"operator":{"enabled":true},"otelCollector":{"enabled":false},"prometheusExporter":{"enabled":false},"serviceDiscovery":{"enabled":true},"storage":{"enabled":true},"synchronizer":{"enabled":true}},
          "configurations":{"excludeJsonPaths":null,"otelUrl":null,"persistence":"enable","priorityClass":{"daemonset":100000100,"enabled":true},"prometheusAnnotations":"disable"} ,
          "serviceScanConfig" :{"enabled":false,"interval":"1h"}
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-capabilities
        app.kubernetes.io/component: ks-capabilities
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: ks-capabilities
      namespace: kubescape
  5: |
    apiVersion: v1
    data:
      matchingRules.json: |
        {"match":[{"apiGroups":["apps"],"apiVersions":["v1"],"resources":["deployments"]}],"namespaces":["default"]}
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: cs-matching-rules
      namespace: kubescape
  6: |
    apiVersion: scheduling.k8s.io/v1
    description: This priority class is for node-agent daemonset pods
    globalDefault: false
    kind: PriorityClass
    metadata:
      annotations: null
      labels:
        app: kubescape-critical
        app.kubernetes.io/component: kubescape-critical
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-critical
    value: 1.000001e+08
  7: |
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      labels:
        app: linux-audit-rules
        app.kubernetes.io/component: linux-audit-rules
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: linuxauditrules.kubescape.io
    spec:
      group: kubescape.io
      names:
        kind: LinuxAuditRule
        plural: linuxauditrules
        shortNames:
          - lar
          - linuxauditrule
          - auditrule
        singular: linuxauditrule
      scope: Namespaced
      versions:
        - additionalPrinterColumns:
            - description: Whether the Linux audit rules are enabled
              jsonPath: .spec.enabled
              name: Enabled
              type: boolean
            - description: Number of Linux audit rules defined
              jsonPath: .status.appliedRules
              name: Rules
              type: integer
            - description: Status of the Linux audit rules
              jsonPath: .status.conditions[?(@.type=="Ready")].status
              name: Status
              type: string
            - jsonPath: .metadata.creationTimestamp
              name: Age
              type: date
          name: v1
          schema:
            openAPIV3Schema:
              properties:
                spec:
                  properties:
                    enabled:
                      default: true
                      description: Controls whether these rules should be active
                      type: boolean
                    nodeSelector:
                      additionalProperties:
                        type: string
                      description: Node selector to target specific nodes
                      type: object
                    rateLimit:
                      description: Rate limiting configuration
                      properties:
                        burstSize:
                          description: Burst size for rate limiting
                          minimum: 1
                          type: integer
                        eventsPerSecond:
                          description: Maximum events per second
                          minimum: 1
                          type: integer
                      type: object
                    rules:
                      description: List of audit rule definitions
                      items:
                        properties:
                          description:
                            description: Human-readable description of what this rule monitors
                            type: string
                          enabled:
                            default: true
                            description: Controls whether this specific rule is active
                            type: boolean
                          fileWatch:
                            description: File system monitoring rule
                            properties:
                              exclude:
                                description: Exclude patterns (basic glob patterns)
                                items:
                                  type: string
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              paths:
                                description: Paths to monitor
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              permissions:
                                description: Permissions to monitor
                                items:
                                  enum:
                                    - read
                                    - write
                                    - attr
                                    - attribute
                                    - execute
                                  type: string
                                minItems: 1
                                type: array
                              recursive:
                                default: false
                                description: Recursive monitoring (future use)
                                type: boolean
                            required:
                              - paths
                              - permissions
                              - keys
                            type: object
                          name:
                            description: Unique name of this rule within the CRD
                            type: string
                          network:
                            description: Network monitoring rule (future extension)
                            properties:
                              addresses:
                                description: Addresses to monitor
                                items:
                                  type: string
                                type: array
                              direction:
                                description: Traffic direction
                                enum:
                                  - inbound
                                  - outbound
                                  - both
                                type: string
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              ports:
                                description: Ports to monitor
                                items:
                                  maximum: 65535
                                  minimum: 1
                                  type: integer
                                type: array
                              protocols:
                                description: Protocols to monitor
                                items:
                                  enum:
                                    - tcp
                                    - udp
                                    - icmp
                                  type: string
                                type: array
                            required:
                              - keys
                            type: object
                          priority:
                            default: 100
                            description: Priority for rule ordering (lower = higher priority)
                            maximum: 1000
                            minimum: 1
                            type: integer
                          process:
                            description: Process monitoring rule
                            properties:
                              arguments:
                                description: Command line argument patterns
                                items:
                                  type: string
                                type: array
                              executables:
                                description: Executables to monitor (path patterns)
                                items:
                                  type: string
                                type: array
                              filters:
                                description: Additional filters
                                items:
                                  properties:
                                    field:
                                      description: Field to filter on
                                      type: string
                                    operator:
                                      description: Comparison operator
                                      enum:
                                        - =
                                        - '!='
                                        - <
                                        - '>'
                                        - <=
                                        - '>='
                                      type: string
                                    value:
                                      description: Value to compare against
                                      type: string
                                  required:
                                    - field
                                    - operator
                                    - value
                                  type: object
                                type: array
                              groups:
                                description: Groups to monitor
                                items:
                                  type: string
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              users:
                                description: Users to monitor
                                items:
                                  type: string
                                type: array
                            required:
                              - keys
                            type: object
                          rawRule:
                            description: Raw auditctl format rule (fallback for complex rules)
                            type: string
                          syscall:
                            description: System call monitoring rule
                            properties:
                              action:
                                default: always
                                description: Action to take
                                enum:
                                  - always
                                  - never
                                type: string
                              architecture:
                                description: Architecture filters
                                items:
                                  enum:
                                    - b64
                                    - b32
                                  type: string
                                type: array
                              filters:
                                description: Filters for syscall parameters
                                items:
                                  properties:
                                    field:
                                      description: Field to filter on
                                      enum:
                                        - pid
                                        - ppid
                                        - uid
                                        - gid
                                        - euid
                                        - egid
                                        - auid
                                        - exe
                                        - comm
                                        - key
                                        - exit
                                        - success
                                        - dir
                                        - path
                                        - perm
                                        - arch
                                        - a0
                                        - a1
                                        - a2
                                        - a3
                                        - a4
                                        - a5
                                        - a6
                                        - a7
                                        - a8
                                        - a9
                                        - a10
                                        - a11
                                        - a12
                                        - a13
                                        - a14
                                        - a15
                                      type: string
                                    operator:
                                      description: Comparison operator
                                      enum:
                                        - =
                                        - '!='
                                        - <
                                        - '>'
                                        - <=
                                        - '>='
                                      type: string
                                    value:
                                      description: Value to compare against
                                      type: string
                                  required:
                                    - field
                                    - operator
                                    - value
                                  type: object
                                maxItems: 20
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              list:
                                default: exit
                                description: Audit list type
                                enum:
                                  - task
                                  - exit
                                  - user
                                  - exclude
                                type: string
                              syscalls:
                                description: System calls to monitor
                                items:
                                  type: string
                                minItems: 1
                                type: array
                            required:
                              - syscalls
                            type: object
                        required:
                          - name
                        type: object
                      type: array
                  type: object
                status:
                  properties:
                    appliedRules:
                      description: Number of rules successfully applied to the kernel
                      minimum: 0
                      type: integer
                    conditions:
                      description: Current conditions of the AuditRule
                      items:
                        properties:
                          lastTransitionTime:
                            description: Last time the condition transitioned
                            format: date-time
                            type: string
                          message:
                            description: Human-readable message about the transition
                            type: string
                          reason:
                            description: Reason for the condition's last transition
                            type: string
                          status:
                            description: Status of the condition
                            enum:
                              - "True"
                              - "False"
                              - Unknown
                            type: string
                          type:
                            description: Type of condition
                            enum:
                              - Ready
                              - Progressing
                              - Failed
                            type: string
                        required:
                          - type
                          - status
                          - lastTransitionTime
                        type: object
                      type: array
                    failedRules:
                      description: Rules that failed to apply
                      items:
                        properties:
                          error:
                            description: Error message describing the failure
                            type: string
                          lastAttempt:
                            description: When we last tried to apply this rule
                            format: date-time
                            type: string
                          name:
                            description: Name of the failed rule
                            type: string
                        required:
                          - name
                          - error
                        type: object
                      type: array
                    lastUpdated:
                      description: When the rules were last updated
                      format: date-time
                      type: string
                    observedGeneration:
                      description: Generation of the most recently observed AuditRule
                      type: integer
                  type: object
              type: object
          served: true
          storage: true
          subresources:
            status: {}
  8: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: grype-offline-db
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          annotations: null
          labels:
            app: grype-offline-db
            app.kubernetes.io/component: grype-offline-db
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          containers:
            - image: quay.io/kubescape/grype-offline-db@sha256:56468cbe92622770860f5c2f96b43aca836f6466c1c95116a107d461f8de8592
              imagePullPolicy: Always
              name: grype-offline-db
              ports:
                - containerPort: 8080
                  protocol: TCP
              resources:
                limits:
                  cpu: 150m
                  memory: 200Mi
                requests:
                  cpu: 150m
                  memory: 200Mi
              securityContext:
                allowPrivilegeEscalation: false
                runAsNonRoot: true
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            seccompProfile:
              type: RuntimeDefault
          tolerations: null
  9: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
    spec:
      ingress:
        - from:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: kubevuln
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
          ports:
            - port: 8080
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: grype-offline-db
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
  10: |
    apiVersion: v1
    kind: Service
    metadata:
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
    spec:
      ports:
        - port: 80
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  11: |
    apiVersion: v1
    data:
      request-body.json: '{"commands":[{"CommandName":"kubescapeScan","args":{"scanV1":{}}}]}'
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: kubescape-scheduler
        app.kubernetes.io/component: kubescape-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-scheduler
      namespace: kubescape
  12: |
    apiVersion: batch/v1
    kind: CronJob
    metadata:
      annotations: null
      labels:
        app: kubescape-scheduler
        app.kubernetes.io/component: kubescape-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        armo.tier: kubescape-scan
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-scheduler
      namespace: kubescape
    spec:
      failedJobsHistoryLimit: 1
      jobTemplate:
        spec:
          template:
            metadata:
              annotations: null
              labels:
                app: kubescape-scheduler
                app.kubernetes.io/component: kubescape-scheduler
                app.kubernetes.io/instance: RELEASE-NAME
                app.kubernetes.io/managed-by: Helm
                app.kubernetes.io/name: kubescape-operator
                app.kubernetes.io/part-of: kubescape
                app.kubernetes.io/version: 1.29.9
                armo.tier: kubescape-scan
                helm.sh/chart: kubescape-operator-1.29.9
                kubescape.io/ignore: "true"
                kubescape.io/tier: core
                tier: ks-control-plane
            spec:
              affinity: null
              automountServiceAccountToken: false
              containers:
                - args:
                    - -method=post
                    - -scheme=http
                    - -host=operator:4002
                    - -path=v1/triggerAction
                    - -headers=Content-Type:application/json
                    - -path-body=/home/ks/request-body.json
                  image: quay.io/kubescape/http-request:v0.2.14
                  imagePullPolicy: IfNotPresent
                  name: kubescape-scheduler
                  resources:
                    limits:
                      cpu: 10m
                      memory: 20Mi
                    requests:
                      cpu: 1m
                      memory: 10Mi
                  securityContext:
                    allowPrivilegeEscalation: false
                    readOnlyRootFilesystem: true
                    runAsNonRoot: true
                    runAsUser: 100
                  volumeMounts:
                    - mountPath: /home/ks/request-body.json
                      name: kubescape-scheduler
                      readOnly: true
                      subPath: request-body.json
              nodeSelector:
                kubernetes.io/os: linux
              restartPolicy: Never
              securityContext:
                seccompProfile:
                  type: RuntimeDefault
              serviceAccountName: kubescape
              tolerations: null
              volumes:
                - configMap:
                    name: kubescape-scheduler
                  name: kubescape-scheduler
      schedule: 1 2 3 4 5
      successfulJobsHistoryLimit: 3
  13: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      labels:
        app: kubescape-scheduler
        app.kubernetes.io/component: kubescape-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-scheduler
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 4002
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: operator
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
      podSelector:
        matchLabels:
          app.kubernetes.io/component: kubescape-scheduler
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Egress
  14: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - pods
          - pods/proxy
          - namespaces
          - nodes
          - configmaps
          - services
          - serviceaccounts
          - endpoints
          - persistentvolumeclaims
          - persistentvolumes
          - limitranges
          - replicationcontrollers
          - podtemplates
          - resourcequotas
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - secrets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - admissionregistration.k8s.io
        resources:
          - mutatingwebhookconfigurations
          - validatingwebhookconfigurations
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apiregistration.k8s.io
        resources:
          - apiservices
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - deployments
          - statefulsets
          - daemonsets
          - replicasets
          - controllerrevisions
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - autoscaling
        resources:
          - horizontalpodautoscalers
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - coordination.k8s.io
        resources:
          - leases
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - discovery.k8s.io
        resources:
          - endpointslices
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - events.k8s.io
        resources:
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - hostdata.kubescape.cloud
        resources:
          - APIServerInfo
          - ControlPlaneInfo
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - networking.k8s.io
        resources:
          - networkpolicies
          - Ingress
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - cilium.io
        resources:
          - ciliumnetworkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - projectcalico.org
        resources:
          - networkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - networking.istio.io
        resources:
          - gateways
          - virtualservices
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - security.istio.io
        resources:
          - authorizationpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - policy
        resources:
          - poddisruptionbudgets
          - podsecuritypolicies
          - PodSecurityPolicy
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - rbac.authorization.k8s.io
        resources:
          - clusterroles
          - clusterrolebindings
          - roles
          - rolebindings
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - storage.k8s.io
        resources:
          - csistoragecapacities
          - storageclasses
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - networking.k8s.io
        resources:
          - ingresses
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - extensions
        resources:
          - Ingress
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - gateway.networking.k8s.io
        resources:
          - httproutes
          - gateways
          - gatewayclasses
          - tcproutes
          - tlsroutes
          - udproutes
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - namespaces
        verbs:
          - update
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - workloadconfigurationscans
          - workloadconfigurationscansummaries
        verbs:
          - create
          - get
          - update
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
  15: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: kubescape
    subjects:
      - kind: ServiceAccount
        name: kubescape
        namespace: kubescape
  16: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: kubescape
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          annotations:
            checksum/cloud-config: 8e6c3d6c7321da0fccdb7ce24882e7bcf831736b163bb916902ed635fd2809eb
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/host-scanner-configmap: de92a2b49dedb88c748db85959afdb8078c5b15135d2755a4d6b1e896825e27f
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
          labels:
            app: kubescape
            app.kubernetes.io/component: kubescape
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - command:
                - ksserver
              env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: KS_DOWNLOAD_ARTIFACTS
                  value: "true"
                - name: RULE_PROCESSING_GOMAXPROCS
                  value: ""
                - name: KS_DEFAULT_CONFIGMAP_NAME
                  value: kubescape-config
                - name: KS_DEFAULT_CONFIGMAP_NAMESPACE
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: KS_CONTEXT
                  value: kind-kind
                - name: KS_DEFAULT_CLOUD_CONFIGMAP_NAME
                  value: ks-cloud-config
                - name: KS_ENABLE_HOST_SCANNER
                  value: "true"
                - name: KS_SKIP_UPDATE_CHECK
                  value: "false"
                - name: KS_HOST_SCAN_YAML
                  value: /home/nonroot/.kubescape/host-scanner.yaml
                - name: LARGE_CLUSTER_SIZE
                  value: "1500"
                - name: KS_EXCLUDE_NAMESPACES
                  value: kubescape,kube-system,kube-public,kube-node-lease,kubeconfig,gmp-system,gmp-public
              image: quay.io/kubescape/kubescape:v3.0.41
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 8080
                initialDelaySeconds: 3
                periodSeconds: 3
              name: kubescape
              ports:
                - containerPort: 8080
                  name: http
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 8080
                initialDelaySeconds: 3
                periodSeconds: 3
              resources:
                limits:
                  cpu: 600m
                  memory: 1Gi
                requests:
                  cpu: 250m
                  memory: 400Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /home/nonroot/.kubescape
                  name: kubescape-volume
                  subPath: config.json
                - mountPath: /home/nonroot/.kubescape/host-scanner.yaml
                  name: host-scanner-definition
                  subPath: host-scanner-yaml
                - mountPath: /home/nonroot/results
                  name: results
                - mountPath: /home/nonroot/failed
                  name: failed
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/services.json
                  name: services
                  readOnly: true
                  subPath: services.json
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
                - mountPath: /etc/ssl/certs/cert1.pem
                  name: extra-ca-certificates
                  subPath: cert1.pem
                - mountPath: /etc/ssl/certs/cert2.pem
                  name: extra-ca-certificates
                  subPath: cert2.pem
          initContainers:
            - args:
                - -method=get
                - -scheme=https
                - -host=api.armosec.io
                - -path=api/v2/servicediscovery
                - -path-output=/data/services.json
              env: null
              image: quay.io/kubescape/http-request:v0.2.14
              imagePullPolicy: IfNotPresent
              name: url-discovery
              resources:
                limits:
                  cpu: 100m
                  memory: 50Mi
                requests:
                  cpu: 10m
                  memory: 10Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: services
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: kubescape
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: extra-ca-certificates
              secret:
                secretName: extra-certificates
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - emptyDir: {}
              name: services
            - configMap:
                name: host-scanner-definition
              name: host-scanner-definition
            - emptyDir: {}
              name: kubescape-volume
            - emptyDir: {}
              name: results
            - emptyDir: {}
              name: failed
  17: |
    apiVersion: v1
    data:
      host-scanner-yaml: "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: host-scanner\n  namespace: kubescape\n  annotations:\n    \n  labels:\n    helm.sh/chart: kubescape-operator-1.29.9\n    app.kubernetes.io/name: kubescape-operator\n    app.kubernetes.io/instance: RELEASE-NAME\n    app.kubernetes.io/component: host-scanner\n    app.kubernetes.io/version: \"1.29.9\"\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/part-of: kubescape\n    app: host-scanner\n    tier: ks-control-plane\n    kubescape.io/ignore: \"true\"\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: kubescape-operator\n      app.kubernetes.io/instance: RELEASE-NAME\n      app.kubernetes.io/component: host-scanner\n  template:\n    metadata:\n      annotations:\n        \n      labels:\n        helm.sh/chart: kubescape-operator-1.29.9\n        app.kubernetes.io/name: kubescape-operator\n        app.kubernetes.io/instance: RELEASE-NAME\n        app.kubernetes.io/component: host-scanner\n        app.kubernetes.io/version: \"1.29.9\"\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/part-of: kubescape\n        app: host-scanner\n        tier: ks-control-plane\n        kubescape.io/ignore: \"true\"\n        kubescape.io/tier: \"core\"\n        name: host-scanner\n    spec:\n      nodeSelector:\n        kubernetes.io/os: linux\n      affinity:\n      tolerations:\n        - effect: NoSchedule\n          key: node-role.kubernetes.io/control-plane\n          operator: Exists\n        - effect: NoSchedule\n          key: node-role.kubernetes.io/master\n          operator: Exists\n      containers:\n      - name: host-sensor\n        image: \"quay.io/kubescape/host-scanner:v1.0.76\"\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: true\n          privileged: true\n          readOnlyRootFilesystem: true\n          procMount: Unmasked\n        env:\n        - name: KS_LOGGER_LEVEL\n          value: \"info\"\n        - name: KS_LOGGER_NAME\n          value: \"zap\"\n        ports:\n          - name: scanner # Do not change port name\n            containerPort: 7888\n            protocol: TCP\n        resources:\n          limits:\n            cpu: 0.4m\n            memory: 400Mi\n          requests:\n            cpu: 0.1m\n            memory: 200Mi\n        volumeMounts:\n        - mountPath: /host_fs\n          name: host-filesystem\n        startupProbe:\n          httpGet:\n            path: /readyz\n            port: 7888\n          failureThreshold: 30\n          periodSeconds: 1\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 7888\n          periodSeconds: 10\n      terminationGracePeriodSeconds: 120\n      dnsPolicy: ClusterFirstWithHostNet\n      serviceAccountName: node-agent\n      automountServiceAccountToken: false\n      volumes:\n      - hostPath:\n          path: /\n          type: Directory\n        name: host-filesystem\n      hostPID: true\n      hostIPC: true"
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: host-scanner-definition
      namespace: kubescape
  18: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
        - ports:
            - port: 80
              protocol: TCP
          to:
            - ipBlock:
                cidr: 169.254.169.254/32
        - ports:
            - port: 8443
              protocol: TCP
          to:
            - ipBlock:
                cidr: 192.168.49.2/32
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
      ingress:
        - from:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: operator
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
          ports:
            - port: http
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: kubescape
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
        - Egress
  19: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    rules:
      - apiGroups:
          - apps
        resources:
          - daemonsets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  20: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: kubescape
    subjects:
      - kind: ServiceAccount
        name: kubescape
        namespace: kubescape
  21: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    spec:
      ports:
        - name: http
          port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  22: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
  23: |
    apiVersion: monitoring.coreos.com/v1
    kind: ServiceMonitor
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-monitor
      namespace: kubescape
    spec:
      endpoints:
        - interval: 200s
          path: /v1/metrics
          port: http
          scrapeTimeout: 150s
      namespaceSelector:
        matchNames:
          - kubescape
      selector:
        matchLabels:
          app.kubernetes.io/component: kubescape
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
  24: |
    apiVersion: v1
    data:
      request-body.json: '{"commands":[{"commandName":"scan","designators":[{"designatorType":"Attributes","attributes":{}}]}]}'
    kind: ConfigMap
    metadata:
      labels:
        app: kubevuln-scheduler
        app.kubernetes.io/component: kubevuln-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-scheduler
      namespace: kubescape
  25: |
    apiVersion: batch/v1
    kind: CronJob
    metadata:
      annotations: null
      labels:
        app: kubevuln-scheduler
        app.kubernetes.io/component: kubevuln-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        armo.tier: vuln-scan
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-scheduler
      namespace: kubescape
    spec:
      failedJobsHistoryLimit: 1
      jobTemplate:
        spec:
          template:
            metadata:
              annotations: null
              labels:
                app: kubevuln-scheduler
                app.kubernetes.io/component: kubevuln-scheduler
                app.kubernetes.io/instance: RELEASE-NAME
                app.kubernetes.io/managed-by: Helm
                app.kubernetes.io/name: kubescape-operator
                app.kubernetes.io/part-of: kubescape
                app.kubernetes.io/version: 1.29.9
                armo.tier: vuln-scan
                helm.sh/chart: kubescape-operator-1.29.9
                kubescape.io/ignore: "true"
                kubescape.io/tier: core
                tier: ks-control-plane
            spec:
              affinity: null
              automountServiceAccountToken: false
              containers:
                - args:
                    - -method=post
                    - -scheme=http
                    - -host=operator:4002
                    - -path=v1/triggerAction
                    - -headers=Content-Type:application/json
                    - -path-body=/home/ks/request-body.json
                  image: quay.io/kubescape/http-request:v0.2.14
                  imagePullPolicy: IfNotPresent
                  name: kubevuln-scheduler
                  resources:
                    limits:
                      cpu: 10m
                      memory: 20Mi
                    requests:
                      cpu: 1m
                      memory: 10Mi
                  securityContext:
                    allowPrivilegeEscalation: false
                    readOnlyRootFilesystem: true
                    runAsNonRoot: true
                    runAsUser: 100
                  volumeMounts:
                    - mountPath: /home/ks/request-body.json
                      name: kubevuln-scheduler
                      readOnly: true
                      subPath: request-body.json
              nodeSelector:
                kubernetes.io/os: linux
              restartPolicy: Never
              securityContext:
                seccompProfile:
                  type: RuntimeDefault
              serviceAccountName: kubevuln
              tolerations: null
              volumes:
                - configMap:
                    name: kubevuln-scheduler
                  name: kubevuln-scheduler
      schedule: 1 2 3 4 5
      successfulJobsHistoryLimit: 3
  26: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      labels:
        app: kubevuln-scheduler
        app.kubernetes.io/component: kubevuln-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln-scheduler
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 4002
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: operator
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
      podSelector:
        matchLabels:
          app.kubernetes.io/component: kubevuln-scheduler
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Egress
  27: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
    rules:
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - vulnerabilitymanifests
          - vulnerabilitymanifestsummaries
          - openvulnerabilityexchangecontainers
          - sbomsyfts
          - sbomsyftfiltereds
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - containerprofiles
        verbs:
          - get
          - watch
          - list
  28: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: kubevuln
    subjects:
      - kind: ServiceAccount
        name: kubevuln
        namespace: kubescape
  29: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: kubevuln
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations:
            checksum/cloud-config: 8e6c3d6c7321da0fccdb7ce24882e7bcf831736b163bb916902ed635fd2809eb
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
          labels:
            app: kubevuln
            app.kubernetes.io/component: kubevuln
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - args:
                - -alsologtostderr
                - -v=4
                - 2>&1
              env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: PRINT_POST_JSON
                  value: ""
                - name: CA_MAX_VULN_SCAN_ROUTINES
                  value: "1"
              image: quay.io/kubescape/kubevuln:v0.3.93
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /v1/liveness
                  port: 8080
                initialDelaySeconds: 3
                periodSeconds: 3
              name: kubevuln
              ports:
                - containerPort: 8080
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /v1/readiness
                  port: 8080
              resources:
                limits:
                  cpu: 1500m
                  ephemeral-storage: 10Gi
                  memory: 5000Mi
                requests:
                  cpu: 300m
                  ephemeral-storage: 5Gi
                  memory: 1000Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /tmp
                  name: tmp-dir
                - mountPath: /home/nonroot/anchore-resources/db
                  name: grype-db-cache
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/services.json
                  name: services
                  readOnly: true
                  subPath: services.json
                - mountPath: /home/nonroot/.cache/grype
                  name: grype-db
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
                - mountPath: /etc/ssl/certs/cert1.pem
                  name: extra-ca-certificates
                  subPath: cert1.pem
                - mountPath: /etc/ssl/certs/cert2.pem
                  name: extra-ca-certificates
                  subPath: cert2.pem
          initContainers:
            - args:
                - -method=get
                - -scheme=https
                - -host=api.armosec.io
                - -path=api/v2/servicediscovery
                - -path-output=/data/services.json
              env: null
              image: quay.io/kubescape/http-request:v0.2.14
              imagePullPolicy: IfNotPresent
              name: url-discovery
              resources:
                limits:
                  cpu: 100m
                  memory: 50Mi
                requests:
                  cpu: 10m
                  memory: 10Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: services
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: kubevuln
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: extra-ca-certificates
              secret:
                secretName: extra-certificates
            - emptyDir: {}
              name: tmp-dir
            - emptyDir: {}
              name: grype-db-cache
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - emptyDir: {}
              name: services
            - emptyDir: {}
              name: grype-db
  30: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
      ingress:
        - from:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: operator
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
          ports:
            - port: 8080
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: kubevuln
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
        - Egress
  31: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
    spec:
      ports:
        - port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  32: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
  33: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
    rules:
      - apiGroups:
          - ""
        resources:
          - nodes
          - nodes/proxy
          - services
          - endpoints
          - namespaces
          - configmaps
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - pods
        verbs:
          - get
          - watch
          - list
          - delete
      - apiGroups:
          - ""
        resources:
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - deployments
          - daemonsets
          - statefulsets
          - replicasets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - applicationprofiles
          - networkneighborhoods
          - seccompprofiles
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - containerprofiles
          - sbomsyfts
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - runtimerulealertbindings
        verbs:
          - list
          - watch
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands/status
        verbs:
          - get
          - watch
          - list
          - update
          - patch
      - apiGroups:
          - events.k8s.io
        resources:
          - events
        verbs:
          - create
          - patch
          - get
  34: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: node-agent
    subjects:
      - kind: ServiceAccount
        name: node-agent
        namespace: kubescape
  35: |
    apiVersion: v1
    data:
      config.json: |
        {
            "applicationProfileServiceEnabled": true,
            "prometheusExporterEnabled": false,
            "runtimeDetectionEnabled": false,
            "httpDetectionEnabled": false,
            "networkServiceEnabled": true,
            "malwareDetectionEnabled": false,
            "hostMalwareSensorEnabled": false,
            "hostNetworkSensorEnabled": false,
            "nodeProfileServiceEnabled": false,
            "networkStreamingEnabled": false,
            "maxImageSize": 5.36870912e+09,
            "maxSBOMSize": 2.097152e+07,
            "sbomGenerationEnabled": true,
            "enableEmbeddedSBOMs": false,
            "seccompServiceEnabled": false,
            "auditDetectionEnabled": true,
            "auditDetection": {
              "exporters": {"stdoutExporter":true},
              "eventFilter": {
                "includeTypes": [1300,1302,1309,1307,1317,1007,1327,1303,1324,1306,1404,1326]
              }
            },
            "initialDelay": "2m",
            "updateDataPeriod": "10m",
            "nodeProfileInterval": "10m",
            "networkStreamingInterval": "2m",
            "maxSniffingTimePerContainer": "24h",
            "excludeNamespaces": "kubescape,kube-system,kube-public,kube-node-lease,kubeconfig,gmp-system,gmp-public",
            "excludeLabels":null,
            "exporters": {
              "httpExporterConfig":{"maxAlertsPerMinute":1000,"method":"POST","url":"http://synchronizer:8089/apis/v1/kubescape.io"},
              "alertManagerExporterUrls":[],
              "stdoutExporter":true,
              "syslogExporterURL": ""
            },
            "excludeJsonPaths":null,
            "ruleCooldown": {
                "ruleCooldownDuration": "1h",
                "ruleCooldownAfterCount": 1,
                "ruleCooldownOnProfileFailure": true,
                "ruleCooldownMaxSize": 20000
            }
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
  36: |
    apiVersion: apps/v1
    kind: DaemonSet
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      selector:
        matchLabels:
          app.kubernetes.io/component: node-agent
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      template:
        metadata:
          annotations:
            checksum/cloud-config: 8e6c3d6c7321da0fccdb7ce24882e7bcf831736b163bb916902ed635fd2809eb
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/node-agent-config: 00f5a188e3045b7d99346fcbcc481452d18ecc5c97595bdc0909b20e9c8a2ea4
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
          labels:
            app: node-agent
            app.kubernetes.io/component: node-agent
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity:
            nodeAffinity:
              requiredDuringSchedulingIgnoredDuringExecution:
                nodeSelectorTerms:
                  - matchExpressions:
                      - key: kubernetes.io/os
                        operator: In
                        values:
                          - linux
          automountServiceAccountToken: true
          containers:
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: HOST_ROOT
                  value: /host
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
                - name: NAMESPACE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: KUBELET_ROOT
                  value: /var/lib/kubelet
                - name: NodeName
              image: quay.io/benarmosec/node-agent:test-v1
              imagePullPolicy: Always
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 7888
                initialDelaySeconds: 60
                periodSeconds: 3
              name: node-agent
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 7888
                initialDelaySeconds: 3
                periodSeconds: 3
              resources:
                limits:
                  cpu: 500m
                  memory: 1400Mi
                requests:
                  cpu: 100m
                  memory: 180Mi
              securityContext:
                capabilities:
                  add:
                    - SYS_ADMIN
                    - SYS_PTRACE
                    - NET_ADMIN
                    - SYSLOG
                    - SYS_RESOURCE
                    - IPC_LOCK
                    - NET_RAW
                    - AUDIT_READ
                    - AUDIT_WRITE
                    - AUDIT_CONTROL
                privileged: false
                runAsUser: 0
                seLinuxOptions:
                  type: spc_t
              volumeMounts:
                - mountPath: /host
                  name: host
                  readOnly: true
                - mountPath: /var/lib/kubelet
                  name: kubeletdir
                - mountPath: /run
                  name: run
                - mountPath: /var
                  name: var
                  readOnly: true
                - mountPath: /lib/modules
                  name: modules
                  readOnly: true
                - mountPath: /sys/kernel/debug
                  name: debugfs
                - mountPath: /sys/fs/cgroup
                  name: cgroup
                  readOnly: true
                - mountPath: /sys/fs/bpf
                  name: bpffs
                - mountPath: /data
                  name: data
                - mountPath: /profiles
                  name: profiles
                - mountPath: /boot
                  name: boot
                  readOnly: true
                - mountPath: /clamav
                  name: clamrun
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  readOnly: true
                  subPath: proxy.crt
                - mountPath: /etc/ssl/certs/cert1.pem
                  name: extra-ca-certificates
                  readOnly: true
                  subPath: cert1.pem
                - mountPath: /etc/ssl/certs/cert2.pem
                  name: extra-ca-certificates
                  readOnly: true
                  subPath: cert2.pem
          hostPID: true
          nodeSelector:
            kubernetes.io/os: linux
          priorityClassName: kubescape-critical
          securityContext:
            appArmorProfile:
              type: Unconfined
          serviceAccountName: node-agent
          tolerations: null
          volumes:
            - hostPath:
                path: /
              name: host
            - hostPath:
                path: /var/lib/kubelet
              name: kubeletdir
            - hostPath:
                path: /run
              name: run
            - hostPath:
                path: /var
              name: var
            - hostPath:
                path: /sys/fs/cgroup
              name: cgroup
            - hostPath:
                path: /lib/modules
              name: modules
            - hostPath:
                path: /sys/fs/bpf
              name: bpffs
            - hostPath:
                path: /sys/kernel/debug
              name: debugfs
            - hostPath:
                path: /boot
              name: boot
            - emptyDir: null
              name: data
            - emptyDir: null
              name: profiles
            - emptyDir: {}
              name: clamdb
            - emptyDir: {}
              name: clamrun
            - configMap:
                items:
                  - key: clamd.conf
                    path: clamd.conf
                  - key: freshclam.conf
                    path: freshclam.conf
                name: clamav
              name: etc
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: node-agent
              name: config
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: extra-ca-certificates
              secret:
                secretName: extra-certificates
  37: |
    apiVersion: kubescape.io/v1
    kind: RuntimeRuleAlertBinding
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: all-rules-all-pods
    spec:
      namespaceSelector:
        matchExpressions:
          - key: kubernetes.io/metadata.name
            operator: NotIn
            values:
              - kubescape
              - kube-system
              - kube-public
              - kube-node-lease
              - kubeconfig
              - gmp-system
              - gmp-public
      rules:
        - ruleName: Unexpected process launched
        - parameters:
            ignoreMounts: true
            ignorePrefixes:
              - /proc
              - /run/secrets/kubernetes.io/serviceaccount
              - /var/run/secrets/kubernetes.io/serviceaccount
              - /tmp
            includePrefixes:
              - /etc
              - /var/spool/cron/
              - /var/log/
              - /var/run/
              - /dev/shm/
              - /run/
              - /var/www/
              - /var/lib/docker/
              - /opt/
              - /usr/local/
              - /app/
              - /.dockerenv
              - /proc/self/environ
              - /var/lib/kubelet/
              - /etc/cni/net.d/
              - /var/run/secrets/kubernetes.io/
              - /var/run/secrets/kubernetes.io/serviceaccount/
              - /run/containerd/
              - /run/flannel/
              - /run/calico/
          ruleName: Unexpected file access
        - ruleName: Unexpected system call
        - ruleName: Unexpected capability used
        - ruleName: Unexpected domain request
        - ruleName: Unexpected Service Account Token Access
        - ruleName: Kubernetes Client Executed
        - ruleName: Exec from malicious source
        - ruleName: Kernel Module Load
        - ruleName: Exec Binary Not In Base Image
        - ruleName: Fileless Execution
        - ruleName: XMR Crypto Mining Detection
        - ruleName: Exec from mount
        - ruleName: Crypto Mining Related Port Communication
        - ruleName: Crypto Mining Domain Communication
        - ruleName: Read Environment Variables from procfs
        - ruleName: eBPF Program Load
        - ruleName: Symlink Created Over Sensitive File
        - ruleName: Unexpected Sensitive File Access
        - ruleName: Hardlink Created Over Sensitive File
        - ruleName: Exec to pod
        - ruleName: Port forward
        - ruleName: Malicious Ptrace Usage
        - ruleName: Cross-Site Scripting (XSS) Attempt
        - ruleName: SQL Injection Attempt
        - ruleName: Server-Side Request Forgery Attack Attempt
        - ruleName: Remote File Inclusion Attack Attempt
        - ruleName: Local File Inclusion Attempt
        - ruleName: XML External Entity Attack Attempt
        - ruleName: Server-Side Template Injection Attack
        - ruleName: Command Injection Attempt
        - ruleName: Unexpected Exec Source
        - ruleName: Unexpected Open Source
        - ruleName: Unexpected Symlink Source
        - ruleName: Unexpected Hardlink Source
        - ruleName: Unexpected io_uring Operation Detected
        - ruleName: ReDoS Attack
        - ruleName: Prototype Pollution Attack
        - ruleName: Execution of base64 Encoded Command
        - ruleName: Execution of interpreter command
        - ruleName: Code Sharing Site Access
        - ruleName: Web Application File Write Access
        - ruleName: Cron Job File Created or Modified
        - ruleName: Hidden File Created
        - ruleName: Reverse Shell Patterens Detected
        - ruleName: Unauthorized IMDS Connection Attempt
        - ruleName: Credentials Detection Attempts
        - ruleName: HTTP Request Smuggling Attempt
        - ruleName: P2P Tracker Connection Created
  38: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 8443
              protocol: TCP
          to:
            - ipBlock:
                cidr: 192.168.49.2/32
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
      podSelector:
        matchLabels:
          app.kubernetes.io/component: node-agent
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Egress
  39: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      ports:
        - name: prometheus
          port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
  40: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
  41: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
    rules:
      - apiGroups:
          - ""
        resources:
          - pods
          - nodes
          - namespaces
          - configmaps
          - services
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - secrets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - delete
          - patch
      - apiGroups:
          - apps
        resources:
          - deployments
          - daemonsets
          - statefulsets
          - replicasets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - vulnerabilitymanifests
          - vulnerabilitymanifestsummaries
          - workloadconfigurationscans
          - workloadconfigurationscansummaries
          - openvulnerabilityexchangecontainers
          - containerprofiles
          - sbomsyfts
        verbs:
          - get
          - watch
          - list
          - delete
      - apiGroups:
          - kubescape.io
        resources:
          - runtimerulealertbindings
        verbs:
          - list
          - watch
          - get
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - delete
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands/status
        verbs:
          - get
          - watch
          - list
          - update
          - patch
  42: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: operator
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  43: |
    apiVersion: v1
    data:
      config.json: |
        {
          "excludeNamespaces": "kubescape,kube-system,kube-public,kube-node-lease,kubeconfig,gmp-system,gmp-public",
          "namespace": "kubescape",
          "triggersecurityframework": true,
          "podScanGuardTime": "1h",
          "excludeJsonPaths":null,
          "httpExporterConfig":{"maxAlertsPerMinute":1000,"method":"POST","url":"http://synchronizer:8089/apis/v1/kubescape.io"}
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: operator
      namespace: kubescape
  44: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: operator
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          annotations:
            checksum/capabilities-config: d9d3c170ad04ba3bcc515103647d6aad13d137c3eb56c289303f04845b314b89
            checksum/cloud-config: 8e6c3d6c7321da0fccdb7ce24882e7bcf831736b163bb916902ed635fd2809eb
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/matching-rules-config: c81857b415602f6b161db3199a16461c5acd8ba44ec7572189441f4f294a3614
            checksum/operator-config: da09bdb4e250d772ca02bb727ed10e0d0ad2f8e878bf136339036a2eee71161d
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
          labels:
            app: operator
            app.kubernetes.io/component: operator
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - env:
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: HELM_RELEASE
                  value: kubescape-operator-1.29.9
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
              image: quay.io/kubescape/operator:v0.2.109
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /v1/liveness
                  port: readiness-port
                initialDelaySeconds: 3
                periodSeconds: 3
              name: operator
              ports:
                - containerPort: 4002
                  name: trigger-port
                  protocol: TCP
                - containerPort: 8000
                  name: readiness-port
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /v1/readiness
                  port: readiness-port
                initialDelaySeconds: 10
                periodSeconds: 5
              resources:
                limits:
                  cpu: 300m
                  memory: 300Mi
                requests:
                  cpu: 50m
                  memory: 100Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /tmp
                  name: tmp-dir
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/capabilities.json
                  name: ks-capabilities
                  readOnly: true
                  subPath: capabilities.json
                - mountPath: /etc/config/matchingRules.json
                  name: cs-matching-rules
                  readOnly: true
                  subPath: matchingRules.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/ssl/certs/cert1.pem
                  name: extra-ca-certificates
                  subPath: cert1.pem
                - mountPath: /etc/ssl/certs/cert2.pem
                  name: extra-ca-certificates
                  subPath: cert2.pem
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: operator
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: extra-ca-certificates
              secret:
                secretName: extra-certificates
            - emptyDir: {}
              name: tmp-dir
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: capabilities
                    path: capabilities.json
                name: ks-capabilities
              name: ks-capabilities
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: operator
              name: config
            - configMap:
                items:
                  - key: matchingRules.json
                    path: matchingRules.json
                name: cs-matching-rules
              name: cs-matching-rules
  45: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: kubescape-scheduler
          namespace: kubescape
          labels:
            app: kubescape-scheduler
            tier: ks-control-plane
            kubescape.io/tier: "core"
            armo.tier: "kubescape-scan"
        spec:
          schedule: "1 2 3 4 5"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "kubescape-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  containers:
                  - name: kubescape-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubescape
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: kubescape-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-cronjob-template
      namespace: kubescape
  46: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: kubevuln-scheduler
          namespace: kubescape
          labels:
            app: kubevuln-scheduler
            tier: ks-control-plane
            kubescape.io/tier: "core"
            armo.tier: "vuln-scan"
        spec:
          schedule: "1 2 3 4 5"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "vuln-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  containers:
                  - name: kubevuln-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubevuln
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: kubevuln-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-cronjob-template
      namespace: kubescape
  47: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
        - ports:
            - port: 80
              protocol: TCP
          to:
            - ipBlock:
                cidr: 169.254.169.254/32
        - ports:
            - port: 8080
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: kubescape
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 8080
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: kubevuln
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 8443
              protocol: TCP
          to:
            - ipBlock:
                cidr: 192.168.49.2/32
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
      ingress:
        - from:
            - podSelector:
                matchLabels:
                  armo.tier: kubescape-scan
            - podSelector:
                matchLabels:
                  armo.tier: vuln-scan
          ports:
            - port: trigger-port
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: operator
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
        - Egress
  48: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: registry-scheduler
          namespace: kubescape
          labels:
            app: registry-scheduler
            kubescape.io/tier: "core"
            tier: ks-control-plane
            armo.tier: "registry-scan"
        spec:
          schedule: "0 0 * * *"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "registry-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  containers:
                  - name: registry-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubevuln
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: registry-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: registry-scan-cronjob-template
      namespace: kubescape
  49: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - configmaps
          - secrets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
      - apiGroups:
          - batch
        resources:
          - cronjobs
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  50: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: operator
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  51: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      ports:
        - port: 4002
          protocol: TCP
          targetPort: 4002
      selector:
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  52: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
  53: |
    apiVersion: v1
    data:
      proxy.crt: foo
    kind: Secret
    metadata:
      annotations:
        helm.sh/hook: pre-install,pre-upgrade
        helm.sh/hook-delete-policy: before-hook-creation
        helm.sh/hook-weight: "0"
      labels:
        app: kubescape-proxy-certificate
        app.kubernetes.io/component: kubescape-proxy-certificate
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-proxy-certificate
      namespace: kubescape
    type: Opaque
  54: |
    apiVersion: apiregistration.k8s.io/v1
    kind: APIService
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: v1beta1.spdx.softwarecomposition.kubescape.io
    spec:
      caBundle: bW9jay1jYS1jZXJ0
      group: spdx.softwarecomposition.kubescape.io
      groupPriorityMinimum: 1000
      service:
        name: storage
        namespace: kubescape
      version: v1beta1
      versionPriority: 15
  55: |
    apiVersion: v1
    data:
      ca.crt: bW9jay1jYS1jZXJ0
      tls.crt: bW9jay1jZXJ0LWNlcnQ=
      tls.key: bW9jay1jZXJ0LWtleQ==
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage-ca
      namespace: kubescape
    type: kubernetes.io/tls
  56: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
    rules:
      - apiGroups:
          - ""
        resources:
          - namespaces
          - pods
          - services
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - admissionregistration.k8s.io
        resources:
          - mutatingwebhookconfigurations
          - validatingwebhookconfigurations
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - daemonsets
          - deployments
          - replicasets
          - statefulsets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - cronjobs
          - jobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - flowcontrol.apiserver.k8s.io
        resources:
          - prioritylevelconfigurations
          - flowschemas
        verbs:
          - get
          - watch
          - list
  57: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage:system:auth-delegator
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:auth-delegator
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  58: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: storage
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  59: |
    apiVersion: v1
    data:
      config.json: |
        {
          "cleanupInterval": "6h",
          "disableVirtualCRDs": true,
          "excludeJsonPaths": null,
          "defaultQueueLength": 100,
          "defaultWorkerCount": 2,
          "defaultMaxObjectSize": 400000,
          "queueManagerEnabled": true,
          "kindQueues": {"applicationprofiles":{"maxObjectSize":20000000,"queueLength":50,"workerCount":2},"containerprofiles":{"maxObjectSize":2500000,"queueLength":50,"workerCount":2},"networkneighborhoods":{"maxObjectSize":10000000,"queueLength":50,"workerCount":2},"openvulnerabilityexchangecontainers":{"maxObjectSize":500000,"queueLength":50,"workerCount":1},"sbomsyftfiltereds":{"maxObjectSize":50000000,"queueLength":50,"workerCount":1},"sbomsyfts":{"maxObjectSize":100000000,"queueLength":50,"workerCount":1},"vulnerabilitymanifests":{"maxObjectSize":50000000,"queueLength":50,"workerCount":1}},
          "tlsClientCaFile": "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt",
          "tlsServerCertFile": "/etc/storage-ca-certificates/tls.crt",
          "tlsServerKeyFile": "/etc/storage-ca-certificates/tls.key",
          "serverBindPort": "8443"
        }
    kind: ConfigMap
    metadata:
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: storage
      namespace: kubescape
  60: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: storage
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations: null
          labels:
            app: storage
            app.kubernetes.io/component: storage
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          containers:
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
              image: quay.io/kubescape/storage:v0.0.220
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 8443
                  scheme: HTTPS
              name: apiserver
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 8443
                  scheme: HTTPS
              resources:
                limits:
                  cpu: 1500m
                  memory: 1500Mi
                requests:
                  cpu: 100m
                  memory: 400Mi
              securityContext:
                allowPrivilegeEscalation: false
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: data
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/storage-ca-certificates
                  name: ca-certificates
                  readOnly: true
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: storage
          tolerations: null
          volumes:
            - name: data
              persistentVolumeClaim:
                claimName: kubescape-storage
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: storage
              name: config
            - name: ca-certificates
              secret:
                secretName: storage-ca
  61: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 8443
              protocol: TCP
          to:
            - ipBlock:
                cidr: 192.168.49.2/32
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
      podSelector:
        matchLabels:
          app.kubernetes.io/component: storage
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Egress
  62: |
    apiVersion: v1
    kind: PersistentVolumeClaim
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-storage
      namespace: kubescape
    spec:
      accessModes:
        - ReadWriteOnce
      resources:
        requests:
          storage: 5Gi
  63: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage-auth-reader
      namespace: kube-system
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: extension-apiserver-authentication-reader
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  64: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      ports:
        - name: https
          port: 443
          protocol: TCP
          targetPort: 8443
      selector:
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
  65: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
  66: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
    rules:
      - apiGroups:
          - storage.k8s.io
        resources:
          - storageclasses
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - rbac.authorization.k8s.io
        resources:
          - rolebindings
          - clusterrolebindings
          - roles
          - clusterroles
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - ""
        resources:
          - pods
          - namespaces
          - nodes
          - configmaps
          - persistentvolumes
          - services
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - apps
        resources:
          - deployments
          - statefulsets
          - daemonsets
          - replicasets
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - networking.k8s.io
        resources:
          - networkpolicies
          - ingresses
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - applicationprofiles
          - networkneighborhoods
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - patch
          - delete
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - knownservers
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - patch
          - delete
      - apiGroups:
          - cilium.io
        resources:
          - ciliumnetworkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - projectcalico.org
        resources:
          - networkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - networking.istio.io
        resources:
          - gateways
          - virtualservices
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - security.istio.io
        resources:
          - authorizationpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - gateway.networking.k8s.io
        resources:
          - httproutes
          - tcproutes
          - udproutes
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - patch
          - delete
  67: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: synchronizer
    subjects:
      - kind: ServiceAccount
        name: synchronizer
        namespace: kubescape
  68: |
    apiVersion: v1
    data:
      config.json: |
        {
          "inCluster": {
            "excludeNamespaces": "kubescape,kube-system,kube-public,kube-node-lease,kubeconfig,gmp-system,gmp-public",
            "resources": [
              {
                "group": "",
                "version": "v1",
                "resource": "services",
                "strategy": "patch"
              },
              {
                "group": "networking.k8s.io",
                "version": "v1",
                "resource": "ingresses",
                "strategy": "patch"
              },
              {
                "group": "gateway.networking.k8s.io",
                "version": "v1",
                "resource": "httproutes",
                "strategy": "patch"
              },
              {
                "group": "gateway.networking.k8s.io",
                "version": "v1",
                "resource": "tcproutes",
                "strategy": "patch"
              },
              {
                "group": "gateway.networking.k8s.io",
                "version": "v1",
                "resource": "udproutes",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "rolebindings",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "clusterrolebindings",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "clusterroles",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "roles",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "persistentvolumes",
                "strategy": "patch"
              },
              {
                "group": "storage.k8s.io",
                "version": "v1",
                "resource": "storageclasses",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "deployments",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "statefulsets",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "daemonsets",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "replicasets",
                "strategy": "patch"
              },
              {
                "group": "batch",
                "version": "v1",
                "resource": "jobs",
                "strategy": "patch"
              },
              {
                "group": "batch",
                "version": "v1",
                "resource": "cronjobs",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "pods",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "namespaces",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "nodes",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "configmaps",
                "strategy": "patch"
              },
              {
                "group": "networking.k8s.io",
                "version": "v1",
                "resource": "networkpolicies",
                "strategy": "patch"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "applicationprofiles",
                "strategy": "copy"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "knownservers",
                "strategy": "copy"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "networkneighborhoods",
                "strategy": "copy"
              },
              {
                "group": "cilium.io",
                "version": "v2",
                "resource": "ciliumnetworkpolicies",
                "strategy": "patch"
              },
              {
                "group": "projectcalico.org",
                "version": "v3",
                "resource": "networkpolicies",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1",
                "resource": "gateways",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1",
                "resource": "virtualservices",
                "strategy": "patch"
              },
              {
                "group": "security.istio.io",
                "version": "v1",
                "resource": "authorizationpolicies",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1beta1",
                "resource": "gateways",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1beta1",
                "resource": "virtualservices",
                "strategy": "patch"
              },
              {
                "group": "security.istio.io",
                "version": "v1beta1",
                "resource": "authorizationpolicies",
                "strategy": "patch"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "servicesscanresults",
                "strategy": "patch"
              },
              {
                "group": "kubescape.io",
                "version": "v1alpha1",
                "resource": "operatorcommands",
                "strategy": "copy"
              }
            ]
          },
          "httpEndpoint": {
            "serverPort": "8089",
            "resources": [
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "networkstreams",
                "strategy": "copy"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "nodeprofiles",
                "strategy": "copy"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "runtimealerts",
                "strategy": "copy"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "registrystatuses",
                "strategy": "copy"
              }
            ]
          }
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
  69: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: synchronizer
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations:
            checksum/cloud-config: 8e6c3d6c7321da0fccdb7ce24882e7bcf831736b163bb916902ed635fd2809eb
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
            checksum/synchronizer-configmap: d04a30312a4acce7a0a696f17f8bb210b0f5cccb8b7135df604e79a4d2b7d7d3
          labels:
            app: synchronizer
            app.kubernetes.io/component: synchronizer
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - command:
                - /usr/bin/client
              env:
                - name: HELM_RELEASE
                  value: kubescape-operator-1.29.9
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
              image: quay.io/kubescape/synchronizer:v0.0.116
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /healthz
                  port: 7888
                initialDelaySeconds: 10
                periodSeconds: 30
                timeoutSeconds: 10
              name: synchronizer
              resources:
                limits:
                  cpu: 200m
                  memory: 500Mi
                requests:
                  cpu: 100m
                  memory: 250Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/services.json
                  name: services
                  readOnly: true
                  subPath: services.json
                - mountPath: /etc/ssl/certs/cert1.pem
                  name: extra-ca-certificates
                  subPath: cert1.pem
                - mountPath: /etc/ssl/certs/cert2.pem
                  name: extra-ca-certificates
                  subPath: cert2.pem
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
          initContainers:
            - args:
                - -method=get
                - -scheme=https
                - -host=api.armosec.io
                - -path=api/v2/servicediscovery
                - -path-output=/data/services.json
              env: null
              image: quay.io/kubescape/http-request:v0.2.14
              imagePullPolicy: IfNotPresent
              name: url-discovery
              resources:
                limits:
                  cpu: 100m
                  memory: 50Mi
                requests:
                  cpu: 10m
                  memory: 10Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: services
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: synchronizer
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: extra-ca-certificates
              secret:
                secretName: extra-certificates
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - emptyDir: {}
              name: services
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: synchronizer
              name: config
  70: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
        - ports:
            - port: 8443
              protocol: TCP
          to:
            - ipBlock:
                cidr: 192.168.49.2/32
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
      ingress:
        - from:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: node-agent
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
          ports:
            - port: 8089
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: synchronizer
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
        - Egress
  71: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - configmaps
          - secrets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
      - apiGroups:
          - batch
        resources:
          - cronjobs
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  72: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: synchronizer
    subjects:
      - kind: ServiceAccount
        name: synchronizer
        namespace: kubescape
  73: |
    apiVersion: v1
    kind: Service
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    spec:
      ports:
        - port: 8089
          protocol: TCP
          targetPort: 8089
      selector:
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  74: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
disable otel:
  1: |+
    raw: |+
      Thank you for installing kubescape-operator version 1.29.9.







  2: |
    apiVersion: v1
    data:
      accessKey: ZjMwNGQ3M2ItZDQzYy00MTJiLTgyZWEtZTRjODU5NDkzY2U2
      account: OWU2YzBjMmMtNmJkMC00OTE5LTgxNWItNTUwMzBkZTdjOWEw
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: cloud-secret
        app.kubernetes.io/component: cloud-secret
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/infra: credentials
        tier: ks-control-plane
      name: cloud-secret
      namespace: kubescape
    type: Opaque
  3: |
    apiVersion: v1
    data:
      clusterData: |
        {
          "serviceDiscovery": true,
          "vulnScanURL": "kubevuln:8080",
          "kubevulnURL": "kubevuln:8080",
          "kubescapeURL": "kubescape:8080",
          "clusterName": "kind-kind",
          "storage": true,
          "relevantImageVulnerabilitiesEnabled": false,
          "namespace": "kubescape",
          "imageVulnerabilitiesScanningEnabled": false,
          "postureScanEnabled": false,
          "otelCollector": false,
          "nodeAgent": "true",
          "maxImageSize": 5.36870912e+09,
          "maxSBOMSize": 2.097152e+07,
          "keepLocal": false,
          "scanTimeout": "5m",
          "scanEmbeddedSBOMs": false,
          "vexGeneration": false,
          "useDefaultMatchers": false,
          "storeFilteredSbom": false,
          "continuousPostureScan": false,
          "relevantImageVulnerabilitiesConfiguration": "disable"
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/infra: config
        kubescape.io/tier: core
        tier: ks-control-plane
      name: ks-cloud-config
      namespace: kubescape
  4: |
    apiVersion: v1
    data:
      capabilities: |
        {
          "capabilities":{"admissionController":"disable","autoUpgrading":"disable","configurationScan":"disable","httpDetection":"disable","kubescapeOffline":"disable","linuxAudit":"enable","malwareDetection":"disable","manageWorkloads":"disable","networkEventsStreaming":"disable","networkPolicyService":"disable","nodeProfileService":"disable","nodeSbomGeneration":"enable","nodeScan":"disable","prometheusExporter":"disable","relevancy":"disable","runtimeDetection":"disable","runtimeObservability":"enable","scanEmbeddedSBOMs":"disable","seccompProfileService":"disable","syncSBOM":"disable","testing":{"nodeAgentMultiplication":{"enabled":false,"replicas":5}},"vexGeneration":"disable","vulnerabilityScan":"disable"},
          "components":{"autoUpdater":{"enabled":false},"clamAV":{"enabled":false},"cloudSecret":{"create":true,"name":"cloud-secret"},"customCaCertificates":{"name":"custom-ca-certificates"},"hostScanner":{"enabled":false},"kubescape":{"enabled":false},"kubescapeScheduler":{"enabled":false},"kubevuln":{"enabled":false},"kubevulnScheduler":{"enabled":false},"nodeAgent":{"enabled":true},"operator":{"enabled":true},"otelCollector":{"enabled":false},"prometheusExporter":{"enabled":false},"serviceDiscovery":{"enabled":true},"storage":{"enabled":true},"synchronizer":{"enabled":true}},
          "configurations":{"excludeJsonPaths":null,"otelUrl":null,"persistence":"enable","priorityClass":{"daemonset":100000100,"enabled":true},"prometheusAnnotations":"disable"} ,
          "serviceScanConfig" :{"enabled":false,"interval":"1h"}
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-capabilities
        app.kubernetes.io/component: ks-capabilities
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: ks-capabilities
      namespace: kubescape
  5: |
    apiVersion: v1
    data:
      matchingRules.json: |
        {"match":[{"apiGroups":["apps"],"apiVersions":["v1"],"resources":["deployments"]}],"namespaces":["default"]}
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: cs-matching-rules
      namespace: kubescape
  6: |
    apiVersion: scheduling.k8s.io/v1
    description: This priority class is for node-agent daemonset pods
    globalDefault: false
    kind: PriorityClass
    metadata:
      annotations: null
      labels:
        app: kubescape-critical
        app.kubernetes.io/component: kubescape-critical
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-critical
    value: 1.000001e+08
  7: |
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      labels:
        app: linux-audit-rules
        app.kubernetes.io/component: linux-audit-rules
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: linuxauditrules.kubescape.io
    spec:
      group: kubescape.io
      names:
        kind: LinuxAuditRule
        plural: linuxauditrules
        shortNames:
          - lar
          - linuxauditrule
          - auditrule
        singular: linuxauditrule
      scope: Namespaced
      versions:
        - additionalPrinterColumns:
            - description: Whether the Linux audit rules are enabled
              jsonPath: .spec.enabled
              name: Enabled
              type: boolean
            - description: Number of Linux audit rules defined
              jsonPath: .status.appliedRules
              name: Rules
              type: integer
            - description: Status of the Linux audit rules
              jsonPath: .status.conditions[?(@.type=="Ready")].status
              name: Status
              type: string
            - jsonPath: .metadata.creationTimestamp
              name: Age
              type: date
          name: v1
          schema:
            openAPIV3Schema:
              properties:
                spec:
                  properties:
                    enabled:
                      default: true
                      description: Controls whether these rules should be active
                      type: boolean
                    nodeSelector:
                      additionalProperties:
                        type: string
                      description: Node selector to target specific nodes
                      type: object
                    rateLimit:
                      description: Rate limiting configuration
                      properties:
                        burstSize:
                          description: Burst size for rate limiting
                          minimum: 1
                          type: integer
                        eventsPerSecond:
                          description: Maximum events per second
                          minimum: 1
                          type: integer
                      type: object
                    rules:
                      description: List of audit rule definitions
                      items:
                        properties:
                          description:
                            description: Human-readable description of what this rule monitors
                            type: string
                          enabled:
                            default: true
                            description: Controls whether this specific rule is active
                            type: boolean
                          fileWatch:
                            description: File system monitoring rule
                            properties:
                              exclude:
                                description: Exclude patterns (basic glob patterns)
                                items:
                                  type: string
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              paths:
                                description: Paths to monitor
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              permissions:
                                description: Permissions to monitor
                                items:
                                  enum:
                                    - read
                                    - write
                                    - attr
                                    - attribute
                                    - execute
                                  type: string
                                minItems: 1
                                type: array
                              recursive:
                                default: false
                                description: Recursive monitoring (future use)
                                type: boolean
                            required:
                              - paths
                              - permissions
                              - keys
                            type: object
                          name:
                            description: Unique name of this rule within the CRD
                            type: string
                          network:
                            description: Network monitoring rule (future extension)
                            properties:
                              addresses:
                                description: Addresses to monitor
                                items:
                                  type: string
                                type: array
                              direction:
                                description: Traffic direction
                                enum:
                                  - inbound
                                  - outbound
                                  - both
                                type: string
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              ports:
                                description: Ports to monitor
                                items:
                                  maximum: 65535
                                  minimum: 1
                                  type: integer
                                type: array
                              protocols:
                                description: Protocols to monitor
                                items:
                                  enum:
                                    - tcp
                                    - udp
                                    - icmp
                                  type: string
                                type: array
                            required:
                              - keys
                            type: object
                          priority:
                            default: 100
                            description: Priority for rule ordering (lower = higher priority)
                            maximum: 1000
                            minimum: 1
                            type: integer
                          process:
                            description: Process monitoring rule
                            properties:
                              arguments:
                                description: Command line argument patterns
                                items:
                                  type: string
                                type: array
                              executables:
                                description: Executables to monitor (path patterns)
                                items:
                                  type: string
                                type: array
                              filters:
                                description: Additional filters
                                items:
                                  properties:
                                    field:
                                      description: Field to filter on
                                      type: string
                                    operator:
                                      description: Comparison operator
                                      enum:
                                        - =
                                        - '!='
                                        - <
                                        - '>'
                                        - <=
                                        - '>='
                                      type: string
                                    value:
                                      description: Value to compare against
                                      type: string
                                  required:
                                    - field
                                    - operator
                                    - value
                                  type: object
                                type: array
                              groups:
                                description: Groups to monitor
                                items:
                                  type: string
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              users:
                                description: Users to monitor
                                items:
                                  type: string
                                type: array
                            required:
                              - keys
                            type: object
                          rawRule:
                            description: Raw auditctl format rule (fallback for complex rules)
                            type: string
                          syscall:
                            description: System call monitoring rule
                            properties:
                              action:
                                default: always
                                description: Action to take
                                enum:
                                  - always
                                  - never
                                type: string
                              architecture:
                                description: Architecture filters
                                items:
                                  enum:
                                    - b64
                                    - b32
                                  type: string
                                type: array
                              filters:
                                description: Filters for syscall parameters
                                items:
                                  properties:
                                    field:
                                      description: Field to filter on
                                      enum:
                                        - pid
                                        - ppid
                                        - uid
                                        - gid
                                        - euid
                                        - egid
                                        - auid
                                        - exe
                                        - comm
                                        - key
                                        - exit
                                        - success
                                        - dir
                                        - path
                                        - perm
                                        - arch
                                        - a0
                                        - a1
                                        - a2
                                        - a3
                                        - a4
                                        - a5
                                        - a6
                                        - a7
                                        - a8
                                        - a9
                                        - a10
                                        - a11
                                        - a12
                                        - a13
                                        - a14
                                        - a15
                                      type: string
                                    operator:
                                      description: Comparison operator
                                      enum:
                                        - =
                                        - '!='
                                        - <
                                        - '>'
                                        - <=
                                        - '>='
                                      type: string
                                    value:
                                      description: Value to compare against
                                      type: string
                                  required:
                                    - field
                                    - operator
                                    - value
                                  type: object
                                maxItems: 20
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              list:
                                default: exit
                                description: Audit list type
                                enum:
                                  - task
                                  - exit
                                  - user
                                  - exclude
                                type: string
                              syscalls:
                                description: System calls to monitor
                                items:
                                  type: string
                                minItems: 1
                                type: array
                            required:
                              - syscalls
                            type: object
                        required:
                          - name
                        type: object
                      type: array
                  type: object
                status:
                  properties:
                    appliedRules:
                      description: Number of rules successfully applied to the kernel
                      minimum: 0
                      type: integer
                    conditions:
                      description: Current conditions of the AuditRule
                      items:
                        properties:
                          lastTransitionTime:
                            description: Last time the condition transitioned
                            format: date-time
                            type: string
                          message:
                            description: Human-readable message about the transition
                            type: string
                          reason:
                            description: Reason for the condition's last transition
                            type: string
                          status:
                            description: Status of the condition
                            enum:
                              - "True"
                              - "False"
                              - Unknown
                            type: string
                          type:
                            description: Type of condition
                            enum:
                              - Ready
                              - Progressing
                              - Failed
                            type: string
                        required:
                          - type
                          - status
                          - lastTransitionTime
                        type: object
                      type: array
                    failedRules:
                      description: Rules that failed to apply
                      items:
                        properties:
                          error:
                            description: Error message describing the failure
                            type: string
                          lastAttempt:
                            description: When we last tried to apply this rule
                            format: date-time
                            type: string
                          name:
                            description: Name of the failed rule
                            type: string
                        required:
                          - name
                          - error
                        type: object
                      type: array
                    lastUpdated:
                      description: When the rules were last updated
                      format: date-time
                      type: string
                    observedGeneration:
                      description: Generation of the most recently observed AuditRule
                      type: integer
                  type: object
              type: object
          served: true
          storage: true
          subresources:
            status: {}
  8: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
    rules:
      - apiGroups:
          - ""
        resources:
          - nodes
          - nodes/proxy
          - services
          - endpoints
          - namespaces
          - configmaps
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - pods
        verbs:
          - get
          - watch
          - list
          - delete
      - apiGroups:
          - ""
        resources:
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - deployments
          - daemonsets
          - statefulsets
          - replicasets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - applicationprofiles
          - networkneighborhoods
          - seccompprofiles
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - containerprofiles
          - sbomsyfts
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - runtimerulealertbindings
        verbs:
          - list
          - watch
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands/status
        verbs:
          - get
          - watch
          - list
          - update
          - patch
      - apiGroups:
          - events.k8s.io
        resources:
          - events
        verbs:
          - create
          - patch
          - get
  9: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: node-agent
    subjects:
      - kind: ServiceAccount
        name: node-agent
        namespace: kubescape
  10: |
    apiVersion: v1
    data:
      config.json: |
        {
            "applicationProfileServiceEnabled": true,
            "prometheusExporterEnabled": false,
            "runtimeDetectionEnabled": false,
            "httpDetectionEnabled": false,
            "networkServiceEnabled": false,
            "malwareDetectionEnabled": false,
            "hostMalwareSensorEnabled": false,
            "hostNetworkSensorEnabled": false,
            "nodeProfileServiceEnabled": false,
            "networkStreamingEnabled": false,
            "maxImageSize": 5.36870912e+09,
            "maxSBOMSize": 2.097152e+07,
            "sbomGenerationEnabled": true,
            "enableEmbeddedSBOMs": false,
            "seccompServiceEnabled": false,
            "auditDetectionEnabled": true,
            "auditDetection": {
              "exporters": {"stdoutExporter":true},
              "eventFilter": {
                "includeTypes": [1300,1302,1309,1307,1317,1007,1327,1303,1324,1306,1404,1326]
              }
            },
            "initialDelay": "2m",
            "updateDataPeriod": "10m",
            "nodeProfileInterval": "10m",
            "networkStreamingInterval": "2m",
            "maxSniffingTimePerContainer": "24h",
            "excludeNamespaces": "kubescape,kube-system,kube-public,kube-node-lease,kubeconfig,gmp-system,gmp-public",
            "excludeLabels":null,
            "exporters": {
              "httpExporterConfig":{"maxAlertsPerMinute":1000,"method":"POST","url":"http://synchronizer:8089/apis/v1/kubescape.io"},
              "alertManagerExporterUrls":[],
              "stdoutExporter":true,
              "syslogExporterURL": ""
            },
            "excludeJsonPaths":null,
            "ruleCooldown": {
                "ruleCooldownDuration": "1h",
                "ruleCooldownAfterCount": 1,
                "ruleCooldownOnProfileFailure": true,
                "ruleCooldownMaxSize": 20000
            }
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
  11: |
    apiVersion: apps/v1
    kind: DaemonSet
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      selector:
        matchLabels:
          app.kubernetes.io/component: node-agent
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      template:
        metadata:
          annotations:
            checksum/cloud-config: f5e9bad7925ff652c47ff7f714863e5770f8d0c7e07a210598c6b381e3d25fd3
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/node-agent-config: f5146f8806c1980828b30b516e28f0aec1211df23e0332fcdeeebf11deac00cd
            container.apparmor.security.beta.kubernetes.io/node-agent: unconfined
          labels:
            app: node-agent
            app.kubernetes.io/component: node-agent
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity:
            nodeAffinity:
              requiredDuringSchedulingIgnoredDuringExecution:
                nodeSelectorTerms:
                  - matchExpressions:
                      - key: kubernetes.io/os
                        operator: In
                        values:
                          - linux
          automountServiceAccountToken: true
          containers:
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: HOST_ROOT
                  value: /host
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
                - name: NAMESPACE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: KUBELET_ROOT
                  value: /var/lib/kubelet
                - name: NodeName
              image: quay.io/benarmosec/node-agent:test-v1
              imagePullPolicy: Always
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 7888
                initialDelaySeconds: 60
                periodSeconds: 3
              name: node-agent
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 7888
                initialDelaySeconds: 3
                periodSeconds: 3
              resources:
                limits:
                  cpu: 500m
                  memory: 1400Mi
                requests:
                  cpu: 100m
                  memory: 180Mi
              securityContext:
                capabilities:
                  add:
                    - SYS_ADMIN
                    - SYS_PTRACE
                    - NET_ADMIN
                    - SYSLOG
                    - SYS_RESOURCE
                    - IPC_LOCK
                    - NET_RAW
                    - AUDIT_READ
                    - AUDIT_WRITE
                    - AUDIT_CONTROL
                privileged: false
                runAsUser: 0
                seLinuxOptions:
                  type: spc_t
              volumeMounts:
                - mountPath: /host
                  name: host
                  readOnly: true
                - mountPath: /var/lib/kubelet
                  name: kubeletdir
                - mountPath: /run
                  name: run
                - mountPath: /var
                  name: var
                  readOnly: true
                - mountPath: /lib/modules
                  name: modules
                  readOnly: true
                - mountPath: /sys/kernel/debug
                  name: debugfs
                - mountPath: /sys/fs/cgroup
                  name: cgroup
                  readOnly: true
                - mountPath: /sys/fs/bpf
                  name: bpffs
                - mountPath: /data
                  name: data
                - mountPath: /profiles
                  name: profiles
                - mountPath: /boot
                  name: boot
                  readOnly: true
                - mountPath: /clamav
                  name: clamrun
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
          hostPID: true
          nodeSelector:
            kubernetes.io/os: linux
          priorityClassName: kubescape-critical
          securityContext: null
          serviceAccountName: node-agent
          tolerations: null
          volumes:
            - hostPath:
                path: /
              name: host
            - hostPath:
                path: /var/lib/kubelet
              name: kubeletdir
            - hostPath:
                path: /run
              name: run
            - hostPath:
                path: /var
              name: var
            - hostPath:
                path: /sys/fs/cgroup
              name: cgroup
            - hostPath:
                path: /lib/modules
              name: modules
            - hostPath:
                path: /sys/fs/bpf
              name: bpffs
            - hostPath:
                path: /sys/kernel/debug
              name: debugfs
            - hostPath:
                path: /boot
              name: boot
            - emptyDir: null
              name: data
            - emptyDir: null
              name: profiles
            - emptyDir: {}
              name: clamdb
            - emptyDir: {}
              name: clamrun
            - configMap:
                items:
                  - key: clamd.conf
                    path: clamd.conf
                  - key: freshclam.conf
                    path: freshclam.conf
                name: clamav
              name: etc
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: node-agent
              name: config
  12: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      ports:
        - name: prometheus
          port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
  13: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
  14: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
    rules:
      - apiGroups:
          - ""
        resources:
          - pods
          - nodes
          - namespaces
          - configmaps
          - services
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - secrets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - delete
          - patch
      - apiGroups:
          - apps
        resources:
          - deployments
          - daemonsets
          - statefulsets
          - replicasets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - vulnerabilitymanifests
          - vulnerabilitymanifestsummaries
          - workloadconfigurationscans
          - workloadconfigurationscansummaries
          - openvulnerabilityexchangecontainers
          - containerprofiles
          - sbomsyfts
        verbs:
          - get
          - watch
          - list
          - delete
      - apiGroups:
          - kubescape.io
        resources:
          - runtimerulealertbindings
        verbs:
          - list
          - watch
          - get
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - delete
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands/status
        verbs:
          - get
          - watch
          - list
          - update
          - patch
  15: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: operator
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  16: |
    apiVersion: v1
    data:
      config.json: |
        {
          "excludeNamespaces": "kubescape,kube-system,kube-public,kube-node-lease,kubeconfig,gmp-system,gmp-public",
          "namespace": "kubescape",
          "triggersecurityframework": true,
          "podScanGuardTime": "1h",
          "excludeJsonPaths":null,
          "httpExporterConfig":{"maxAlertsPerMinute":1000,"method":"POST","url":"http://synchronizer:8089/apis/v1/kubescape.io"}
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: operator
      namespace: kubescape
  17: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: operator
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          annotations:
            checksum/capabilities-config: ddfa52d63f7b5a08f7ac43d138e24b9d9f89afdb2e24cede0111c12f765da2ae
            checksum/cloud-config: f5e9bad7925ff652c47ff7f714863e5770f8d0c7e07a210598c6b381e3d25fd3
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/matching-rules-config: c81857b415602f6b161db3199a16461c5acd8ba44ec7572189441f4f294a3614
            checksum/operator-config: da09bdb4e250d772ca02bb727ed10e0d0ad2f8e878bf136339036a2eee71161d
          labels:
            app: operator
            app.kubernetes.io/component: operator
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - env:
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: HELM_RELEASE
                  value: kubescape-operator-1.29.9
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
              image: quay.io/kubescape/operator:v0.2.109
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /v1/liveness
                  port: readiness-port
                initialDelaySeconds: 3
                periodSeconds: 3
              name: operator
              ports:
                - containerPort: 4002
                  name: trigger-port
                  protocol: TCP
                - containerPort: 8000
                  name: readiness-port
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /v1/readiness
                  port: readiness-port
                initialDelaySeconds: 10
                periodSeconds: 5
              resources:
                limits:
                  cpu: 300m
                  memory: 300Mi
                requests:
                  cpu: 50m
                  memory: 100Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /tmp
                  name: tmp-dir
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/capabilities.json
                  name: ks-capabilities
                  readOnly: true
                  subPath: capabilities.json
                - mountPath: /etc/config/matchingRules.json
                  name: cs-matching-rules
                  readOnly: true
                  subPath: matchingRules.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: operator
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - emptyDir: {}
              name: tmp-dir
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: capabilities
                    path: capabilities.json
                name: ks-capabilities
              name: ks-capabilities
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: operator
              name: config
            - configMap:
                items:
                  - key: matchingRules.json
                    path: matchingRules.json
                name: cs-matching-rules
              name: cs-matching-rules
  18: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: kubescape-scheduler
          namespace: kubescape
          labels:
            app: kubescape-scheduler
            tier: ks-control-plane
            kubescape.io/tier: "core"
            armo.tier: "kubescape-scan"
        spec:
          schedule: "1 2 3 4 5"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "kubescape-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  containers:
                  - name: kubescape-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubescape
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: kubescape-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-cronjob-template
      namespace: kubescape
  19: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: kubevuln-scheduler
          namespace: kubescape
          labels:
            app: kubevuln-scheduler
            tier: ks-control-plane
            kubescape.io/tier: "core"
            armo.tier: "vuln-scan"
        spec:
          schedule: "1 2 3 4 5"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "vuln-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  containers:
                  - name: kubevuln-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubevuln
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: kubevuln-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-cronjob-template
      namespace: kubescape
  20: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: registry-scheduler
          namespace: kubescape
          labels:
            app: registry-scheduler
            kubescape.io/tier: "core"
            tier: ks-control-plane
            armo.tier: "registry-scan"
        spec:
          schedule: "0 0 * * *"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "registry-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  containers:
                  - name: registry-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubevuln
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: registry-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: registry-scan-cronjob-template
      namespace: kubescape
  21: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - configmaps
          - secrets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
      - apiGroups:
          - batch
        resources:
          - cronjobs
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  22: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: operator
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  23: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      ports:
        - port: 4002
          protocol: TCP
          targetPort: 4002
      selector:
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  24: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
  25: |
    apiVersion: apiregistration.k8s.io/v1
    kind: APIService
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: v1beta1.spdx.softwarecomposition.kubescape.io
    spec:
      caBundle: bW9jay1jYS1jZXJ0
      group: spdx.softwarecomposition.kubescape.io
      groupPriorityMinimum: 1000
      service:
        name: storage
        namespace: kubescape
      version: v1beta1
      versionPriority: 15
  26: |
    apiVersion: v1
    data:
      ca.crt: bW9jay1jYS1jZXJ0
      tls.crt: bW9jay1jZXJ0LWNlcnQ=
      tls.key: bW9jay1jZXJ0LWtleQ==
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage-ca
      namespace: kubescape
    type: kubernetes.io/tls
  27: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
    rules:
      - apiGroups:
          - ""
        resources:
          - namespaces
          - pods
          - services
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - admissionregistration.k8s.io
        resources:
          - mutatingwebhookconfigurations
          - validatingwebhookconfigurations
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - daemonsets
          - deployments
          - replicasets
          - statefulsets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - cronjobs
          - jobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - flowcontrol.apiserver.k8s.io
        resources:
          - prioritylevelconfigurations
          - flowschemas
        verbs:
          - get
          - watch
          - list
  28: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage:system:auth-delegator
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:auth-delegator
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  29: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: storage
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  30: |
    apiVersion: v1
    data:
      config.json: |
        {
          "cleanupInterval": "6h",
          "disableVirtualCRDs": true,
          "excludeJsonPaths": null,
          "defaultQueueLength": 100,
          "defaultWorkerCount": 2,
          "defaultMaxObjectSize": 400000,
          "queueManagerEnabled": true,
          "kindQueues": {"applicationprofiles":{"maxObjectSize":20000000,"queueLength":50,"workerCount":2},"containerprofiles":{"maxObjectSize":2500000,"queueLength":50,"workerCount":2},"networkneighborhoods":{"maxObjectSize":10000000,"queueLength":50,"workerCount":2},"openvulnerabilityexchangecontainers":{"maxObjectSize":500000,"queueLength":50,"workerCount":1},"sbomsyftfiltereds":{"maxObjectSize":50000000,"queueLength":50,"workerCount":1},"sbomsyfts":{"maxObjectSize":100000000,"queueLength":50,"workerCount":1},"vulnerabilitymanifests":{"maxObjectSize":50000000,"queueLength":50,"workerCount":1}},
          "tlsClientCaFile": "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt",
          "tlsServerCertFile": "/etc/storage-ca-certificates/tls.crt",
          "tlsServerKeyFile": "/etc/storage-ca-certificates/tls.key",
          "serverBindPort": "8443"
        }
    kind: ConfigMap
    metadata:
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: storage
      namespace: kubescape
  31: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: storage
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations: null
          labels:
            app: storage
            app.kubernetes.io/component: storage
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          containers:
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
              image: quay.io/kubescape/storage:v0.0.220
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 8443
                  scheme: HTTPS
              name: apiserver
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 8443
                  scheme: HTTPS
              resources:
                limits:
                  cpu: 1500m
                  memory: 1500Mi
                requests:
                  cpu: 100m
                  memory: 400Mi
              securityContext:
                allowPrivilegeEscalation: false
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: data
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/storage-ca-certificates
                  name: ca-certificates
                  readOnly: true
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: storage
          tolerations: null
          volumes:
            - name: data
              persistentVolumeClaim:
                claimName: kubescape-storage
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: storage
              name: config
            - name: ca-certificates
              secret:
                secretName: storage-ca
  32: |
    apiVersion: v1
    kind: PersistentVolumeClaim
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-storage
      namespace: kubescape
    spec:
      accessModes:
        - ReadWriteOnce
      resources:
        requests:
          storage: 5Gi
  33: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage-auth-reader
      namespace: kube-system
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: extension-apiserver-authentication-reader
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  34: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      ports:
        - name: https
          port: 443
          protocol: TCP
          targetPort: 8443
      selector:
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
  35: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
  36: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
    rules:
      - apiGroups:
          - storage.k8s.io
        resources:
          - storageclasses
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - rbac.authorization.k8s.io
        resources:
          - rolebindings
          - clusterrolebindings
          - roles
          - clusterroles
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - ""
        resources:
          - pods
          - namespaces
          - nodes
          - configmaps
          - persistentvolumes
          - services
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - apps
        resources:
          - deployments
          - statefulsets
          - daemonsets
          - replicasets
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - networking.k8s.io
        resources:
          - networkpolicies
          - ingresses
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - applicationprofiles
          - networkneighborhoods
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - patch
          - delete
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - knownservers
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - patch
          - delete
      - apiGroups:
          - cilium.io
        resources:
          - ciliumnetworkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - projectcalico.org
        resources:
          - networkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - networking.istio.io
        resources:
          - gateways
          - virtualservices
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - security.istio.io
        resources:
          - authorizationpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - gateway.networking.k8s.io
        resources:
          - httproutes
          - tcproutes
          - udproutes
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - patch
          - delete
  37: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: synchronizer
    subjects:
      - kind: ServiceAccount
        name: synchronizer
        namespace: kubescape
  38: |
    apiVersion: v1
    data:
      config.json: |
        {
          "inCluster": {
            "excludeNamespaces": "kubescape,kube-system,kube-public,kube-node-lease,kubeconfig,gmp-system,gmp-public",
            "resources": [
              {
                "group": "",
                "version": "v1",
                "resource": "services",
                "strategy": "patch"
              },
              {
                "group": "networking.k8s.io",
                "version": "v1",
                "resource": "ingresses",
                "strategy": "patch"
              },
              {
                "group": "gateway.networking.k8s.io",
                "version": "v1",
                "resource": "httproutes",
                "strategy": "patch"
              },
              {
                "group": "gateway.networking.k8s.io",
                "version": "v1",
                "resource": "tcproutes",
                "strategy": "patch"
              },
              {
                "group": "gateway.networking.k8s.io",
                "version": "v1",
                "resource": "udproutes",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "rolebindings",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "clusterrolebindings",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "clusterroles",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "roles",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "persistentvolumes",
                "strategy": "patch"
              },
              {
                "group": "storage.k8s.io",
                "version": "v1",
                "resource": "storageclasses",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "deployments",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "statefulsets",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "daemonsets",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "replicasets",
                "strategy": "patch"
              },
              {
                "group": "batch",
                "version": "v1",
                "resource": "jobs",
                "strategy": "patch"
              },
              {
                "group": "batch",
                "version": "v1",
                "resource": "cronjobs",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "pods",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "namespaces",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "nodes",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "configmaps",
                "strategy": "patch"
              },
              {
                "group": "networking.k8s.io",
                "version": "v1",
                "resource": "networkpolicies",
                "strategy": "patch"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "applicationprofiles",
                "strategy": "copy"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "knownservers",
                "strategy": "copy"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "networkneighborhoods",
                "strategy": "copy"
              },
              {
                "group": "cilium.io",
                "version": "v2",
                "resource": "ciliumnetworkpolicies",
                "strategy": "patch"
              },
              {
                "group": "projectcalico.org",
                "version": "v3",
                "resource": "networkpolicies",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1",
                "resource": "gateways",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1",
                "resource": "virtualservices",
                "strategy": "patch"
              },
              {
                "group": "security.istio.io",
                "version": "v1",
                "resource": "authorizationpolicies",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1beta1",
                "resource": "gateways",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1beta1",
                "resource": "virtualservices",
                "strategy": "patch"
              },
              {
                "group": "security.istio.io",
                "version": "v1beta1",
                "resource": "authorizationpolicies",
                "strategy": "patch"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "servicesscanresults",
                "strategy": "patch"
              },
              {
                "group": "kubescape.io",
                "version": "v1alpha1",
                "resource": "operatorcommands",
                "strategy": "copy"
              }
            ]
          },
          "httpEndpoint": {
            "serverPort": "8089",
            "resources": [
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "networkstreams",
                "strategy": "copy"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "nodeprofiles",
                "strategy": "copy"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "runtimealerts",
                "strategy": "copy"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "registrystatuses",
                "strategy": "copy"
              }
            ]
          }
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
  39: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: synchronizer
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations:
            checksum/cloud-config: f5e9bad7925ff652c47ff7f714863e5770f8d0c7e07a210598c6b381e3d25fd3
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/synchronizer-configmap: d04a30312a4acce7a0a696f17f8bb210b0f5cccb8b7135df604e79a4d2b7d7d3
          labels:
            app: synchronizer
            app.kubernetes.io/component: synchronizer
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - command:
                - /usr/bin/client
              env:
                - name: HELM_RELEASE
                  value: kubescape-operator-1.29.9
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
              image: quay.io/kubescape/synchronizer:v0.0.116
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /healthz
                  port: 7888
                initialDelaySeconds: 10
                periodSeconds: 30
                timeoutSeconds: 10
              name: synchronizer
              resources:
                limits:
                  cpu: 200m
                  memory: 500Mi
                requests:
                  cpu: 100m
                  memory: 250Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/services.json
                  name: services
                  readOnly: true
                  subPath: services.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
          initContainers:
            - args:
                - -method=get
                - -scheme=https
                - -host=api.armosec.io
                - -path=api/v2/servicediscovery
                - -path-output=/data/services.json
              env: null
              image: quay.io/kubescape/http-request:v0.2.14
              imagePullPolicy: IfNotPresent
              name: url-discovery
              resources:
                limits:
                  cpu: 100m
                  memory: 50Mi
                requests:
                  cpu: 10m
                  memory: 10Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: services
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: synchronizer
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - emptyDir: {}
              name: services
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: synchronizer
              name: config
  40: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - configmaps
          - secrets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
      - apiGroups:
          - batch
        resources:
          - cronjobs
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  41: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: synchronizer
    subjects:
      - kind: ServiceAccount
        name: synchronizer
        namespace: kubescape
  42: |
    apiVersion: v1
    kind: Service
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    spec:
      ports:
        - port: 8089
          protocol: TCP
          targetPort: 8089
      selector:
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  43: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
minimal capabilities:
  1: |+
    raw: |+
      Thank you for installing kubescape-operator version 1.29.9.







  2: |
    apiVersion: v1
    data:
      accessKey: ""
      account: ""
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: cloud-secret
        app.kubernetes.io/component: cloud-secret
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/infra: credentials
        tier: ks-control-plane
      name: cloud-secret
      namespace: kubescape
    type: Opaque
  3: |
    apiVersion: v1
    data:
      clusterData: |
        {
          "serviceDiscovery": false,
          "vulnScanURL": "kubevuln:8080",
          "kubevulnURL": "kubevuln:8080",
          "kubescapeURL": "kubescape:8080",
          "clusterName": "kind-kind",
          "storage": true,
          "relevantImageVulnerabilitiesEnabled": false,
          "namespace": "kubescape",
          "imageVulnerabilitiesScanningEnabled": false,
          "postureScanEnabled": false,
          "otelCollector": false,
          "nodeAgent": "true",
          "maxImageSize": 5.36870912e+09,
          "maxSBOMSize": 2.097152e+07,
          "keepLocal": true,
          "scanTimeout": "5m",
          "scanEmbeddedSBOMs": false,
          "vexGeneration": false,
          "useDefaultMatchers": false,
          "storeFilteredSbom": false,
          "continuousPostureScan": false,
          "relevantImageVulnerabilitiesConfiguration": "disable"
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/infra: config
        kubescape.io/tier: core
        tier: ks-control-plane
      name: ks-cloud-config
      namespace: kubescape
  4: |
    apiVersion: v1
    data:
      capabilities: |
        {
          "capabilities":{"admissionController":"disable","autoUpgrading":"disable","configurationScan":"disable","httpDetection":"disable","kubescapeOffline":"disable","linuxAudit":"enable","malwareDetection":"disable","manageWorkloads":"disable","networkEventsStreaming":"disable","networkPolicyService":"disable","nodeProfileService":"disable","nodeSbomGeneration":"enable","nodeScan":"disable","prometheusExporter":"disable","relevancy":"disable","runtimeDetection":"disable","runtimeObservability":"enable","scanEmbeddedSBOMs":"disable","seccompProfileService":"disable","syncSBOM":"disable","testing":{"nodeAgentMultiplication":{"enabled":false,"replicas":5}},"vexGeneration":"disable","vulnerabilityScan":"disable"},
          "components":{"autoUpdater":{"enabled":false},"clamAV":{"enabled":false},"cloudSecret":{"create":true,"name":"cloud-secret"},"customCaCertificates":{"name":"custom-ca-certificates"},"hostScanner":{"enabled":false},"kubescape":{"enabled":false},"kubescapeScheduler":{"enabled":false},"kubevuln":{"enabled":false},"kubevulnScheduler":{"enabled":false},"nodeAgent":{"enabled":true},"operator":{"enabled":true},"otelCollector":{"enabled":false},"prometheusExporter":{"enabled":false},"serviceDiscovery":{"enabled":false},"storage":{"enabled":true},"synchronizer":{"enabled":false}},
          "configurations":{"excludeJsonPaths":null,"otelUrl":"otelCollector.svc.monitoring:4317","persistence":"enable","priorityClass":{"daemonset":100000100,"enabled":true},"prometheusAnnotations":"disable"} ,
          "serviceScanConfig" :{"enabled":false,"interval":"1h"}
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-capabilities
        app.kubernetes.io/component: ks-capabilities
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: ks-capabilities
      namespace: kubescape
  5: |
    apiVersion: v1
    data:
      matchingRules.json: |
        {"match":[{"apiGroups":["apps"],"apiVersions":["v1"],"resources":["deployments"]}],"namespaces":["default"]}
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: cs-matching-rules
      namespace: kubescape
  6: |
    apiVersion: scheduling.k8s.io/v1
    description: This priority class is for node-agent daemonset pods
    globalDefault: false
    kind: PriorityClass
    metadata:
      annotations: null
      labels:
        app: kubescape-critical
        app.kubernetes.io/component: kubescape-critical
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-critical
    value: 1.000001e+08
  7: |
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      labels:
        app: linux-audit-rules
        app.kubernetes.io/component: linux-audit-rules
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: linuxauditrules.kubescape.io
    spec:
      group: kubescape.io
      names:
        kind: LinuxAuditRule
        plural: linuxauditrules
        shortNames:
          - lar
          - linuxauditrule
          - auditrule
        singular: linuxauditrule
      scope: Namespaced
      versions:
        - additionalPrinterColumns:
            - description: Whether the Linux audit rules are enabled
              jsonPath: .spec.enabled
              name: Enabled
              type: boolean
            - description: Number of Linux audit rules defined
              jsonPath: .status.appliedRules
              name: Rules
              type: integer
            - description: Status of the Linux audit rules
              jsonPath: .status.conditions[?(@.type=="Ready")].status
              name: Status
              type: string
            - jsonPath: .metadata.creationTimestamp
              name: Age
              type: date
          name: v1
          schema:
            openAPIV3Schema:
              properties:
                spec:
                  properties:
                    enabled:
                      default: true
                      description: Controls whether these rules should be active
                      type: boolean
                    nodeSelector:
                      additionalProperties:
                        type: string
                      description: Node selector to target specific nodes
                      type: object
                    rateLimit:
                      description: Rate limiting configuration
                      properties:
                        burstSize:
                          description: Burst size for rate limiting
                          minimum: 1
                          type: integer
                        eventsPerSecond:
                          description: Maximum events per second
                          minimum: 1
                          type: integer
                      type: object
                    rules:
                      description: List of audit rule definitions
                      items:
                        properties:
                          description:
                            description: Human-readable description of what this rule monitors
                            type: string
                          enabled:
                            default: true
                            description: Controls whether this specific rule is active
                            type: boolean
                          fileWatch:
                            description: File system monitoring rule
                            properties:
                              exclude:
                                description: Exclude patterns (basic glob patterns)
                                items:
                                  type: string
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              paths:
                                description: Paths to monitor
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              permissions:
                                description: Permissions to monitor
                                items:
                                  enum:
                                    - read
                                    - write
                                    - attr
                                    - attribute
                                    - execute
                                  type: string
                                minItems: 1
                                type: array
                              recursive:
                                default: false
                                description: Recursive monitoring (future use)
                                type: boolean
                            required:
                              - paths
                              - permissions
                              - keys
                            type: object
                          name:
                            description: Unique name of this rule within the CRD
                            type: string
                          network:
                            description: Network monitoring rule (future extension)
                            properties:
                              addresses:
                                description: Addresses to monitor
                                items:
                                  type: string
                                type: array
                              direction:
                                description: Traffic direction
                                enum:
                                  - inbound
                                  - outbound
                                  - both
                                type: string
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              ports:
                                description: Ports to monitor
                                items:
                                  maximum: 65535
                                  minimum: 1
                                  type: integer
                                type: array
                              protocols:
                                description: Protocols to monitor
                                items:
                                  enum:
                                    - tcp
                                    - udp
                                    - icmp
                                  type: string
                                type: array
                            required:
                              - keys
                            type: object
                          priority:
                            default: 100
                            description: Priority for rule ordering (lower = higher priority)
                            maximum: 1000
                            minimum: 1
                            type: integer
                          process:
                            description: Process monitoring rule
                            properties:
                              arguments:
                                description: Command line argument patterns
                                items:
                                  type: string
                                type: array
                              executables:
                                description: Executables to monitor (path patterns)
                                items:
                                  type: string
                                type: array
                              filters:
                                description: Additional filters
                                items:
                                  properties:
                                    field:
                                      description: Field to filter on
                                      type: string
                                    operator:
                                      description: Comparison operator
                                      enum:
                                        - =
                                        - '!='
                                        - <
                                        - '>'
                                        - <=
                                        - '>='
                                      type: string
                                    value:
                                      description: Value to compare against
                                      type: string
                                  required:
                                    - field
                                    - operator
                                    - value
                                  type: object
                                type: array
                              groups:
                                description: Groups to monitor
                                items:
                                  type: string
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              users:
                                description: Users to monitor
                                items:
                                  type: string
                                type: array
                            required:
                              - keys
                            type: object
                          rawRule:
                            description: Raw auditctl format rule (fallback for complex rules)
                            type: string
                          syscall:
                            description: System call monitoring rule
                            properties:
                              action:
                                default: always
                                description: Action to take
                                enum:
                                  - always
                                  - never
                                type: string
                              architecture:
                                description: Architecture filters
                                items:
                                  enum:
                                    - b64
                                    - b32
                                  type: string
                                type: array
                              filters:
                                description: Filters for syscall parameters
                                items:
                                  properties:
                                    field:
                                      description: Field to filter on
                                      enum:
                                        - pid
                                        - ppid
                                        - uid
                                        - gid
                                        - euid
                                        - egid
                                        - auid
                                        - exe
                                        - comm
                                        - key
                                        - exit
                                        - success
                                        - dir
                                        - path
                                        - perm
                                        - arch
                                        - a0
                                        - a1
                                        - a2
                                        - a3
                                        - a4
                                        - a5
                                        - a6
                                        - a7
                                        - a8
                                        - a9
                                        - a10
                                        - a11
                                        - a12
                                        - a13
                                        - a14
                                        - a15
                                      type: string
                                    operator:
                                      description: Comparison operator
                                      enum:
                                        - =
                                        - '!='
                                        - <
                                        - '>'
                                        - <=
                                        - '>='
                                      type: string
                                    value:
                                      description: Value to compare against
                                      type: string
                                  required:
                                    - field
                                    - operator
                                    - value
                                  type: object
                                maxItems: 20
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              list:
                                default: exit
                                description: Audit list type
                                enum:
                                  - task
                                  - exit
                                  - user
                                  - exclude
                                type: string
                              syscalls:
                                description: System calls to monitor
                                items:
                                  type: string
                                minItems: 1
                                type: array
                            required:
                              - syscalls
                            type: object
                        required:
                          - name
                        type: object
                      type: array
                  type: object
                status:
                  properties:
                    appliedRules:
                      description: Number of rules successfully applied to the kernel
                      minimum: 0
                      type: integer
                    conditions:
                      description: Current conditions of the AuditRule
                      items:
                        properties:
                          lastTransitionTime:
                            description: Last time the condition transitioned
                            format: date-time
                            type: string
                          message:
                            description: Human-readable message about the transition
                            type: string
                          reason:
                            description: Reason for the condition's last transition
                            type: string
                          status:
                            description: Status of the condition
                            enum:
                              - "True"
                              - "False"
                              - Unknown
                            type: string
                          type:
                            description: Type of condition
                            enum:
                              - Ready
                              - Progressing
                              - Failed
                            type: string
                        required:
                          - type
                          - status
                          - lastTransitionTime
                        type: object
                      type: array
                    failedRules:
                      description: Rules that failed to apply
                      items:
                        properties:
                          error:
                            description: Error message describing the failure
                            type: string
                          lastAttempt:
                            description: When we last tried to apply this rule
                            format: date-time
                            type: string
                          name:
                            description: Name of the failed rule
                            type: string
                        required:
                          - name
                          - error
                        type: object
                      type: array
                    lastUpdated:
                      description: When the rules were last updated
                      format: date-time
                      type: string
                    observedGeneration:
                      description: Generation of the most recently observed AuditRule
                      type: integer
                  type: object
              type: object
          served: true
          storage: true
          subresources:
            status: {}
  8: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
    rules:
      - apiGroups:
          - ""
        resources:
          - nodes
          - nodes/proxy
          - services
          - endpoints
          - namespaces
          - configmaps
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - pods
        verbs:
          - get
          - watch
          - list
          - delete
      - apiGroups:
          - ""
        resources:
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - deployments
          - daemonsets
          - statefulsets
          - replicasets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - applicationprofiles
          - networkneighborhoods
          - seccompprofiles
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - containerprofiles
          - sbomsyfts
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - runtimerulealertbindings
        verbs:
          - list
          - watch
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands/status
        verbs:
          - get
          - watch
          - list
          - update
          - patch
      - apiGroups:
          - events.k8s.io
        resources:
          - events
        verbs:
          - create
          - patch
          - get
  9: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: node-agent
    subjects:
      - kind: ServiceAccount
        name: node-agent
        namespace: kubescape
  10: |
    apiVersion: v1
    data:
      config.json: |
        {
            "applicationProfileServiceEnabled": true,
            "prometheusExporterEnabled": false,
            "runtimeDetectionEnabled": false,
            "httpDetectionEnabled": false,
            "networkServiceEnabled": false,
            "malwareDetectionEnabled": false,
            "hostMalwareSensorEnabled": false,
            "hostNetworkSensorEnabled": false,
            "nodeProfileServiceEnabled": false,
            "networkStreamingEnabled": false,
            "maxImageSize": 5.36870912e+09,
            "maxSBOMSize": 2.097152e+07,
            "sbomGenerationEnabled": true,
            "enableEmbeddedSBOMs": false,
            "seccompServiceEnabled": false,
            "auditDetectionEnabled": true,
            "auditDetection": {
              "exporters": {"stdoutExporter":true},
              "eventFilter": {
                "includeTypes": [1300,1302,1309,1307,1317,1007,1327,1303,1324,1306,1404,1326]
              }
            },
            "initialDelay": "2m",
            "updateDataPeriod": "10m",
            "nodeProfileInterval": "10m",
            "networkStreamingInterval": "2m",
            "maxSniffingTimePerContainer": "24h",
            "excludeLabels":null,
            "exporters": {
              "alertManagerExporterUrls":[],
              "stdoutExporter":true,
              "syslogExporterURL": ""
            },
            "excludeJsonPaths":null,
            "ruleCooldown": {
                "ruleCooldownDuration": "1h",
                "ruleCooldownAfterCount": 1,
                "ruleCooldownOnProfileFailure": true,
                "ruleCooldownMaxSize": 20000
            }
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
  11: |
    apiVersion: apps/v1
    kind: DaemonSet
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      selector:
        matchLabels:
          app.kubernetes.io/component: node-agent
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      template:
        metadata:
          annotations:
            checksum/cloud-config: 329816806f634b49512f5cd20ebaf77384e75ad0915cfd4e1299eb0418a4dd01
            checksum/cloud-secret: 3248919273cee6d6f750f97ea378fc79fff1f03b131f21d584a00258bf475a80
            checksum/node-agent-config: ade9c9b15bb1bc9cf9616ac25f447434cdc393229f26e76907f49618603a8fe7
            container.apparmor.security.beta.kubernetes.io/node-agent: unconfined
          labels:
            app: node-agent
            app.kubernetes.io/component: node-agent
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity:
            nodeAffinity:
              requiredDuringSchedulingIgnoredDuringExecution:
                nodeSelectorTerms:
                  - matchExpressions:
                      - key: kubernetes.io/os
                        operator: In
                        values:
                          - linux
          automountServiceAccountToken: true
          containers:
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: HOST_ROOT
                  value: /host
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
                - name: NAMESPACE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: KUBELET_ROOT
                  value: /var/lib/kubelet
                - name: NodeName
              image: quay.io/benarmosec/node-agent:test-v1
              imagePullPolicy: Always
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 7888
                initialDelaySeconds: 60
                periodSeconds: 3
              name: node-agent
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 7888
                initialDelaySeconds: 3
                periodSeconds: 3
              resources:
                limits:
                  cpu: 500m
                  memory: 1400Mi
                requests:
                  cpu: 100m
                  memory: 180Mi
              securityContext:
                capabilities:
                  add:
                    - SYS_ADMIN
                    - SYS_PTRACE
                    - NET_ADMIN
                    - SYSLOG
                    - SYS_RESOURCE
                    - IPC_LOCK
                    - NET_RAW
                    - AUDIT_READ
                    - AUDIT_WRITE
                    - AUDIT_CONTROL
                privileged: false
                runAsUser: 0
                seLinuxOptions:
                  type: spc_t
              volumeMounts:
                - mountPath: /host
                  name: host
                  readOnly: true
                - mountPath: /var/lib/kubelet
                  name: kubeletdir
                - mountPath: /run
                  name: run
                - mountPath: /var
                  name: var
                  readOnly: true
                - mountPath: /lib/modules
                  name: modules
                  readOnly: true
                - mountPath: /sys/kernel/debug
                  name: debugfs
                - mountPath: /sys/fs/cgroup
                  name: cgroup
                  readOnly: true
                - mountPath: /sys/fs/bpf
                  name: bpffs
                - mountPath: /data
                  name: data
                - mountPath: /profiles
                  name: profiles
                - mountPath: /boot
                  name: boot
                  readOnly: true
                - mountPath: /clamav
                  name: clamrun
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
          hostPID: true
          nodeSelector:
            kubernetes.io/os: linux
          priorityClassName: kubescape-critical
          securityContext: null
          serviceAccountName: node-agent
          tolerations: null
          volumes:
            - hostPath:
                path: /
              name: host
            - hostPath:
                path: /var/lib/kubelet
              name: kubeletdir
            - hostPath:
                path: /run
              name: run
            - hostPath:
                path: /var
              name: var
            - hostPath:
                path: /sys/fs/cgroup
              name: cgroup
            - hostPath:
                path: /lib/modules
              name: modules
            - hostPath:
                path: /sys/fs/bpf
              name: bpffs
            - hostPath:
                path: /sys/kernel/debug
              name: debugfs
            - hostPath:
                path: /boot
              name: boot
            - emptyDir: null
              name: data
            - emptyDir: null
              name: profiles
            - emptyDir: {}
              name: clamdb
            - emptyDir: {}
              name: clamrun
            - configMap:
                items:
                  - key: clamd.conf
                    path: clamd.conf
                  - key: freshclam.conf
                    path: freshclam.conf
                name: clamav
              name: etc
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: node-agent
              name: config
  12: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      ports:
        - name: prometheus
          port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
  13: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
  14: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
    rules:
      - apiGroups:
          - ""
        resources:
          - pods
          - nodes
          - namespaces
          - configmaps
          - services
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - secrets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - delete
          - patch
      - apiGroups:
          - apps
        resources:
          - deployments
          - daemonsets
          - statefulsets
          - replicasets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - vulnerabilitymanifests
          - vulnerabilitymanifestsummaries
          - workloadconfigurationscans
          - workloadconfigurationscansummaries
          - openvulnerabilityexchangecontainers
          - containerprofiles
          - sbomsyfts
        verbs:
          - get
          - watch
          - list
          - delete
      - apiGroups:
          - kubescape.io
        resources:
          - runtimerulealertbindings
        verbs:
          - list
          - watch
          - get
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - delete
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands/status
        verbs:
          - get
          - watch
          - list
          - update
          - patch
  15: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: operator
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  16: |
    apiVersion: v1
    data:
      config.json: |
        {
          "namespace": "kubescape",
          "triggersecurityframework": true,
          "podScanGuardTime": "1h",
          "excludeJsonPaths":null,
          "httpExporterConfig":{"maxAlertsPerMinute":1000,"method":"POST","url":"http://synchronizer:8089/apis/v1/kubescape.io"}
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: operator
      namespace: kubescape
  17: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: operator
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          annotations:
            checksum/capabilities-config: 02da33369353b20280b9385fe9818727270f165a9fda18947b17fe534032b7fc
            checksum/cloud-config: 329816806f634b49512f5cd20ebaf77384e75ad0915cfd4e1299eb0418a4dd01
            checksum/cloud-secret: 3248919273cee6d6f750f97ea378fc79fff1f03b131f21d584a00258bf475a80
            checksum/matching-rules-config: c81857b415602f6b161db3199a16461c5acd8ba44ec7572189441f4f294a3614
            checksum/operator-config: 08ced45878e9285cb2674068a35606be7f0ba80d4ba45d4cbc13544c5223b226
          labels:
            app: operator
            app.kubernetes.io/component: operator
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - env:
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: HELM_RELEASE
                  value: kubescape-operator-1.29.9
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
              image: quay.io/kubescape/operator:v0.2.109
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /v1/liveness
                  port: readiness-port
                initialDelaySeconds: 3
                periodSeconds: 3
              name: operator
              ports:
                - containerPort: 4002
                  name: trigger-port
                  protocol: TCP
                - containerPort: 8000
                  name: readiness-port
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /v1/readiness
                  port: readiness-port
                initialDelaySeconds: 10
                periodSeconds: 5
              resources:
                limits:
                  cpu: 300m
                  memory: 300Mi
                requests:
                  cpu: 50m
                  memory: 100Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /tmp
                  name: tmp-dir
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/capabilities.json
                  name: ks-capabilities
                  readOnly: true
                  subPath: capabilities.json
                - mountPath: /etc/config/matchingRules.json
                  name: cs-matching-rules
                  readOnly: true
                  subPath: matchingRules.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: operator
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - emptyDir: {}
              name: tmp-dir
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: capabilities
                    path: capabilities.json
                name: ks-capabilities
              name: ks-capabilities
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: operator
              name: config
            - configMap:
                items:
                  - key: matchingRules.json
                    path: matchingRules.json
                name: cs-matching-rules
              name: cs-matching-rules
  18: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: kubescape-scheduler
          namespace: kubescape
          labels:
            app: kubescape-scheduler
            tier: ks-control-plane
            kubescape.io/tier: "core"
            armo.tier: "kubescape-scan"
        spec:
          schedule: "1 2 3 4 5"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "kubescape-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  containers:
                  - name: kubescape-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubescape
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: kubescape-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-cronjob-template
      namespace: kubescape
  19: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: kubevuln-scheduler
          namespace: kubescape
          labels:
            app: kubevuln-scheduler
            tier: ks-control-plane
            kubescape.io/tier: "core"
            armo.tier: "vuln-scan"
        spec:
          schedule: "1 2 3 4 5"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "vuln-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  containers:
                  - name: kubevuln-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubevuln
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: kubevuln-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-cronjob-template
      namespace: kubescape
  20: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: registry-scheduler
          namespace: kubescape
          labels:
            app: registry-scheduler
            kubescape.io/tier: "core"
            tier: ks-control-plane
            armo.tier: "registry-scan"
        spec:
          schedule: "0 0 * * *"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "registry-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  containers:
                  - name: registry-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubevuln
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: registry-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: registry-scan-cronjob-template
      namespace: kubescape
  21: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - configmaps
          - secrets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
      - apiGroups:
          - batch
        resources:
          - cronjobs
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  22: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: operator
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  23: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      ports:
        - port: 4002
          protocol: TCP
          targetPort: 4002
      selector:
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  24: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
  25: |
    apiVersion: apiregistration.k8s.io/v1
    kind: APIService
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: v1beta1.spdx.softwarecomposition.kubescape.io
    spec:
      caBundle: bW9jay1jYS1jZXJ0
      group: spdx.softwarecomposition.kubescape.io
      groupPriorityMinimum: 1000
      service:
        name: storage
        namespace: kubescape
      version: v1beta1
      versionPriority: 15
  26: |
    apiVersion: v1
    data:
      ca.crt: bW9jay1jYS1jZXJ0
      tls.crt: bW9jay1jZXJ0LWNlcnQ=
      tls.key: bW9jay1jZXJ0LWtleQ==
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage-ca
      namespace: kubescape
    type: kubernetes.io/tls
  27: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
    rules:
      - apiGroups:
          - ""
        resources:
          - namespaces
          - pods
          - services
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - admissionregistration.k8s.io
        resources:
          - mutatingwebhookconfigurations
          - validatingwebhookconfigurations
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - daemonsets
          - deployments
          - replicasets
          - statefulsets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - cronjobs
          - jobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - flowcontrol.apiserver.k8s.io
        resources:
          - prioritylevelconfigurations
          - flowschemas
        verbs:
          - get
          - watch
          - list
  28: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage:system:auth-delegator
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:auth-delegator
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  29: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: storage
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  30: |
    apiVersion: v1
    data:
      config.json: |
        {
          "cleanupInterval": "6h",
          "disableVirtualCRDs": false,
          "excludeJsonPaths": null,
          "defaultQueueLength": 100,
          "defaultWorkerCount": 2,
          "defaultMaxObjectSize": 400000,
          "queueManagerEnabled": true,
          "kindQueues": {"applicationprofiles":{"maxObjectSize":20000000,"queueLength":50,"workerCount":2},"containerprofiles":{"maxObjectSize":2500000,"queueLength":50,"workerCount":2},"networkneighborhoods":{"maxObjectSize":10000000,"queueLength":50,"workerCount":2},"openvulnerabilityexchangecontainers":{"maxObjectSize":500000,"queueLength":50,"workerCount":1},"sbomsyftfiltereds":{"maxObjectSize":50000000,"queueLength":50,"workerCount":1},"sbomsyfts":{"maxObjectSize":100000000,"queueLength":50,"workerCount":1},"vulnerabilitymanifests":{"maxObjectSize":50000000,"queueLength":50,"workerCount":1}},
          "tlsClientCaFile": "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt",
          "tlsServerCertFile": "/etc/storage-ca-certificates/tls.crt",
          "tlsServerKeyFile": "/etc/storage-ca-certificates/tls.key",
          "serverBindPort": "8443"
        }
    kind: ConfigMap
    metadata:
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: storage
      namespace: kubescape
  31: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: storage
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations: null
          labels:
            app: storage
            app.kubernetes.io/component: storage
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          containers:
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
              image: quay.io/kubescape/storage:v0.0.220
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 8443
                  scheme: HTTPS
              name: apiserver
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 8443
                  scheme: HTTPS
              resources:
                limits:
                  cpu: 1500m
                  memory: 1500Mi
                requests:
                  cpu: 100m
                  memory: 400Mi
              securityContext:
                allowPrivilegeEscalation: false
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: data
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/storage-ca-certificates
                  name: ca-certificates
                  readOnly: true
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: storage
          tolerations: null
          volumes:
            - name: data
              persistentVolumeClaim:
                claimName: kubescape-storage
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: storage
              name: config
            - name: ca-certificates
              secret:
                secretName: storage-ca
  32: |
    apiVersion: v1
    kind: PersistentVolumeClaim
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-storage
      namespace: kubescape
    spec:
      accessModes:
        - ReadWriteOnce
      resources:
        requests:
          storage: 5Gi
  33: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage-auth-reader
      namespace: kube-system
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: extension-apiserver-authentication-reader
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  34: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      ports:
        - name: https
          port: 443
          protocol: TCP
          targetPort: 8443
      selector:
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
  35: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
multiple node agents:
  1: |+
    raw: |+
      Thank you for installing kubescape-operator version 1.29.9.
      View your cluster's configuration scanning schedule:
      > kubectl -n kubescape get cj kubescape-scheduler -o=jsonpath='{.metadata.name}{"\t"}{.spec.schedule}{"\n"}'

      To change the schedule, set `.spec.schedule`:
      > kubectl -n kubescape edit cj kubescape-scheduler
      View your cluster's image scanning schedule:
      > kubectl -n kubescape get cj kubevuln-scheduler -o=jsonpath='{.metadata.name}{"\t"}{.spec.schedule}{"\n"}'

      To change the schedule, edit `.spec.schedule`:
      > kubectl -n kubescape edit cj kubevuln-scheduler

      View your image vulnerabilities scan summaries:
      > kubectl get vulnerabilitymanifestsummaries -A

      Detailed reports are also available:
      > kubectl get vulnerabilitymanifests -A

      kubescape-operator generates suggested network policies. To view them:
      > kubectl get generatednetworkpolicies -n <namespace>

  2: |
    apiVersion: batch/v1
    kind: CronJob
    metadata:
      annotations:
        helm.sh/resource-policy: keep
      labels:
        app: helm-release-upgrader
        app.kubernetes.io/component: helm-release-upgrader
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: helm-release-upgrader
      namespace: kubescape
    spec:
      failedJobsHistoryLimit: 1
      jobTemplate:
        spec:
          template:
            metadata:
              annotations: null
              labels:
                app: helm-release-upgrader
                app.kubernetes.io/component: helm-release-upgrader
                app.kubernetes.io/instance: RELEASE-NAME
                app.kubernetes.io/managed-by: Helm
                app.kubernetes.io/name: kubescape-operator
                app.kubernetes.io/part-of: kubescape
                app.kubernetes.io/version: 1.29.9
                helm.sh/chart: kubescape-operator-1.29.9
                kubescape.io/ignore: "true"
                tier: ks-control-plane
            spec:
              affinity: null
              containers:
                - env:
                    - name: HELM_CACHE_HOME
                      value: /data/helm-scratch-data/.cache
                    - name: HELM_CONFIG_HOME
                      value: /data/helm-scratch-data/.config
                    - name: HELM_DATA_HOME
                      value: /data/helm-scratch-data/.data
                  image: quay.io/kubescape/helm-release-upgrader:v0.1.0
                  imagePullPolicy: IfNotPresent
                  name: helm-release-upgrader
                  resources:
                    limits:
                      cpu: 500m
                      memory: 256Mi
                    requests:
                      cpu: 500m
                      memory: 256Mi
                  securityContext:
                    allowPrivilegeEscalation: false
                    readOnlyRootFilesystem: true
                  volumeMounts:
                    - mountPath: /data/helm-scratch-data
                      name: helm-scratch-data
              nodeSelector:
                kubernetes.io/os: linux
              restartPolicy: OnFailure
              securityContext:
                fsGroup: 1000
                runAsGroup: 1000
                runAsNonRoot: true
                runAsUser: 1000
              serviceAccountName: helm-release-upgrader
              tolerations: null
              volumes:
                - emptyDir:
                    sizeLimit: 500Mi
                  name: helm-scratch-data
      schedule: 0 14 * * *
      successfulJobsHistoryLimit: 3
  3: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      labels:
        app: helm-release-upgrader
        app.kubernetes.io/component: helm-release-upgrader
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: helm-release-upgrader
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
      podSelector:
        matchLabels:
          app.kubernetes.io/component: helm-release-upgrader
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Egress
  4: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations:
        helm.sh/resource-policy: keep
      labels:
        app: helm-release-upgrader
        app.kubernetes.io/component: helm-release-upgrader
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: helm-release-upgrader
    rules:
      - apiGroups:
          - '*'
        resources:
          - '*'
        verbs:
          - '*'
  5: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations:
        helm.sh/resource-policy: keep
      labels:
        app: helm-release-upgrader
        app.kubernetes.io/component: helm-release-upgrader
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: helm-release-upgrader
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: helm-release-upgrader
    subjects:
      - kind: ServiceAccount
        name: helm-release-upgrader
        namespace: kubescape
  6: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations:
        helm.sh/resource-policy: keep
      labels:
        app: helm-release-upgrader
        app.kubernetes.io/component: helm-release-upgrader
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: helm-release-upgrader
      namespace: kubescape
  7: |
    apiVersion: v1
    data:
      accessKey: ZjMwNGQ3M2ItZDQzYy00MTJiLTgyZWEtZTRjODU5NDkzY2U2
      account: OWU2YzBjMmMtNmJkMC00OTE5LTgxNWItNTUwMzBkZTdjOWEw
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: cloud-secret
        app.kubernetes.io/component: cloud-secret
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/infra: credentials
        tier: ks-control-plane
      name: cloud-secret
      namespace: kubescape
    type: Opaque
  8: |
    apiVersion: v1
    data:
      clusterData: |
        {
          "serviceDiscovery": true,
          "vulnScanURL": "kubevuln:8080",
          "kubevulnURL": "kubevuln:8080",
          "kubescapeURL": "kubescape:8080",
          "clusterName": "kind-kind",
          "storage": true,
          "relevantImageVulnerabilitiesEnabled": true,
          "namespace": "kubescape",
          "imageVulnerabilitiesScanningEnabled": true,
          "postureScanEnabled": true,
          "otelCollector": false,
          "nodeAgent": "true",
          "maxImageSize": 5.36870912e+09,
          "maxSBOMSize": 2.097152e+07,
          "keepLocal": false,
          "scanTimeout": "5m",
          "scanEmbeddedSBOMs": true,
          "vexGeneration": true,
          "useDefaultMatchers": true,
          "storeFilteredSbom": true,
          "continuousPostureScan": false,
          "listingURL": "http://grype-offline-db:80/databases",
          "relevantImageVulnerabilitiesConfiguration": "enable"
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/infra: config
        kubescape.io/tier: core
        tier: ks-control-plane
      name: ks-cloud-config
      namespace: kubescape
  9: |
    apiVersion: v1
    data:
      capabilities: |
        {
          "capabilities":{"admissionController":"enable","autoUpgrading":"enable","configurationScan":"enable","continuousScan":"enable","httpDetection":"enable","kubescapeOffline":"disable","linuxAudit":"enable","malwareDetection":"enable","manageWorkloads":"enable","networkEventsStreaming":"enable","networkPolicyService":"enable","nodeProfileService":"enable","nodeSbomGeneration":"enable","nodeScan":"enable","prometheusExporter":"enable","relevancy":"enable","runtimeDetection":"enable","runtimeObservability":"enable","scanEmbeddedSBOMs":"enable","seccompProfileService":"enable","syncSBOM":"enable","testing":{"nodeAgentMultiplication":{"enabled":false,"replicas":5}},"vexGeneration":"enable","vulnerabilityScan":"enable"},
          "components":{"autoUpdater":{"enabled":true},"clamAV":{"enabled":true},"cloudSecret":{"create":true,"name":"cloud-secret"},"customCaCertificates":{"name":"custom-ca-certificates"},"hostScanner":{"enabled":true},"kubescape":{"enabled":true},"kubescapeScheduler":{"enabled":true},"kubevuln":{"enabled":true},"kubevulnScheduler":{"enabled":true},"nodeAgent":{"enabled":true},"operator":{"enabled":true},"otelCollector":{"enabled":false},"prometheusExporter":{"enabled":true},"serviceDiscovery":{"enabled":true},"storage":{"enabled":true},"synchronizer":{"enabled":true}},
          "configurations":{"excludeJsonPaths":[".containers[*].env[?(@.name==\"KUBECONFIG\")]"],"otelUrl":"otelCollector.svc.monitoring:4317","persistence":"enable","priorityClass":{"daemonset":100000100,"enabled":true},"prometheusAnnotations":"disable"} ,
          "serviceScanConfig" :{"enabled":false,"interval":"1h"}
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-capabilities
        app.kubernetes.io/component: ks-capabilities
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: ks-capabilities
      namespace: kubescape
  10: |
    apiVersion: v1
    data:
      ca-certificates.crt: Zm9v
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: custom-ca-certificates
        app.kubernetes.io/component: custom-ca-certificates
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/infra: credentials
        tier: ks-control-plane
      name: custom-ca-certificates
      namespace: kubescape
    type: Opaque
  11: |
    apiVersion: v1
    data:
      matchingRules.json: |
        {"match":[{"apiGroups":["apps"],"apiVersions":["v1"],"resources":["deployments"]}],"namespaces":["default"]}
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: cs-matching-rules
      namespace: kubescape
  12: |
    apiVersion: scheduling.k8s.io/v1
    description: This priority class is for node-agent daemonset pods
    globalDefault: false
    kind: PriorityClass
    metadata:
      annotations: null
      labels:
        app: kubescape-critical
        app.kubernetes.io/component: kubescape-critical
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-critical
    value: 1.000001e+08
  13: |
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      labels:
        app: linux-audit-rules
        app.kubernetes.io/component: linux-audit-rules
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: linuxauditrules.kubescape.io
    spec:
      group: kubescape.io
      names:
        kind: LinuxAuditRule
        plural: linuxauditrules
        shortNames:
          - lar
          - linuxauditrule
          - auditrule
        singular: linuxauditrule
      scope: Namespaced
      versions:
        - additionalPrinterColumns:
            - description: Whether the Linux audit rules are enabled
              jsonPath: .spec.enabled
              name: Enabled
              type: boolean
            - description: Number of Linux audit rules defined
              jsonPath: .status.appliedRules
              name: Rules
              type: integer
            - description: Status of the Linux audit rules
              jsonPath: .status.conditions[?(@.type=="Ready")].status
              name: Status
              type: string
            - jsonPath: .metadata.creationTimestamp
              name: Age
              type: date
          name: v1
          schema:
            openAPIV3Schema:
              properties:
                spec:
                  properties:
                    enabled:
                      default: true
                      description: Controls whether these rules should be active
                      type: boolean
                    nodeSelector:
                      additionalProperties:
                        type: string
                      description: Node selector to target specific nodes
                      type: object
                    rateLimit:
                      description: Rate limiting configuration
                      properties:
                        burstSize:
                          description: Burst size for rate limiting
                          minimum: 1
                          type: integer
                        eventsPerSecond:
                          description: Maximum events per second
                          minimum: 1
                          type: integer
                      type: object
                    rules:
                      description: List of audit rule definitions
                      items:
                        properties:
                          description:
                            description: Human-readable description of what this rule monitors
                            type: string
                          enabled:
                            default: true
                            description: Controls whether this specific rule is active
                            type: boolean
                          fileWatch:
                            description: File system monitoring rule
                            properties:
                              exclude:
                                description: Exclude patterns (basic glob patterns)
                                items:
                                  type: string
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              paths:
                                description: Paths to monitor
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              permissions:
                                description: Permissions to monitor
                                items:
                                  enum:
                                    - read
                                    - write
                                    - attr
                                    - attribute
                                    - execute
                                  type: string
                                minItems: 1
                                type: array
                              recursive:
                                default: false
                                description: Recursive monitoring (future use)
                                type: boolean
                            required:
                              - paths
                              - permissions
                              - keys
                            type: object
                          name:
                            description: Unique name of this rule within the CRD
                            type: string
                          network:
                            description: Network monitoring rule (future extension)
                            properties:
                              addresses:
                                description: Addresses to monitor
                                items:
                                  type: string
                                type: array
                              direction:
                                description: Traffic direction
                                enum:
                                  - inbound
                                  - outbound
                                  - both
                                type: string
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              ports:
                                description: Ports to monitor
                                items:
                                  maximum: 65535
                                  minimum: 1
                                  type: integer
                                type: array
                              protocols:
                                description: Protocols to monitor
                                items:
                                  enum:
                                    - tcp
                                    - udp
                                    - icmp
                                  type: string
                                type: array
                            required:
                              - keys
                            type: object
                          priority:
                            default: 100
                            description: Priority for rule ordering (lower = higher priority)
                            maximum: 1000
                            minimum: 1
                            type: integer
                          process:
                            description: Process monitoring rule
                            properties:
                              arguments:
                                description: Command line argument patterns
                                items:
                                  type: string
                                type: array
                              executables:
                                description: Executables to monitor (path patterns)
                                items:
                                  type: string
                                type: array
                              filters:
                                description: Additional filters
                                items:
                                  properties:
                                    field:
                                      description: Field to filter on
                                      type: string
                                    operator:
                                      description: Comparison operator
                                      enum:
                                        - =
                                        - '!='
                                        - <
                                        - '>'
                                        - <=
                                        - '>='
                                      type: string
                                    value:
                                      description: Value to compare against
                                      type: string
                                  required:
                                    - field
                                    - operator
                                    - value
                                  type: object
                                type: array
                              groups:
                                description: Groups to monitor
                                items:
                                  type: string
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              users:
                                description: Users to monitor
                                items:
                                  type: string
                                type: array
                            required:
                              - keys
                            type: object
                          rawRule:
                            description: Raw auditctl format rule (fallback for complex rules)
                            type: string
                          syscall:
                            description: System call monitoring rule
                            properties:
                              action:
                                default: always
                                description: Action to take
                                enum:
                                  - always
                                  - never
                                type: string
                              architecture:
                                description: Architecture filters
                                items:
                                  enum:
                                    - b64
                                    - b32
                                  type: string
                                type: array
                              filters:
                                description: Filters for syscall parameters
                                items:
                                  properties:
                                    field:
                                      description: Field to filter on
                                      enum:
                                        - pid
                                        - ppid
                                        - uid
                                        - gid
                                        - euid
                                        - egid
                                        - auid
                                        - exe
                                        - comm
                                        - key
                                        - exit
                                        - success
                                        - dir
                                        - path
                                        - perm
                                        - arch
                                        - a0
                                        - a1
                                        - a2
                                        - a3
                                        - a4
                                        - a5
                                        - a6
                                        - a7
                                        - a8
                                        - a9
                                        - a10
                                        - a11
                                        - a12
                                        - a13
                                        - a14
                                        - a15
                                      type: string
                                    operator:
                                      description: Comparison operator
                                      enum:
                                        - =
                                        - '!='
                                        - <
                                        - '>'
                                        - <=
                                        - '>='
                                      type: string
                                    value:
                                      description: Value to compare against
                                      type: string
                                  required:
                                    - field
                                    - operator
                                    - value
                                  type: object
                                maxItems: 20
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              list:
                                default: exit
                                description: Audit list type
                                enum:
                                  - task
                                  - exit
                                  - user
                                  - exclude
                                type: string
                              syscalls:
                                description: System calls to monitor
                                items:
                                  type: string
                                minItems: 1
                                type: array
                            required:
                              - syscalls
                            type: object
                        required:
                          - name
                        type: object
                      type: array
                  type: object
                status:
                  properties:
                    appliedRules:
                      description: Number of rules successfully applied to the kernel
                      minimum: 0
                      type: integer
                    conditions:
                      description: Current conditions of the AuditRule
                      items:
                        properties:
                          lastTransitionTime:
                            description: Last time the condition transitioned
                            format: date-time
                            type: string
                          message:
                            description: Human-readable message about the transition
                            type: string
                          reason:
                            description: Reason for the condition's last transition
                            type: string
                          status:
                            description: Status of the condition
                            enum:
                              - "True"
                              - "False"
                              - Unknown
                            type: string
                          type:
                            description: Type of condition
                            enum:
                              - Ready
                              - Progressing
                              - Failed
                            type: string
                        required:
                          - type
                          - status
                          - lastTransitionTime
                        type: object
                      type: array
                    failedRules:
                      description: Rules that failed to apply
                      items:
                        properties:
                          error:
                            description: Error message describing the failure
                            type: string
                          lastAttempt:
                            description: When we last tried to apply this rule
                            format: date-time
                            type: string
                          name:
                            description: Name of the failed rule
                            type: string
                        required:
                          - name
                          - error
                        type: object
                      type: array
                    lastUpdated:
                      description: When the rules were last updated
                      format: date-time
                      type: string
                    observedGeneration:
                      description: Generation of the most recently observed AuditRule
                      type: integer
                  type: object
              type: object
          served: true
          storage: true
          subresources:
            status: {}
  14: |
    apiVersion: batch/v1
    kind: CronJob
    metadata:
      annotations: null
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        armo.tier: vuln-scan
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
    spec:
      failedJobsHistoryLimit: 1
      jobTemplate:
        spec:
          template:
            metadata:
              annotations:
                foo: bar
              labels:
                app: grype-offline-db
                app.kubernetes.io/component: grype-offline-db
                app.kubernetes.io/instance: RELEASE-NAME
                app.kubernetes.io/managed-by: Helm
                app.kubernetes.io/name: kubescape-operator
                app.kubernetes.io/part-of: kubescape
                app.kubernetes.io/version: 1.29.9
                armo.tier: vuln-scan
                bar: baz
                helm.sh/chart: kubescape-operator-1.29.9
                kubescape.io/ignore: "true"
                kubescape.io/tier: core
                tier: ks-control-plane
            spec:
              affinity: null
              automountServiceAccountToken: true
              containers:
                - args:
                    - |
                      kubectl rollout restart deployment -n kubescape grype-offline-db
                  command:
                    - /bin/sh
                    - -c
                  image: quay.io/kubescape/kubectl:1.30.3
                  imagePullPolicy: IfNotPresent
                  name: grype-offline-db
                  resources:
                    limits:
                      cpu: 100m
                      memory: 50Mi
                    requests:
                      cpu: 10m
                      memory: 10Mi
                  securityContext:
                    allowPrivilegeEscalation: false
                    readOnlyRootFilesystem: true
                    runAsNonRoot: true
                    runAsUser: 100
              imagePullSecrets:
                - name: foo
                - name: bar
              nodeSelector:
                kubernetes.io/os: linux
              restartPolicy: Never
              securityContext:
                seccompProfile:
                  type: RuntimeDefault
              serviceAccountName: grype-offline-db
              tolerations: null
      schedule: 5 0 * * *
      successfulJobsHistoryLimit: 3
  15: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: grype-offline-db
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          annotations:
            foo: bar
          labels:
            app: grype-offline-db
            app.kubernetes.io/component: grype-offline-db
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            bar: baz
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          containers:
            - image: quay.io/kubescape/grype-offline-db:latest
              imagePullPolicy: Always
              name: grype-offline-db
              ports:
                - containerPort: 8080
                  protocol: TCP
              resources:
                limits:
                  cpu: 150m
                  memory: 200Mi
                requests:
                  cpu: 150m
                  memory: 200Mi
              securityContext:
                allowPrivilegeEscalation: false
                runAsNonRoot: true
          imagePullSecrets:
            - name: foo
            - name: bar
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            seccompProfile:
              type: RuntimeDefault
          tolerations: null
  16: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
    spec:
      ingress:
        - from:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: kubevuln
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
          ports:
            - port: 8080
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: grype-offline-db
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
  17: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
    rules:
      - apiGroups:
          - apps
        resources:
          - deployments
        verbs:
          - get
          - patch
  18: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: grype-offline-db
    subjects:
      - kind: ServiceAccount
        name: grype-offline-db
        namespace: kubescape
  19: |
    apiVersion: v1
    kind: Service
    metadata:
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
    spec:
      ports:
        - port: 80
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  20: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      labels:
        app: grype-offline-db
        app.kubernetes.io/component: grype-offline-db
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: grype-offline-db
      namespace: kubescape
  21: |
    apiVersion: v1
    data:
      request-body.json: '{"commands":[{"CommandName":"kubescapeScan","args":{"scanV1":{}}}]}'
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: kubescape-scheduler
        app.kubernetes.io/component: kubescape-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-scheduler
      namespace: kubescape
  22: |
    apiVersion: batch/v1
    kind: CronJob
    metadata:
      annotations: null
      labels:
        app: kubescape-scheduler
        app.kubernetes.io/component: kubescape-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        armo.tier: kubescape-scan
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-scheduler
      namespace: kubescape
    spec:
      failedJobsHistoryLimit: 1
      jobTemplate:
        spec:
          template:
            metadata:
              annotations: null
              labels:
                app: kubescape-scheduler
                app.kubernetes.io/component: kubescape-scheduler
                app.kubernetes.io/instance: RELEASE-NAME
                app.kubernetes.io/managed-by: Helm
                app.kubernetes.io/name: kubescape-operator
                app.kubernetes.io/part-of: kubescape
                app.kubernetes.io/version: 1.29.9
                armo.tier: kubescape-scan
                helm.sh/chart: kubescape-operator-1.29.9
                kubescape.io/ignore: "true"
                kubescape.io/tier: core
                tier: ks-control-plane
            spec:
              affinity: null
              automountServiceAccountToken: false
              containers:
                - args:
                    - -method=post
                    - -scheme=http
                    - -host=operator:4002
                    - -path=v1/triggerAction
                    - -headers=Content-Type:application/json
                    - -path-body=/home/ks/request-body.json
                  image: quay.io/kubescape/http-request:v0.2.14
                  imagePullPolicy: IfNotPresent
                  name: kubescape-scheduler
                  resources:
                    limits:
                      cpu: 10m
                      memory: 20Mi
                    requests:
                      cpu: 1m
                      memory: 10Mi
                  securityContext:
                    allowPrivilegeEscalation: false
                    readOnlyRootFilesystem: true
                    runAsNonRoot: true
                    runAsUser: 100
                  volumeMounts:
                    - mountPath: /home/ks/request-body.json
                      name: kubescape-scheduler
                      readOnly: true
                      subPath: request-body.json
              imagePullSecrets:
                - name: foo
                - name: bar
              nodeSelector:
                kubernetes.io/os: linux
              restartPolicy: Never
              securityContext:
                seccompProfile:
                  type: RuntimeDefault
              serviceAccountName: kubescape
              tolerations: null
              volumes:
                - configMap:
                    name: kubescape-scheduler
                  name: kubescape-scheduler
      schedule: 1 2 3 4 5
      successfulJobsHistoryLimit: 3
  23: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      labels:
        app: kubescape-scheduler
        app.kubernetes.io/component: kubescape-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-scheduler
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
        - ports:
            - port: 4002
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: operator
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
      podSelector:
        matchLabels:
          app.kubernetes.io/component: kubescape-scheduler
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Egress
  24: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - pods
          - pods/proxy
          - namespaces
          - nodes
          - configmaps
          - services
          - serviceaccounts
          - endpoints
          - persistentvolumeclaims
          - persistentvolumes
          - limitranges
          - replicationcontrollers
          - podtemplates
          - resourcequotas
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - secrets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - admissionregistration.k8s.io
        resources:
          - mutatingwebhookconfigurations
          - validatingwebhookconfigurations
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apiregistration.k8s.io
        resources:
          - apiservices
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - deployments
          - statefulsets
          - daemonsets
          - replicasets
          - controllerrevisions
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - autoscaling
        resources:
          - horizontalpodautoscalers
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - coordination.k8s.io
        resources:
          - leases
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - discovery.k8s.io
        resources:
          - endpointslices
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - events.k8s.io
        resources:
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - hostdata.kubescape.cloud
        resources:
          - APIServerInfo
          - ControlPlaneInfo
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - networking.k8s.io
        resources:
          - networkpolicies
          - Ingress
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - cilium.io
        resources:
          - ciliumnetworkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - projectcalico.org
        resources:
          - networkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - networking.istio.io
        resources:
          - gateways
          - virtualservices
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - security.istio.io
        resources:
          - authorizationpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - policy
        resources:
          - poddisruptionbudgets
          - podsecuritypolicies
          - PodSecurityPolicy
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - rbac.authorization.k8s.io
        resources:
          - clusterroles
          - clusterrolebindings
          - roles
          - rolebindings
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - storage.k8s.io
        resources:
          - csistoragecapacities
          - storageclasses
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - networking.k8s.io
        resources:
          - ingresses
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - extensions
        resources:
          - Ingress
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - gateway.networking.k8s.io
        resources:
          - httproutes
          - gateways
          - gatewayclasses
          - tcproutes
          - tlsroutes
          - udproutes
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - namespaces
        verbs:
          - update
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - workloadconfigurationscans
          - workloadconfigurationscansummaries
        verbs:
          - create
          - get
          - update
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
  25: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: kubescape
    subjects:
      - kind: ServiceAccount
        name: kubescape
        namespace: kubescape
  26: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: kubescape
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          annotations:
            checksum/cloud-config: aaeeb6b6b35a5ebbb0893822c4bf9cd860fba6d3df3bc4e77c8dbdd5841db120
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/host-scanner-configmap: 6cf2370947bbd9d1c99183fc2c6dac64d0fcd79df984c60644c1f3634dd98bfb
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
          labels:
            app: kubescape
            app.kubernetes.io/component: kubescape
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - command:
                - ksserver
              env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: KS_DOWNLOAD_ARTIFACTS
                  value: "true"
                - name: RULE_PROCESSING_GOMAXPROCS
                  value: ""
                - name: KS_DEFAULT_CONFIGMAP_NAME
                  value: kubescape-config
                - name: KS_DEFAULT_CONFIGMAP_NAMESPACE
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: KS_CONTEXT
                  value: kind-kind
                - name: KS_DEFAULT_CLOUD_CONFIGMAP_NAME
                  value: ks-cloud-config
                - name: KS_ENABLE_HOST_SCANNER
                  value: "true"
                - name: KS_SKIP_UPDATE_CHECK
                  value: "false"
                - name: KS_HOST_SCAN_YAML
                  value: /home/nonroot/.kubescape/host-scanner.yaml
                - name: LARGE_CLUSTER_SIZE
                  value: "1500"
                - name: AZURE_SUBSCRIPTION_ID
                  valueFrom:
                    secretKeyRef:
                      key: aksSubscriptionID
                      name: kubescape-secret
                - name: AZURE_CLIENT_ID
                  valueFrom:
                    secretKeyRef:
                      key: aksClientID
                      name: kubescape-secret
                - name: AZURE_CLIENT_SECRET
                  valueFrom:
                    secretKeyRef:
                      key: aksClientSecret
                      name: kubescape-secret
                - name: AZURE_TENANT_ID
                  valueFrom:
                    secretKeyRef:
                      key: aksTenantID
                      name: kubescape-secret
                - name: AZURE_RESOURCE_GROUP
                  valueFrom:
                    secretKeyRef:
                      key: aksResourceGroup
                      name: kubescape-secret
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
                - name: KS_INCLUDE_NAMESPACES
                  value: my-namespace
              image: quay.io/kubescape/kubescape:v3.0.41
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 8080
                initialDelaySeconds: 3
                periodSeconds: 3
              name: kubescape
              ports:
                - containerPort: 8080
                  name: http
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 8080
                initialDelaySeconds: 3
                periodSeconds: 3
              resources:
                limits:
                  cpu: 600m
                  memory: 1Gi
                requests:
                  cpu: 250m
                  memory: 400Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /home/nonroot/.kubescape
                  name: kubescape-volume
                  subPath: config.json
                - mountPath: /home/nonroot/.kubescape/host-scanner.yaml
                  name: host-scanner-definition
                  subPath: host-scanner-yaml
                - mountPath: /home/nonroot/results
                  name: results
                - mountPath: /home/nonroot/failed
                  name: failed
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/services.json
                  name: services
                  readOnly: true
                  subPath: services.json
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
                - mountPath: /etc/ssl/certs/ca-certificates.crt
                  name: custom-ca-certificates
                  subPath: ca-certificates.crt
          imagePullSecrets:
            - name: foo
            - name: bar
          initContainers:
            - args:
                - -method=get
                - -scheme=https
                - -host=api.armosec.io
                - -path=api/v2/servicediscovery
                - -path-output=/data/services.json
              env:
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
              image: quay.io/kubescape/http-request:v0.2.14
              imagePullPolicy: IfNotPresent
              name: url-discovery
              resources:
                limits:
                  cpu: 100m
                  memory: 50Mi
                requests:
                  cpu: 10m
                  memory: 10Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: services
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: kubescape
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: custom-ca-certificates
              secret:
                secretName: custom-ca-certificates
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - emptyDir: {}
              name: services
            - configMap:
                name: host-scanner-definition
              name: host-scanner-definition
            - emptyDir: {}
              name: kubescape-volume
            - emptyDir: {}
              name: results
            - emptyDir: {}
              name: failed
  27: |
    apiVersion: v1
    data:
      host-scanner-yaml: "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: host-scanner\n  namespace: kubescape\n  annotations:\n    \n  labels:\n    helm.sh/chart: kubescape-operator-1.29.9\n    app.kubernetes.io/name: kubescape-operator\n    app.kubernetes.io/instance: RELEASE-NAME\n    app.kubernetes.io/component: host-scanner\n    app.kubernetes.io/version: \"1.29.9\"\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/part-of: kubescape\n    app: host-scanner\n    tier: ks-control-plane\n    kubescape.io/ignore: \"true\"\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: kubescape-operator\n      app.kubernetes.io/instance: RELEASE-NAME\n      app.kubernetes.io/component: host-scanner\n  template:\n    metadata:\n      annotations:\n        \n      labels:\n        helm.sh/chart: kubescape-operator-1.29.9\n        app.kubernetes.io/name: kubescape-operator\n        app.kubernetes.io/instance: RELEASE-NAME\n        app.kubernetes.io/component: host-scanner\n        app.kubernetes.io/version: \"1.29.9\"\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/part-of: kubescape\n        app: host-scanner\n        tier: ks-control-plane\n        kubescape.io/ignore: \"true\"\n        kubescape.io/tier: \"core\"\n        name: host-scanner\n    spec:\n      nodeSelector:\n        kubernetes.io/os: linux\n      affinity:\n      tolerations:\n        - effect: NoSchedule\n          key: node-role.kubernetes.io/control-plane\n          operator: Exists\n        - effect: NoSchedule\n          key: node-role.kubernetes.io/master\n          operator: Exists\n      imagePullSecrets:\n      - name: foo\n      - name: bar\n      containers:\n      - name: host-sensor\n        image: \"quay.io/kubescape/host-scanner:v1.0.76\"\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: true\n          privileged: true\n          readOnlyRootFilesystem: true\n          procMount: Unmasked\n        env:\n        - name: KS_LOGGER_LEVEL\n          value: \"info\"\n        - name: KS_LOGGER_NAME\n          value: \"zap\"\n        - name: OTEL_COLLECTOR_SVC\n          value: otelCollector.svc.monitoring:4317\n        ports:\n          - name: scanner # Do not change port name\n            containerPort: 7888\n            protocol: TCP\n        resources:\n          limits:\n            cpu: 0.4m\n            memory: 400Mi\n          requests:\n            cpu: 0.1m\n            memory: 200Mi\n        volumeMounts:\n        - mountPath: /host_fs\n          name: host-filesystem\n        startupProbe:\n          httpGet:\n            path: /readyz\n            port: 7888\n          failureThreshold: 30\n          periodSeconds: 1\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 7888\n          periodSeconds: 10\n      terminationGracePeriodSeconds: 120\n      dnsPolicy: ClusterFirstWithHostNet\n      serviceAccountName: node-agent\n      automountServiceAccountToken: false\n      volumes:\n      - hostPath:\n          path: /\n          type: Directory\n        name: host-filesystem\n      hostPID: true\n      hostIPC: true"
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: host-scanner-definition
      namespace: kubescape
  28: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
        - ports:
            - port: 80
              protocol: TCP
          to:
            - ipBlock:
                cidr: 169.254.169.254/32
        - ports:
            - port: 443
              protocol: TCP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: default
              podSelector:
                matchLabels:
                  component: apiserver
                  provider: kubernetes
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
      ingress:
        - from:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: operator
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
          ports:
            - port: http
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: kubescape
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
        - Egress
  29: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    rules:
      - apiGroups:
          - apps
        resources:
          - daemonsets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  30: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: kubescape
    subjects:
      - kind: ServiceAccount
        name: kubescape
        namespace: kubescape
  31: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-scc
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:openshift:scc:nonroot-v2
    subjects:
      - kind: ServiceAccount
        name: kubescape
        namespace: kubescape
  32: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    spec:
      ports:
        - name: http
          port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  33: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
  34: |
    apiVersion: monitoring.coreos.com/v1
    kind: ServiceMonitor
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-monitor
      namespace: kubescape
    spec:
      endpoints:
        - interval: 200s
          path: /v1/metrics
          port: http
          scrapeTimeout: 150s
      namespaceSelector:
        matchNames:
          - kubescape
      selector:
        matchLabels:
          app.kubernetes.io/component: kubescape
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
  35: |
    apiVersion: v1
    data:
      request-body.json: '{"commands":[{"commandName":"scan","designators":[{"designatorType":"Attributes","attributes":{}}]}]}'
    kind: ConfigMap
    metadata:
      labels:
        app: kubevuln-scheduler
        app.kubernetes.io/component: kubevuln-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-scheduler
      namespace: kubescape
  36: |
    apiVersion: batch/v1
    kind: CronJob
    metadata:
      annotations: null
      labels:
        app: kubevuln-scheduler
        app.kubernetes.io/component: kubevuln-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        armo.tier: vuln-scan
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-scheduler
      namespace: kubescape
    spec:
      failedJobsHistoryLimit: 1
      jobTemplate:
        spec:
          template:
            metadata:
              annotations: null
              labels:
                app: kubevuln-scheduler
                app.kubernetes.io/component: kubevuln-scheduler
                app.kubernetes.io/instance: RELEASE-NAME
                app.kubernetes.io/managed-by: Helm
                app.kubernetes.io/name: kubescape-operator
                app.kubernetes.io/part-of: kubescape
                app.kubernetes.io/version: 1.29.9
                armo.tier: vuln-scan
                helm.sh/chart: kubescape-operator-1.29.9
                kubescape.io/ignore: "true"
                kubescape.io/tier: core
                tier: ks-control-plane
            spec:
              affinity: null
              automountServiceAccountToken: false
              containers:
                - args:
                    - -method=post
                    - -scheme=http
                    - -host=operator:4002
                    - -path=v1/triggerAction
                    - -headers=Content-Type:application/json
                    - -path-body=/home/ks/request-body.json
                  image: quay.io/kubescape/http-request:v0.2.14
                  imagePullPolicy: IfNotPresent
                  name: kubevuln-scheduler
                  resources:
                    limits:
                      cpu: 10m
                      memory: 20Mi
                    requests:
                      cpu: 1m
                      memory: 10Mi
                  securityContext:
                    allowPrivilegeEscalation: false
                    readOnlyRootFilesystem: true
                    runAsNonRoot: true
                    runAsUser: 100
                  volumeMounts:
                    - mountPath: /home/ks/request-body.json
                      name: kubevuln-scheduler
                      readOnly: true
                      subPath: request-body.json
              imagePullSecrets:
                - name: foo
                - name: bar
              nodeSelector:
                kubernetes.io/os: linux
              restartPolicy: Never
              securityContext:
                seccompProfile:
                  type: RuntimeDefault
              serviceAccountName: kubevuln
              tolerations: null
              volumes:
                - configMap:
                    name: kubevuln-scheduler
                  name: kubevuln-scheduler
      schedule: 1 2 3 4 5
      successfulJobsHistoryLimit: 3
  37: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      labels:
        app: kubevuln-scheduler
        app.kubernetes.io/component: kubevuln-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln-scheduler
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
        - ports:
            - port: 4002
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: operator
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
      podSelector:
        matchLabels:
          app.kubernetes.io/component: kubevuln-scheduler
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Egress
  38: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
    rules:
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - vulnerabilitymanifests
          - vulnerabilitymanifestsummaries
          - openvulnerabilityexchangecontainers
          - sbomsyfts
          - sbomsyftfiltereds
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - containerprofiles
        verbs:
          - get
          - watch
          - list
  39: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: kubevuln
    subjects:
      - kind: ServiceAccount
        name: kubevuln
        namespace: kubescape
  40: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: kubevuln
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations:
            checksum/cloud-config: aaeeb6b6b35a5ebbb0893822c4bf9cd860fba6d3df3bc4e77c8dbdd5841db120
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
          labels:
            app: kubevuln
            app.kubernetes.io/component: kubevuln
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - args:
                - -alsologtostderr
                - -v=4
                - 2>&1
              env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: PRINT_POST_JSON
                  value: ""
                - name: CA_MAX_VULN_SCAN_ROUTINES
                  value: "1"
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
              image: quay.io/kubescape/kubevuln:v0.3.93
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /v1/liveness
                  port: 8080
                initialDelaySeconds: 3
                periodSeconds: 3
              name: kubevuln
              ports:
                - containerPort: 8080
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /v1/readiness
                  port: 8080
              resources:
                limits:
                  cpu: 1500m
                  ephemeral-storage: 10Gi
                  memory: 5000Mi
                requests:
                  cpu: 300m
                  ephemeral-storage: 5Gi
                  memory: 1000Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /tmp
                  name: tmp-dir
                - mountPath: /home/nonroot/anchore-resources/db
                  name: grype-db-cache
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/services.json
                  name: services
                  readOnly: true
                  subPath: services.json
                - mountPath: /home/nonroot/.cache/grype
                  name: grype-db
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
                - mountPath: /etc/ssl/certs/ca-certificates.crt
                  name: custom-ca-certificates
                  subPath: ca-certificates.crt
          imagePullSecrets:
            - name: foo
            - name: bar
          initContainers:
            - args:
                - -method=get
                - -scheme=https
                - -host=api.armosec.io
                - -path=api/v2/servicediscovery
                - -path-output=/data/services.json
              env:
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
              image: quay.io/kubescape/http-request:v0.2.14
              imagePullPolicy: IfNotPresent
              name: url-discovery
              resources:
                limits:
                  cpu: 100m
                  memory: 50Mi
                requests:
                  cpu: 10m
                  memory: 10Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: services
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: kubevuln
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: custom-ca-certificates
              secret:
                secretName: custom-ca-certificates
            - emptyDir: {}
              name: tmp-dir
            - emptyDir: {}
              name: grype-db-cache
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - emptyDir: {}
              name: services
            - name: grype-db
              persistentVolumeClaim:
                claimName: kubescape-kubevuln
  41: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
      ingress:
        - from:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: operator
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
          ports:
            - port: 8080
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: kubevuln
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
        - Egress
  42: |
    apiVersion: v1
    kind: PersistentVolumeClaim
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-kubevuln
      namespace: kubescape
    spec:
      accessModes:
        - ReadWriteOnce
      resources:
        requests:
          storage: 5Gi
  43: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln-scc
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:openshift:scc:nonroot-v2
    subjects:
      - kind: ServiceAccount
        name: kubevuln
        namespace: kubescape
  44: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
    spec:
      ports:
        - port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  45: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
  46: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
    rules:
      - apiGroups:
          - ""
        resources:
          - nodes
          - nodes/proxy
          - services
          - endpoints
          - namespaces
          - configmaps
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - pods
        verbs:
          - get
          - watch
          - list
          - delete
      - apiGroups:
          - ""
        resources:
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - deployments
          - daemonsets
          - statefulsets
          - replicasets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - applicationprofiles
          - networkneighborhoods
          - seccompprofiles
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - containerprofiles
          - sbomsyfts
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - runtimerulealertbindings
        verbs:
          - list
          - watch
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands/status
        verbs:
          - get
          - watch
          - list
          - update
          - patch
      - apiGroups:
          - events.k8s.io
        resources:
          - events
        verbs:
          - create
          - patch
          - get
  47: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: node-agent
    subjects:
      - kind: ServiceAccount
        name: node-agent
        namespace: kubescape
  48: |
    apiVersion: v1
    data:
      config.json: |
        {
            "applicationProfileServiceEnabled": true,
            "prometheusExporterEnabled": false,
            "runtimeDetectionEnabled": true,
            "httpDetectionEnabled": true,
            "networkServiceEnabled": true,
            "malwareDetectionEnabled": true,
            "hostMalwareSensorEnabled": false,
            "hostNetworkSensorEnabled": false,
            "nodeProfileServiceEnabled": true,
            "networkStreamingEnabled": true,
            "maxImageSize": 5.36870912e+09,
            "maxSBOMSize": 2.097152e+07,
            "sbomGenerationEnabled": true,
            "enableEmbeddedSBOMs": true,
            "seccompServiceEnabled": true,
            "auditDetectionEnabled": true,
            "auditDetection": {
              "exporters": {"stdoutExporter":true},
              "eventFilter": {
                "includeTypes": [1300,1302,1309,1307,1317,1007,1327,1303,1324,1306,1404,1326]
              }
            },
            "initialDelay": "2m",
            "updateDataPeriod": "10m",
            "nodeProfileInterval": "10m",
            "networkStreamingInterval": "2m",
            "maxSniffingTimePerContainer": "24h",
            "includeNamespaces": "my-namespace",
            "excludeLabels":{"baz":["qux"],"foo":["bar","baz"]},
            "exporters": {
              "httpExporterConfig":{"maxAlertsPerMinute":1000,"method":"POST","url":"http://synchronizer:8089/apis/v1/kubescape.io"},
              "alertManagerExporterUrls":[],
              "stdoutExporter":true,
              "syslogExporterURL": ""
            },
            "excludeJsonPaths":[".containers[*].env[?(@.name==\"KUBECONFIG\")]"],
            "ruleCooldown": {
                "ruleCooldownDuration": "1h",
                "ruleCooldownAfterCount": 1,
                "ruleCooldownOnProfileFailure": true,
                "ruleCooldownMaxSize": 20000
            }
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
  49: |
    apiVersion: v1
    data:
      clamd.conf: |-
        Foreground yes
        User root
        Debug no
        LeaveTemporaryFiles no
        LogTime no
        LogClean no
        LogVerbose no
        LocalSocket /run/clamav/clamd.sock
        LocalSocketGroup clamav
        LocalSocketMode 660
        MaxDirectoryRecursion 20
        ExtendedDetectionInfo yes
      freshclam.conf: |-
        Foreground yes
        DatabaseDirectory /var/lib/clamav
        UpdateLogFile /dev/stdout
        Debug no
        LogFileMaxSize 0
        LogTime yes
        DatabaseOwner root
        DNSDatabaseInfo current.cvd.clamav.net
        DatabaseMirror database.clamav.net
        MaxAttempts 3
        ScriptedUpdates no
        CompressLocalDatabase no
        TestDatabases yes
        Checks 0
        ConnectTimeout 30
        ReceiveTimeout 60
    kind: ConfigMap
    metadata:
      name: clamav
      namespace: kubescape
  50: |
    apiVersion: apps/v1
    kind: DaemonSet
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: node-agent-1
      namespace: kubescape
    spec:
      selector:
        matchLabels:
          app.kubernetes.io/component: node-agent
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      template:
        metadata:
          annotations:
            checksum/cloud-config: aaeeb6b6b35a5ebbb0893822c4bf9cd860fba6d3df3bc4e77c8dbdd5841db120
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/node-agent-config: cae7f9a81d9a00201e96f02ecd6bbd99c3a9e083e2e91c4bdaa4db28f40d8d6b
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
          labels:
            app: node-agent
            app.kubernetes.io/component: node-agent
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            cloud.google.com/matching-allowlist: armo-kubescape-node-agent-1.27
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity:
            nodeAffinity:
              requiredDuringSchedulingIgnoredDuringExecution:
                nodeSelectorTerms:
                  - matchExpressions:
                      - key: kubernetes.io/os
                        operator: In
                        values:
                          - linux
          automountServiceAccountToken: true
          containers:
            - image: quay.io/kubescape/klamav:1.3.1-34_alpha
              imagePullPolicy: IfNotPresent
              name: clamav
              resources:
                limits:
                  cpu: 300m
                  memory: 512Mi
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                capabilities:
                  add:
                    - SYS_PTRACE
                runAsUser: 0
              volumeMounts:
                - mountPath: /var/lib/clamav-tmp
                  name: clamdb
                - mountPath: /run/clamav
                  name: clamrun
                - mountPath: /etc/clamav
                  name: etc
                  readOnly: true
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: HOST_ROOT
                  value: /host
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
                - name: CLAMAV_SOCKET
                  value: /clamav/clamd.sock
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
                - name: SKIP_KERNEL_VERSION_CHECK
                  value: "true"
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
                - name: NAMESPACE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: KUBELET_ROOT
                  value: /var/lib/kubelet
                - name: NodeName
              image: quay.io/benarmosec/node-agent:test-v1
              imagePullPolicy: Always
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 7888
                initialDelaySeconds: 60
                periodSeconds: 3
              name: node-agent
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 7888
                initialDelaySeconds: 3
                periodSeconds: 3
              resources:
                limits:
                  cpu: 400m
                  memory: 512Mi
                requests:
                  cpu: 300m
                  memory: 128Mi
              securityContext:
                capabilities:
                  add:
                    - SYS_ADMIN
                    - SYS_PTRACE
                    - NET_ADMIN
                    - SYSLOG
                    - SYS_RESOURCE
                    - IPC_LOCK
                    - NET_RAW
                privileged: false
                runAsUser: 0
                seLinuxOptions:
                  type: spc_t
              volumeMounts:
                - mountPath: /host
                  name: host
                  readOnly: true
                - mountPath: /var/lib/kubelet
                  name: kubeletdir
                - mountPath: /run
                  name: run
                - mountPath: /var
                  name: var
                  readOnly: true
                - mountPath: /lib/modules
                  name: modules
                  readOnly: true
                - mountPath: /sys/kernel/debug
                  name: debugfs
                - mountPath: /sys/fs/cgroup
                  name: cgroup
                  readOnly: true
                - mountPath: /sys/fs/bpf
                  name: bpffs
                - mountPath: /data
                  name: data
                - mountPath: /profiles
                  name: profiles
                - mountPath: /boot
                  name: boot
                  readOnly: true
                - mountPath: /clamav
                  name: clamrun
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  readOnly: true
                  subPath: proxy.crt
                - mountPath: /etc/ssl/certs/ca-certificates.crt
                  name: custom-ca-certificates
                  readOnly: true
                  subPath: ca-certificates.crt
          hostPID: true
          imagePullSecrets:
            - name: foo
            - name: bar
          nodeSelector:
            doks.digitalocean.com/node-pool: pool-1
            kubernetes.io/os: linux
          priorityClassName: kubescape-critical
          securityContext:
            appArmorProfile:
              type: Unconfined
          serviceAccountName: node-agent
          tolerations: null
          volumes:
            - hostPath:
                path: /
              name: host
            - hostPath:
                path: /var/lib/kubelet
              name: kubeletdir
            - hostPath:
                path: /run
              name: run
            - hostPath:
                path: /var
              name: var
            - hostPath:
                path: /sys/fs/cgroup
              name: cgroup
            - hostPath:
                path: /lib/modules
              name: modules
            - hostPath:
                path: /sys/fs/bpf
              name: bpffs
            - hostPath:
                path: /sys/kernel/debug
              name: debugfs
            - hostPath:
                path: /boot
              name: boot
            - emptyDir: null
              name: data
            - emptyDir: null
              name: profiles
            - emptyDir: {}
              name: clamdb
            - emptyDir: {}
              name: clamrun
            - configMap:
                items:
                  - key: clamd.conf
                    path: clamd.conf
                  - key: freshclam.conf
                    path: freshclam.conf
                name: clamav
              name: etc
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: node-agent
              name: config
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: custom-ca-certificates
              secret:
                secretName: custom-ca-certificates
  51: |
    apiVersion: apps/v1
    kind: DaemonSet
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: node-agent-2
      namespace: kubescape
    spec:
      selector:
        matchLabels:
          app.kubernetes.io/component: node-agent
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      template:
        metadata:
          annotations:
            checksum/cloud-config: aaeeb6b6b35a5ebbb0893822c4bf9cd860fba6d3df3bc4e77c8dbdd5841db120
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/node-agent-config: cae7f9a81d9a00201e96f02ecd6bbd99c3a9e083e2e91c4bdaa4db28f40d8d6b
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
          labels:
            app: node-agent
            app.kubernetes.io/component: node-agent
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            cloud.google.com/matching-allowlist: armo-kubescape-node-agent-1.27
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity:
            nodeAffinity:
              requiredDuringSchedulingIgnoredDuringExecution:
                nodeSelectorTerms:
                  - matchExpressions:
                      - key: kubernetes.io/os
                        operator: In
                        values:
                          - linux
          automountServiceAccountToken: true
          containers:
            - image: quay.io/kubescape/klamav:1.3.1-34_alpha
              imagePullPolicy: IfNotPresent
              name: clamav
              resources:
                limits:
                  cpu: 300m
                  memory: 512Mi
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                capabilities:
                  add:
                    - SYS_PTRACE
                runAsUser: 0
              volumeMounts:
                - mountPath: /var/lib/clamav-tmp
                  name: clamdb
                - mountPath: /run/clamav
                  name: clamrun
                - mountPath: /etc/clamav
                  name: etc
                  readOnly: true
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: HOST_ROOT
                  value: /host
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
                - name: CLAMAV_SOCKET
                  value: /clamav/clamd.sock
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
                - name: SKIP_KERNEL_VERSION_CHECK
                  value: "true"
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
                - name: NAMESPACE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: KUBELET_ROOT
                  value: /var/lib/kubelet
                - name: NodeName
              image: quay.io/benarmosec/node-agent:test-v1
              imagePullPolicy: Always
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 7888
                initialDelaySeconds: 60
                periodSeconds: 3
              name: node-agent
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 7888
                initialDelaySeconds: 3
                periodSeconds: 3
              resources:
                limits:
                  cpu: 200m
                  memory: 512Mi
                requests:
                  cpu: 100m
                  memory: 256Mi
              securityContext:
                capabilities:
                  add:
                    - SYS_ADMIN
                    - SYS_PTRACE
                    - NET_ADMIN
                    - SYSLOG
                    - SYS_RESOURCE
                    - IPC_LOCK
                    - NET_RAW
                privileged: false
                runAsUser: 0
                seLinuxOptions:
                  type: spc_t
              volumeMounts:
                - mountPath: /host
                  name: host
                  readOnly: true
                - mountPath: /var/lib/kubelet
                  name: kubeletdir
                - mountPath: /run
                  name: run
                - mountPath: /var
                  name: var
                  readOnly: true
                - mountPath: /lib/modules
                  name: modules
                  readOnly: true
                - mountPath: /sys/kernel/debug
                  name: debugfs
                - mountPath: /sys/fs/cgroup
                  name: cgroup
                  readOnly: true
                - mountPath: /sys/fs/bpf
                  name: bpffs
                - mountPath: /data
                  name: data
                - mountPath: /profiles
                  name: profiles
                - mountPath: /boot
                  name: boot
                  readOnly: true
                - mountPath: /clamav
                  name: clamrun
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  readOnly: true
                  subPath: proxy.crt
                - mountPath: /etc/ssl/certs/ca-certificates.crt
                  name: custom-ca-certificates
                  readOnly: true
                  subPath: ca-certificates.crt
          hostPID: true
          imagePullSecrets:
            - name: foo
            - name: bar
          nodeSelector:
            doks.digitalocean.com/node-pool: pool-2
            kubernetes.io/os: linux
          priorityClassName: kubescape-critical
          securityContext:
            appArmorProfile:
              type: Unconfined
          serviceAccountName: node-agent
          tolerations: null
          volumes:
            - hostPath:
                path: /
              name: host
            - hostPath:
                path: /var/lib/kubelet
              name: kubeletdir
            - hostPath:
                path: /run
              name: run
            - hostPath:
                path: /var
              name: var
            - hostPath:
                path: /sys/fs/cgroup
              name: cgroup
            - hostPath:
                path: /lib/modules
              name: modules
            - hostPath:
                path: /sys/fs/bpf
              name: bpffs
            - hostPath:
                path: /sys/kernel/debug
              name: debugfs
            - hostPath:
                path: /boot
              name: boot
            - emptyDir: null
              name: data
            - emptyDir: null
              name: profiles
            - emptyDir: {}
              name: clamdb
            - emptyDir: {}
              name: clamrun
            - configMap:
                items:
                  - key: clamd.conf
                    path: clamd.conf
                  - key: freshclam.conf
                    path: freshclam.conf
                name: clamav
              name: etc
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: node-agent
              name: config
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: custom-ca-certificates
              secret:
                secretName: custom-ca-certificates
  52: |
    apiVersion: kubescape.io/v1
    kind: RuntimeRuleAlertBinding
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: all-rules-all-pods
    spec:
      namespaceSelector:
        matchExpressions:
          - key: kubernetes.io/metadata.name
            operator: In
            values:
              - my-namespace
      rules:
        - ruleName: Unexpected process launched
        - parameters:
            ignoreMounts: true
            ignorePrefixes:
              - /proc
              - /run/secrets/kubernetes.io/serviceaccount
              - /var/run/secrets/kubernetes.io/serviceaccount
              - /tmp
            includePrefixes:
              - /etc
              - /var/spool/cron/
              - /var/log/
              - /var/run/
              - /dev/shm/
              - /run/
              - /var/www/
              - /var/lib/docker/
              - /opt/
              - /usr/local/
              - /app/
              - /.dockerenv
              - /proc/self/environ
              - /var/lib/kubelet/
              - /etc/cni/net.d/
              - /var/run/secrets/kubernetes.io/
              - /var/run/secrets/kubernetes.io/serviceaccount/
              - /run/containerd/
              - /run/flannel/
              - /run/calico/
          ruleName: Unexpected file access
        - ruleName: Unexpected system call
        - ruleName: Unexpected capability used
        - ruleName: Unexpected domain request
        - ruleName: Unexpected Service Account Token Access
        - ruleName: Kubernetes Client Executed
        - ruleName: Exec from malicious source
        - ruleName: Kernel Module Load
        - ruleName: Exec Binary Not In Base Image
        - ruleName: Fileless Execution
        - ruleName: XMR Crypto Mining Detection
        - ruleName: Exec from mount
        - ruleName: Crypto Mining Related Port Communication
        - ruleName: Crypto Mining Domain Communication
        - ruleName: Read Environment Variables from procfs
        - ruleName: eBPF Program Load
        - ruleName: Symlink Created Over Sensitive File
        - ruleName: Unexpected Sensitive File Access
        - ruleName: Hardlink Created Over Sensitive File
        - ruleName: Exec to pod
        - ruleName: Port forward
        - ruleName: Malicious Ptrace Usage
        - ruleName: Cross-Site Scripting (XSS) Attempt
        - ruleName: SQL Injection Attempt
        - ruleName: Server-Side Request Forgery Attack Attempt
        - ruleName: Remote File Inclusion Attack Attempt
        - ruleName: Local File Inclusion Attempt
        - ruleName: XML External Entity Attack Attempt
        - ruleName: Server-Side Template Injection Attack
        - ruleName: Command Injection Attempt
        - ruleName: Unexpected Exec Source
        - ruleName: Unexpected Open Source
        - ruleName: Unexpected Symlink Source
        - ruleName: Unexpected Hardlink Source
        - ruleName: Unexpected io_uring Operation Detected
        - ruleName: ReDoS Attack
        - ruleName: Prototype Pollution Attack
        - ruleName: Execution of base64 Encoded Command
        - ruleName: Execution of interpreter command
        - ruleName: Code Sharing Site Access
        - ruleName: Web Application File Write Access
        - ruleName: Cron Job File Created or Modified
        - ruleName: Hidden File Created
        - ruleName: Reverse Shell Patterens Detected
        - ruleName: Unauthorized IMDS Connection Attempt
        - ruleName: Credentials Detection Attempts
        - ruleName: HTTP Request Smuggling Attempt
        - ruleName: P2P Tracker Connection Created
  53: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: default
              podSelector:
                matchLabels:
                  component: apiserver
                  provider: kubernetes
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
      podSelector:
        matchLabels:
          app.kubernetes.io/component: node-agent
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Egress
  54: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent-scc
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:openshift:scc:privileged
    subjects:
      - kind: ServiceAccount
        name: node-agent
        namespace: kubescape
  55: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      ports:
        - name: prometheus
          port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
  56: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
  57: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-admission-webhook
      namespace: kubescape
    spec:
      ports:
        - port: 443
          targetPort: 8443
      selector:
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  58: |
    apiVersion: v1
    data:
      tls.crt: bW9jay1jZXJ0LWNlcnQ=
      tls.key: bW9jay1jZXJ0LWtleQ==
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-admission-webhook.kubescape.svc-kubescape-tls-pair
      namespace: kubescape
    type: kubernetes.io/tls
  59: |
    apiVersion: admissionregistration.k8s.io/v1
    kind: ValidatingWebhookConfiguration
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: validation
    webhooks:
      - admissionReviewVersions:
          - v1
        clientConfig:
          caBundle: bW9jay1jYS1jZXJ0
          service:
            name: kubescape-admission-webhook
            namespace: kubescape
            path: /validate
            port: 443
        failurePolicy: Ignore
        name: validation.kubescape.admission
        rules:
          - apiGroups:
              - '*'
            apiVersions:
              - v1
            operations:
              - CREATE
              - UPDATE
              - DELETE
              - CONNECT
            resources:
              - pods
              - pods/exec
              - pods/portforward
              - pods/attach
              - clusterrolebindings
              - rolebindings
            scope: '*'
        sideEffects: None
  60: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
    rules:
      - apiGroups:
          - ""
        resources:
          - pods
          - nodes
          - namespaces
          - configmaps
          - services
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - secrets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - delete
          - patch
      - apiGroups:
          - apps
        resources:
          - deployments
          - daemonsets
          - statefulsets
          - replicasets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - vulnerabilitymanifests
          - vulnerabilitymanifestsummaries
          - workloadconfigurationscans
          - workloadconfigurationscansummaries
          - openvulnerabilityexchangecontainers
          - containerprofiles
          - sbomsyfts
        verbs:
          - get
          - watch
          - list
          - delete
      - apiGroups:
          - kubescape.io
        resources:
          - runtimerulealertbindings
        verbs:
          - list
          - watch
          - get
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - delete
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands/status
        verbs:
          - get
          - watch
          - list
          - update
          - patch
  61: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: operator
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  62: |
    apiVersion: v1
    data:
      config.json: |
        {
          "includeNamespaces": "my-namespace",
          "namespace": "kubescape",
          "triggersecurityframework": true,
          "podScanGuardTime": "1h",
          "excludeJsonPaths":[".containers[*].env[?(@.name==\"KUBECONFIG\")]"],
          "httpExporterConfig":{"maxAlertsPerMinute":1000,"method":"POST","url":"http://synchronizer:8089/apis/v1/kubescape.io"}
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: operator
      namespace: kubescape
  63: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: operator
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          annotations:
            checksum/capabilities-config: e2505a6ee27b9f0c24db0a3803432019abf578f2877aeb5a78c7750a481d5b78
            checksum/cloud-config: aaeeb6b6b35a5ebbb0893822c4bf9cd860fba6d3df3bc4e77c8dbdd5841db120
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/matching-rules-config: c81857b415602f6b161db3199a16461c5acd8ba44ec7572189441f4f294a3614
            checksum/operator-config: a95183e6cda13e32fef088ea6e42d801059e551051281413c349d57f1e70dfc5
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
          labels:
            app: operator
            app.kubernetes.io/component: operator
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - env:
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: HELM_RELEASE
                  value: kubescape-operator-1.29.9
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
              image: quay.io/kubescape/operator:v0.2.109
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /v1/liveness
                  port: readiness-port
                initialDelaySeconds: 3
                periodSeconds: 3
              name: operator
              ports:
                - containerPort: 4002
                  name: trigger-port
                  protocol: TCP
                - containerPort: 8000
                  name: readiness-port
                  protocol: TCP
                - containerPort: 8443
                  name: admission-port
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /v1/readiness
                  port: readiness-port
                initialDelaySeconds: 10
                periodSeconds: 5
              resources:
                limits:
                  cpu: 300m
                  memory: 300Mi
                requests:
                  cpu: 50m
                  memory: 100Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /tmp
                  name: tmp-dir
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/capabilities.json
                  name: ks-capabilities
                  readOnly: true
                  subPath: capabilities.json
                - mountPath: /etc/config/matchingRules.json
                  name: cs-matching-rules
                  readOnly: true
                  subPath: matchingRules.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/ssl/certs/ca-certificates.crt
                  name: custom-ca-certificates
                  subPath: ca-certificates.crt
                - mountPath: /etc/certs
                  name: tls-certs
                  readOnly: true
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
          imagePullSecrets:
            - name: foo
            - name: bar
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: operator
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: custom-ca-certificates
              secret:
                secretName: custom-ca-certificates
            - name: tls-certs
              secret:
                secretName: kubescape-admission-webhook.kubescape.svc-kubescape-tls-pair
            - emptyDir: {}
              name: tmp-dir
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: capabilities
                    path: capabilities.json
                name: ks-capabilities
              name: ks-capabilities
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: operator
              name: config
            - configMap:
                items:
                  - key: matchingRules.json
                    path: matchingRules.json
                name: cs-matching-rules
              name: cs-matching-rules
  64: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: kubescape-scheduler
          namespace: kubescape
          labels:
            app: kubescape-scheduler
            tier: ks-control-plane
            kubescape.io/tier: "core"
            armo.tier: "kubescape-scan"
        spec:
          schedule: "1 2 3 4 5"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "kubescape-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  imagePullSecrets:
                  - name: foo
                  - name: bar
                  containers:
                  - name: kubescape-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubescape
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: kubescape-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-cronjob-template
      namespace: kubescape
  65: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: kubevuln-scheduler
          namespace: kubescape
          labels:
            app: kubevuln-scheduler
            tier: ks-control-plane
            kubescape.io/tier: "core"
            armo.tier: "vuln-scan"
        spec:
          schedule: "1 2 3 4 5"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "vuln-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  imagePullSecrets:
                  - name: foo
                  - name: bar
                  containers:
                  - name: kubevuln-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubevuln
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: kubevuln-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-cronjob-template
      namespace: kubescape
  66: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
        - ports:
            - port: 80
              protocol: TCP
          to:
            - ipBlock:
                cidr: 169.254.169.254/32
        - ports:
            - port: 8080
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: kubescape
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 8080
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: kubevuln
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 443
              protocol: TCP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: default
              podSelector:
                matchLabels:
                  component: apiserver
                  provider: kubernetes
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
      ingress:
        - ports:
            - port: admission-port
              protocol: TCP
        - from:
            - podSelector:
                matchLabels:
                  armo.tier: kubescape-scan
            - podSelector:
                matchLabels:
                  armo.tier: vuln-scan
          ports:
            - port: trigger-port
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: operator
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
        - Egress
  67: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: registry-scheduler
          namespace: kubescape
          labels:
            app: registry-scheduler
            kubescape.io/tier: "core"
            tier: ks-control-plane
            armo.tier: "registry-scan"
        spec:
          schedule: "0 0 * * *"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "registry-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  imagePullSecrets:
                  - name: foo
                  - name: bar
                  containers:
                  - name: registry-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubevuln
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: registry-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: registry-scan-cronjob-template
      namespace: kubescape
  68: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - configmaps
          - secrets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
      - apiGroups:
          - batch
        resources:
          - cronjobs
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  69: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: operator
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  70: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator-scc
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:openshift:scc:nonroot-v2
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  71: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      ports:
        - port: 4002
          protocol: TCP
          targetPort: 4002
      selector:
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  72: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
  73: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      labels:
        app: prometheus-exporter
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: prometheus-exporter
    rules:
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - configurationscansummaries
          - vulnerabilitysummaries
          - workloadconfigurationscansummaries
          - vulnerabilitymanifestsummaries
        verbs:
          - get
          - watch
          - list
  74: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      labels:
        app: prometheus-exporter
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: prometheus-exporter
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: prometheus-exporter
    subjects:
      - kind: ServiceAccount
        name: prometheus-exporter
        namespace: kubescape
  75: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: prometheus-exporter
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: prometheus-exporter
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: prometheus-exporter
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations: null
          labels:
            app: prometheus-exporter
            app.kubernetes.io/component: prometheus-exporter
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: ENABLE_WORKLOAD_METRICS
                  value: "true"
              image: quay.io/kubescape/prometheus-exporter:v0.2.7
              imagePullPolicy: IfNotPresent
              livenessProbe:
                initialDelaySeconds: 3
                periodSeconds: 3
                tcpSocket:
                  port: 8080
              name: prometheus-exporter
              ports:
                - containerPort: 8080
                  name: metrics
                  protocol: TCP
              readinessProbe:
                tcpSocket:
                  port: 8080
              resources:
                limits:
                  cpu: 50m
                  memory: 100Mi
                requests:
                  cpu: 10m
                  memory: 10Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/config
                  name: ks-cloud-config
                  readOnly: true
          imagePullSecrets:
            - name: foo
            - name: bar
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: prometheus-exporter
          tolerations: null
          volumes:
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
  76: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      labels:
        app: prometheus-exporter
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: prometheus-exporter
      namespace: kubescape
    spec:
      ingress:
        - ports:
            - port: 8080
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: prometheus-exporter
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
  77: |
    apiVersion: v1
    kind: Service
    metadata:
      labels:
        app: prometheus-exporter
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: prometheus-exporter
      namespace: kubescape
    spec:
      ports:
        - port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: null
  78: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      labels:
        app: prometheus-exporter
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: prometheus-exporter
      namespace: kubescape
  79: |
    apiVersion: monitoring.coreos.com/v1
    kind: ServiceMonitor
    metadata:
      annotations: null
      labels:
        app: prometheus-exporter
        app.kubernetes.io/component: prometheus-exporter
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: prometheus-exporter
      namespace: kubescape
    spec:
      endpoints:
        - interval: 60s
          path: /metrics
          targetPort: 8080
      namespaceSelector:
        matchNames:
          - kubescape
      selector:
        matchLabels:
          app.kubernetes.io/component: prometheus-exporter
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
  80: |
    apiVersion: v1
    data:
      proxy.crt: foo
    kind: Secret
    metadata:
      annotations:
        helm.sh/hook: pre-install,pre-upgrade
        helm.sh/hook-delete-policy: before-hook-creation
        helm.sh/hook-weight: "0"
      labels:
        app: kubescape-proxy-certificate
        app.kubernetes.io/component: kubescape-proxy-certificate
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-proxy-certificate
      namespace: kubescape
    type: Opaque
  81: |
    apiVersion: apiregistration.k8s.io/v1
    kind: APIService
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: v1beta1.spdx.softwarecomposition.kubescape.io
    spec:
      group: spdx.softwarecomposition.kubescape.io
      groupPriorityMinimum: 1000
      insecureSkipTLSVerify: true
      service:
        name: storage
        namespace: kubescape
      version: v1beta1
      versionPriority: 15
  82: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
    rules:
      - apiGroups:
          - ""
        resources:
          - namespaces
          - pods
          - services
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - admissionregistration.k8s.io
        resources:
          - mutatingwebhookconfigurations
          - validatingwebhookconfigurations
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - daemonsets
          - deployments
          - replicasets
          - statefulsets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - cronjobs
          - jobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - flowcontrol.apiserver.k8s.io
        resources:
          - prioritylevelconfigurations
          - flowschemas
        verbs:
          - get
          - watch
          - list
  83: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage:system:auth-delegator
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:auth-delegator
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  84: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: storage
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  85: |
    apiVersion: v1
    data:
      config.json: |
        {
          "cleanupInterval": "6h",
          "disableVirtualCRDs": false,
          "excludeJsonPaths": [".containers[*].env[?(@.name==\"KUBECONFIG\")]"],
          "defaultQueueLength": 100,
          "defaultWorkerCount": 2,
          "defaultMaxObjectSize": 400000,
          "queueManagerEnabled": true,
          "kindQueues": {"applicationprofiles":{"maxObjectSize":20000000,"queueLength":50,"workerCount":2},"containerprofiles":{"maxObjectSize":2500000,"queueLength":50,"workerCount":2},"networkneighborhoods":{"maxObjectSize":10000000,"queueLength":50,"workerCount":2},"openvulnerabilityexchangecontainers":{"maxObjectSize":500000,"queueLength":50,"workerCount":1},"sbomsyftfiltereds":{"maxObjectSize":50000000,"queueLength":50,"workerCount":1},"sbomsyfts":{"maxObjectSize":100000000,"queueLength":50,"workerCount":1},"vulnerabilitymanifests":{"maxObjectSize":50000000,"queueLength":50,"workerCount":1}},
          "serverBindPort": "8443"
        }
    kind: ConfigMap
    metadata:
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: storage
      namespace: kubescape
  86: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: storage
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations: null
          labels:
            app: storage
            app.kubernetes.io/component: storage
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          containers:
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
              image: quay.io/kubescape/storage:v0.0.220
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 8443
                  scheme: HTTPS
              name: apiserver
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 8443
                  scheme: HTTPS
              resources:
                limits:
                  cpu: 1500m
                  memory: 1500Mi
                requests:
                  cpu: 100m
                  memory: 400Mi
              securityContext:
                allowPrivilegeEscalation: false
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: data
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
          imagePullSecrets:
            - name: foo
            - name: bar
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: storage
          tolerations: null
          volumes:
            - name: data
              persistentVolumeClaim:
                claimName: kubescape-storage
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: storage
              name: config
  87: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: default
              podSelector:
                matchLabels:
                  component: apiserver
                  provider: kubernetes
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
      podSelector:
        matchLabels:
          app.kubernetes.io/component: storage
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Egress
  88: |
    apiVersion: v1
    kind: PersistentVolumeClaim
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-storage
      namespace: kubescape
    spec:
      accessModes:
        - ReadWriteOnce
      resources:
        requests:
          storage: 5Gi
  89: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage-auth-reader
      namespace: kube-system
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: extension-apiserver-authentication-reader
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  90: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage-scc
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:openshift:scc:nonroot-v2
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  91: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      ports:
        - name: https
          port: 443
          protocol: TCP
          targetPort: 8443
      selector:
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
  92: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
  93: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
    rules:
      - apiGroups:
          - storage.k8s.io
        resources:
          - storageclasses
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - rbac.authorization.k8s.io
        resources:
          - rolebindings
          - clusterrolebindings
          - roles
          - clusterroles
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - ""
        resources:
          - pods
          - namespaces
          - nodes
          - configmaps
          - persistentvolumes
          - services
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - apps
        resources:
          - deployments
          - statefulsets
          - daemonsets
          - replicasets
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - networking.k8s.io
        resources:
          - networkpolicies
          - ingresses
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - applicationprofiles
          - networkneighborhoods
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - patch
          - delete
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - knownservers
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - patch
          - delete
      - apiGroups:
          - cilium.io
        resources:
          - ciliumnetworkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - projectcalico.org
        resources:
          - networkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - networking.istio.io
        resources:
          - gateways
          - virtualservices
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - security.istio.io
        resources:
          - authorizationpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - gateway.networking.k8s.io
        resources:
          - httproutes
          - tcproutes
          - udproutes
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - patch
          - delete
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - sbomsyfts
          - sbomsyftfiltereds
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - seccompprofiles
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - patch
      - apiGroups:
          - networking.k8s.io
        resources:
          - networkpolicies
        verbs:
          - create
          - update
          - patch
      - apiGroups:
          - cilium.io
        resources:
          - ciliumnetworkpolicies
        verbs:
          - create
          - update
          - patch
      - apiGroups:
          - projectcalico.org
        resources:
          - networkpolicies
        verbs:
          - create
          - update
          - patch
      - apiGroups:
          - apps
        resources:
          - deployments
          - statefulsets
          - daemonsets
          - replicasets
        verbs:
          - update
          - patch
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - update
          - patch
      - apiGroups:
          - ""
        resources:
          - pods
        verbs:
          - update
          - patch
  94: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: synchronizer
    subjects:
      - kind: ServiceAccount
        name: synchronizer
        namespace: kubescape
  95: |
    apiVersion: v1
    data:
      config.json: |
        {
          "inCluster": {
            "includeNamespaces": "my-namespace",
            "resources": [
              {
                "group": "",
                "version": "v1",
                "resource": "services",
                "strategy": "patch"
              },
              {
                "group": "networking.k8s.io",
                "version": "v1",
                "resource": "ingresses",
                "strategy": "patch"
              },
              {
                "group": "gateway.networking.k8s.io",
                "version": "v1",
                "resource": "httproutes",
                "strategy": "patch"
              },
              {
                "group": "gateway.networking.k8s.io",
                "version": "v1",
                "resource": "tcproutes",
                "strategy": "patch"
              },
              {
                "group": "gateway.networking.k8s.io",
                "version": "v1",
                "resource": "udproutes",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "rolebindings",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "clusterrolebindings",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "clusterroles",
                "strategy": "patch"
              },
              {
                "group": "rbac.authorization.k8s.io",
                "version": "v1",
                "resource": "roles",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "persistentvolumes",
                "strategy": "patch"
              },
              {
                "group": "storage.k8s.io",
                "version": "v1",
                "resource": "storageclasses",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "deployments",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "statefulsets",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "daemonsets",
                "strategy": "patch"
              },
              {
                "group": "apps",
                "version": "v1",
                "resource": "replicasets",
                "strategy": "patch"
              },
              {
                "group": "batch",
                "version": "v1",
                "resource": "jobs",
                "strategy": "patch"
              },
              {
                "group": "batch",
                "version": "v1",
                "resource": "cronjobs",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "pods",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "namespaces",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "nodes",
                "strategy": "patch"
              },
              {
                "group": "",
                "version": "v1",
                "resource": "configmaps",
                "strategy": "patch"
              },
              {
                "group": "networking.k8s.io",
                "version": "v1",
                "resource": "networkpolicies",
                "strategy": "patch"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "applicationprofiles",
                "strategy": "copy"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "knownservers",
                "strategy": "copy"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "networkneighborhoods",
                "strategy": "copy"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "sbomsyfts",
                "strategy": "copy"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "sbomsyftfiltereds",
                "strategy": "copy"
              },
              {
                "group": "spdx.softwarecomposition.kubescape.io",
                "version": "v1beta1",
                "resource": "seccompprofiles",
                "strategy": "copy"
              },
              {
                "group": "cilium.io",
                "version": "v2",
                "resource": "ciliumnetworkpolicies",
                "strategy": "patch"
              },
              {
                "group": "projectcalico.org",
                "version": "v3",
                "resource": "networkpolicies",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1",
                "resource": "gateways",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1",
                "resource": "virtualservices",
                "strategy": "patch"
              },
              {
                "group": "security.istio.io",
                "version": "v1",
                "resource": "authorizationpolicies",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1beta1",
                "resource": "gateways",
                "strategy": "patch"
              },
              {
                "group": "networking.istio.io",
                "version": "v1beta1",
                "resource": "virtualservices",
                "strategy": "patch"
              },
              {
                "group": "security.istio.io",
                "version": "v1beta1",
                "resource": "authorizationpolicies",
                "strategy": "patch"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "servicesscanresults",
                "strategy": "patch"
              },
              {
                "group": "kubescape.io",
                "version": "v1alpha1",
                "resource": "operatorcommands",
                "strategy": "copy"
              }
            ]
          },
          "httpEndpoint": {
            "serverPort": "8089",
            "resources": [
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "networkstreams",
                "strategy": "copy"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "nodeprofiles",
                "strategy": "copy"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "runtimealerts",
                "strategy": "copy"
              },
              {
                "group": "kubescape.io",
                "version": "v1",
                "resource": "registrystatuses",
                "strategy": "copy"
              }
            ]
          }
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
  96: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: synchronizer
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations:
            checksum/cloud-config: aaeeb6b6b35a5ebbb0893822c4bf9cd860fba6d3df3bc4e77c8dbdd5841db120
            checksum/cloud-secret: 435193bc039d949c849ba4b141adeb4836e4d0fdcc4bf0b9588d0e36de86c424
            checksum/proxy-config: c03b6781aa61faaacfa84a96809236591dde0cbd43a204e05d5ba3044bb9d5d8
            checksum/synchronizer-configmap: df8fee4a6080fe9af89f3fa7c40b9f8dd98a7080c0ef7de7ce0eb07ac8ac1408
          labels:
            app: synchronizer
            app.kubernetes.io/component: synchronizer
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - command:
                - /usr/bin/client
              env:
                - name: HELM_RELEASE
                  value: kubescape-operator-1.29.9
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
              image: quay.io/kubescape/synchronizer:v0.0.116
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /healthz
                  port: 7888
                initialDelaySeconds: 10
                periodSeconds: 30
                timeoutSeconds: 10
              name: synchronizer
              resources:
                limits:
                  cpu: 200m
                  memory: 500Mi
                requests:
                  cpu: 100m
                  memory: 250Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/services.json
                  name: services
                  readOnly: true
                  subPath: services.json
                - mountPath: /etc/ssl/certs/ca-certificates.crt
                  name: custom-ca-certificates
                  subPath: ca-certificates.crt
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
          imagePullSecrets:
            - name: foo
            - name: bar
          initContainers:
            - args:
                - -method=get
                - -scheme=https
                - -host=api.armosec.io
                - -path=api/v2/servicediscovery
                - -path-output=/data/services.json
              env:
                - name: HTTPS_PROXY
                  value: https://foo:bar@baz:1234
                - name: no_proxy
                  value: kubescape,kubevuln,node-agent,operator,otel-collector,kubernetes.default.svc.*,127.0.0.1,*.foo,bar.baz
              image: quay.io/kubescape/http-request:v0.2.14
              imagePullPolicy: IfNotPresent
              name: url-discovery
              resources:
                limits:
                  cpu: 100m
                  memory: 50Mi
                requests:
                  cpu: 10m
                  memory: 10Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: services
                - mountPath: /etc/ssl/certs/proxy.crt
                  name: proxy-secret
                  subPath: proxy.crt
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: synchronizer
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - name: proxy-secret
              secret:
                secretName: kubescape-proxy-certificate
            - name: custom-ca-certificates
              secret:
                secretName: custom-ca-certificates
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - emptyDir: {}
              name: services
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: synchronizer
              name: config
  97: |
    apiVersion: networking.k8s.io/v1
    kind: NetworkPolicy
    metadata:
      annotations: null
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    spec:
      egress:
        - ports:
            - port: 443
              protocol: TCP
        - ports:
            - port: 443
              protocol: TCP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: default
              podSelector:
                matchLabels:
                  component: apiserver
                  provider: kubernetes
        - ports:
            - port: 53
              protocol: UDP
          to:
            - namespaceSelector:
                matchLabels:
                  kubernetes.io/metadata.name: kube-system
              podSelector:
                matchLabels:
                  k8s-app: kube-dns
        - ports:
            - port: 4317
              protocol: TCP
            - port: 4318
              protocol: TCP
          to:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: otel-collector
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
        - ports:
            - port: 1234
              protocol: TCP
          to:
            - ipBlock:
                cidr: 1.1.1.1/32
      ingress:
        - from:
            - podSelector:
                matchLabels:
                  app.kubernetes.io/component: node-agent
                  app.kubernetes.io/instance: RELEASE-NAME
                  app.kubernetes.io/name: kubescape-operator
          ports:
            - port: 8089
              protocol: TCP
      podSelector:
        matchLabels:
          app.kubernetes.io/component: synchronizer
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      policyTypes:
        - Ingress
        - Egress
  98: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - configmaps
          - secrets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
      - apiGroups:
          - batch
        resources:
          - cronjobs
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  99: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: synchronizer
    subjects:
      - kind: ServiceAccount
        name: synchronizer
        namespace: kubescape
  100: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer-scc
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:openshift:scc:nonroot-v2
    subjects:
      - kind: ServiceAccount
        name: synchronizer
        namespace: kubescape
  101: |
    apiVersion: v1
    kind: Service
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
    spec:
      ports:
        - port: 8089
          protocol: TCP
          targetPort: 8089
      selector:
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  102: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      labels:
        app: synchronizer
        app.kubernetes.io/component: synchronizer
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: synchronizer
      namespace: kubescape
relevancy only:
  1: |+
    raw: |+
      Thank you for installing kubescape-operator version 1.29.9.
      View your cluster's configuration scanning schedule:
      > kubectl -n kubescape get cj kubescape-scheduler -o=jsonpath='{.metadata.name}{"\t"}{.spec.schedule}{"\n"}'

      To change the schedule, set `.spec.schedule`:
      > kubectl -n kubescape edit cj kubescape-scheduler
      View your cluster's image scanning schedule:
      > kubectl -n kubescape get cj kubevuln-scheduler -o=jsonpath='{.metadata.name}{"\t"}{.spec.schedule}{"\n"}'

      To change the schedule, edit `.spec.schedule`:
      > kubectl -n kubescape edit cj kubevuln-scheduler

      View your image vulnerabilities scan summaries:
      > kubectl get vulnerabilitymanifestsummaries -A

      Detailed reports are also available:
      > kubectl get vulnerabilitymanifests -A



  2: |
    apiVersion: v1
    data:
      accessKey: ""
      account: ""
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: cloud-secret
        app.kubernetes.io/component: cloud-secret
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/infra: credentials
        tier: ks-control-plane
      name: cloud-secret
      namespace: kubescape
    type: Opaque
  3: |
    apiVersion: v1
    data:
      clusterData: |
        {
          "serviceDiscovery": false,
          "vulnScanURL": "kubevuln:8080",
          "kubevulnURL": "kubevuln:8080",
          "kubescapeURL": "kubescape:8080",
          "clusterName": "kind-kind",
          "storage": true,
          "relevantImageVulnerabilitiesEnabled": true,
          "namespace": "kubescape",
          "imageVulnerabilitiesScanningEnabled": true,
          "postureScanEnabled": true,
          "otelCollector": false,
          "nodeAgent": "true",
          "maxImageSize": 5.36870912e+09,
          "maxSBOMSize": 2.097152e+07,
          "keepLocal": true,
          "scanTimeout": "5m",
          "scanEmbeddedSBOMs": false,
          "vexGeneration": false,
          "useDefaultMatchers": false,
          "storeFilteredSbom": false,
          "continuousPostureScan": false,
          "relevantImageVulnerabilitiesConfiguration": "enable"
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/infra: config
        kubescape.io/tier: core
        tier: ks-control-plane
      name: ks-cloud-config
      namespace: kubescape
  4: |
    apiVersion: v1
    data:
      capabilities: |
        {
          "capabilities":{"admissionController":"disable","autoUpgrading":"disable","configurationScan":"enable","httpDetection":"disable","kubescapeOffline":"disable","linuxAudit":"enable","malwareDetection":"disable","manageWorkloads":"disable","networkEventsStreaming":"disable","networkPolicyService":"disable","nodeProfileService":"disable","nodeSbomGeneration":"disable","nodeScan":"enable","prometheusExporter":"disable","relevancy":"enable","runtimeDetection":"disable","runtimeObservability":"disable","scanEmbeddedSBOMs":"disable","seccompProfileService":"disable","syncSBOM":"disable","testing":{"nodeAgentMultiplication":{"enabled":false,"replicas":5}},"vexGeneration":"disable","vulnerabilityScan":"enable"},
          "components":{"autoUpdater":{"enabled":false},"clamAV":{"enabled":false},"cloudSecret":{"create":true,"name":"cloud-secret"},"customCaCertificates":{"name":"custom-ca-certificates"},"hostScanner":{"enabled":true},"kubescape":{"enabled":true},"kubescapeScheduler":{"enabled":true},"kubevuln":{"enabled":true},"kubevulnScheduler":{"enabled":true},"nodeAgent":{"enabled":true},"operator":{"enabled":true},"otelCollector":{"enabled":false},"prometheusExporter":{"enabled":false},"serviceDiscovery":{"enabled":false},"storage":{"enabled":true},"synchronizer":{"enabled":false}},
          "configurations":{"excludeJsonPaths":null,"otelUrl":"otelCollector.svc.monitoring:4317","persistence":"enable","priorityClass":{"daemonset":100000100,"enabled":true},"prometheusAnnotations":"disable"} ,
          "serviceScanConfig" :{"enabled":false,"interval":"1h"}
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-capabilities
        app.kubernetes.io/component: ks-capabilities
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: ks-capabilities
      namespace: kubescape
  5: |
    apiVersion: v1
    data:
      matchingRules.json: |
        {"match":[{"apiGroups":["apps"],"apiVersions":["v1"],"resources":["deployments"]}],"namespaces":["default"]}
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: cs-matching-rules
      namespace: kubescape
  6: |
    apiVersion: scheduling.k8s.io/v1
    description: This priority class is for node-agent daemonset pods
    globalDefault: false
    kind: PriorityClass
    metadata:
      annotations: null
      labels:
        app: kubescape-critical
        app.kubernetes.io/component: kubescape-critical
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-critical
    value: 1.000001e+08
  7: |
    apiVersion: apiextensions.k8s.io/v1
    kind: CustomResourceDefinition
    metadata:
      labels:
        app: linux-audit-rules
        app.kubernetes.io/component: linux-audit-rules
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: linuxauditrules.kubescape.io
    spec:
      group: kubescape.io
      names:
        kind: LinuxAuditRule
        plural: linuxauditrules
        shortNames:
          - lar
          - linuxauditrule
          - auditrule
        singular: linuxauditrule
      scope: Namespaced
      versions:
        - additionalPrinterColumns:
            - description: Whether the Linux audit rules are enabled
              jsonPath: .spec.enabled
              name: Enabled
              type: boolean
            - description: Number of Linux audit rules defined
              jsonPath: .status.appliedRules
              name: Rules
              type: integer
            - description: Status of the Linux audit rules
              jsonPath: .status.conditions[?(@.type=="Ready")].status
              name: Status
              type: string
            - jsonPath: .metadata.creationTimestamp
              name: Age
              type: date
          name: v1
          schema:
            openAPIV3Schema:
              properties:
                spec:
                  properties:
                    enabled:
                      default: true
                      description: Controls whether these rules should be active
                      type: boolean
                    nodeSelector:
                      additionalProperties:
                        type: string
                      description: Node selector to target specific nodes
                      type: object
                    rateLimit:
                      description: Rate limiting configuration
                      properties:
                        burstSize:
                          description: Burst size for rate limiting
                          minimum: 1
                          type: integer
                        eventsPerSecond:
                          description: Maximum events per second
                          minimum: 1
                          type: integer
                      type: object
                    rules:
                      description: List of audit rule definitions
                      items:
                        properties:
                          description:
                            description: Human-readable description of what this rule monitors
                            type: string
                          enabled:
                            default: true
                            description: Controls whether this specific rule is active
                            type: boolean
                          fileWatch:
                            description: File system monitoring rule
                            properties:
                              exclude:
                                description: Exclude patterns (basic glob patterns)
                                items:
                                  type: string
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              paths:
                                description: Paths to monitor
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              permissions:
                                description: Permissions to monitor
                                items:
                                  enum:
                                    - read
                                    - write
                                    - attr
                                    - attribute
                                    - execute
                                  type: string
                                minItems: 1
                                type: array
                              recursive:
                                default: false
                                description: Recursive monitoring (future use)
                                type: boolean
                            required:
                              - paths
                              - permissions
                              - keys
                            type: object
                          name:
                            description: Unique name of this rule within the CRD
                            type: string
                          network:
                            description: Network monitoring rule (future extension)
                            properties:
                              addresses:
                                description: Addresses to monitor
                                items:
                                  type: string
                                type: array
                              direction:
                                description: Traffic direction
                                enum:
                                  - inbound
                                  - outbound
                                  - both
                                type: string
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              ports:
                                description: Ports to monitor
                                items:
                                  maximum: 65535
                                  minimum: 1
                                  type: integer
                                type: array
                              protocols:
                                description: Protocols to monitor
                                items:
                                  enum:
                                    - tcp
                                    - udp
                                    - icmp
                                  type: string
                                type: array
                            required:
                              - keys
                            type: object
                          priority:
                            default: 100
                            description: Priority for rule ordering (lower = higher priority)
                            maximum: 1000
                            minimum: 1
                            type: integer
                          process:
                            description: Process monitoring rule
                            properties:
                              arguments:
                                description: Command line argument patterns
                                items:
                                  type: string
                                type: array
                              executables:
                                description: Executables to monitor (path patterns)
                                items:
                                  type: string
                                type: array
                              filters:
                                description: Additional filters
                                items:
                                  properties:
                                    field:
                                      description: Field to filter on
                                      type: string
                                    operator:
                                      description: Comparison operator
                                      enum:
                                        - =
                                        - '!='
                                        - <
                                        - '>'
                                        - <=
                                        - '>='
                                      type: string
                                    value:
                                      description: Value to compare against
                                      type: string
                                  required:
                                    - field
                                    - operator
                                    - value
                                  type: object
                                type: array
                              groups:
                                description: Groups to monitor
                                items:
                                  type: string
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              users:
                                description: Users to monitor
                                items:
                                  type: string
                                type: array
                            required:
                              - keys
                            type: object
                          rawRule:
                            description: Raw auditctl format rule (fallback for complex rules)
                            type: string
                          syscall:
                            description: System call monitoring rule
                            properties:
                              action:
                                default: always
                                description: Action to take
                                enum:
                                  - always
                                  - never
                                type: string
                              architecture:
                                description: Architecture filters
                                items:
                                  enum:
                                    - b64
                                    - b32
                                  type: string
                                type: array
                              filters:
                                description: Filters for syscall parameters
                                items:
                                  properties:
                                    field:
                                      description: Field to filter on
                                      enum:
                                        - pid
                                        - ppid
                                        - uid
                                        - gid
                                        - euid
                                        - egid
                                        - auid
                                        - exe
                                        - comm
                                        - key
                                        - exit
                                        - success
                                        - dir
                                        - path
                                        - perm
                                        - arch
                                        - a0
                                        - a1
                                        - a2
                                        - a3
                                        - a4
                                        - a5
                                        - a6
                                        - a7
                                        - a8
                                        - a9
                                        - a10
                                        - a11
                                        - a12
                                        - a13
                                        - a14
                                        - a15
                                      type: string
                                    operator:
                                      description: Comparison operator
                                      enum:
                                        - =
                                        - '!='
                                        - <
                                        - '>'
                                        - <=
                                        - '>='
                                      type: string
                                    value:
                                      description: Value to compare against
                                      type: string
                                  required:
                                    - field
                                    - operator
                                    - value
                                  type: object
                                maxItems: 20
                                type: array
                              keys:
                                description: Keys for identifying events from this rule (generates multiple -k flags)
                                items:
                                  type: string
                                minItems: 1
                                type: array
                              list:
                                default: exit
                                description: Audit list type
                                enum:
                                  - task
                                  - exit
                                  - user
                                  - exclude
                                type: string
                              syscalls:
                                description: System calls to monitor
                                items:
                                  type: string
                                minItems: 1
                                type: array
                            required:
                              - syscalls
                            type: object
                        required:
                          - name
                        type: object
                      type: array
                  type: object
                status:
                  properties:
                    appliedRules:
                      description: Number of rules successfully applied to the kernel
                      minimum: 0
                      type: integer
                    conditions:
                      description: Current conditions of the AuditRule
                      items:
                        properties:
                          lastTransitionTime:
                            description: Last time the condition transitioned
                            format: date-time
                            type: string
                          message:
                            description: Human-readable message about the transition
                            type: string
                          reason:
                            description: Reason for the condition's last transition
                            type: string
                          status:
                            description: Status of the condition
                            enum:
                              - "True"
                              - "False"
                              - Unknown
                            type: string
                          type:
                            description: Type of condition
                            enum:
                              - Ready
                              - Progressing
                              - Failed
                            type: string
                        required:
                          - type
                          - status
                          - lastTransitionTime
                        type: object
                      type: array
                    failedRules:
                      description: Rules that failed to apply
                      items:
                        properties:
                          error:
                            description: Error message describing the failure
                            type: string
                          lastAttempt:
                            description: When we last tried to apply this rule
                            format: date-time
                            type: string
                          name:
                            description: Name of the failed rule
                            type: string
                        required:
                          - name
                          - error
                        type: object
                      type: array
                    lastUpdated:
                      description: When the rules were last updated
                      format: date-time
                      type: string
                    observedGeneration:
                      description: Generation of the most recently observed AuditRule
                      type: integer
                  type: object
              type: object
          served: true
          storage: true
          subresources:
            status: {}
  8: |
    apiVersion: v1
    data:
      request-body.json: '{"commands":[{"CommandName":"kubescapeScan","args":{"scanV1":{}}}]}'
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: kubescape-scheduler
        app.kubernetes.io/component: kubescape-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-scheduler
      namespace: kubescape
  9: |
    apiVersion: batch/v1
    kind: CronJob
    metadata:
      annotations: null
      labels:
        app: kubescape-scheduler
        app.kubernetes.io/component: kubescape-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        armo.tier: kubescape-scan
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-scheduler
      namespace: kubescape
    spec:
      failedJobsHistoryLimit: 1
      jobTemplate:
        spec:
          template:
            metadata:
              annotations: null
              labels:
                app: kubescape-scheduler
                app.kubernetes.io/component: kubescape-scheduler
                app.kubernetes.io/instance: RELEASE-NAME
                app.kubernetes.io/managed-by: Helm
                app.kubernetes.io/name: kubescape-operator
                app.kubernetes.io/part-of: kubescape
                app.kubernetes.io/version: 1.29.9
                armo.tier: kubescape-scan
                helm.sh/chart: kubescape-operator-1.29.9
                kubescape.io/ignore: "true"
                kubescape.io/tier: core
                tier: ks-control-plane
            spec:
              affinity: null
              automountServiceAccountToken: false
              containers:
                - args:
                    - -method=post
                    - -scheme=http
                    - -host=operator:4002
                    - -path=v1/triggerAction
                    - -headers=Content-Type:application/json
                    - -path-body=/home/ks/request-body.json
                  image: quay.io/kubescape/http-request:v0.2.14
                  imagePullPolicy: IfNotPresent
                  name: kubescape-scheduler
                  resources:
                    limits:
                      cpu: 10m
                      memory: 20Mi
                    requests:
                      cpu: 1m
                      memory: 10Mi
                  securityContext:
                    allowPrivilegeEscalation: false
                    readOnlyRootFilesystem: true
                    runAsNonRoot: true
                    runAsUser: 100
                  volumeMounts:
                    - mountPath: /home/ks/request-body.json
                      name: kubescape-scheduler
                      readOnly: true
                      subPath: request-body.json
              nodeSelector:
                kubernetes.io/os: linux
              restartPolicy: Never
              securityContext:
                seccompProfile:
                  type: RuntimeDefault
              serviceAccountName: kubescape
              tolerations: null
              volumes:
                - configMap:
                    name: kubescape-scheduler
                  name: kubescape-scheduler
      schedule: 1 2 3 4 5
      successfulJobsHistoryLimit: 3
  10: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - pods
          - pods/proxy
          - namespaces
          - nodes
          - configmaps
          - services
          - serviceaccounts
          - endpoints
          - persistentvolumeclaims
          - persistentvolumes
          - limitranges
          - replicationcontrollers
          - podtemplates
          - resourcequotas
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - secrets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - admissionregistration.k8s.io
        resources:
          - mutatingwebhookconfigurations
          - validatingwebhookconfigurations
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apiregistration.k8s.io
        resources:
          - apiservices
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - deployments
          - statefulsets
          - daemonsets
          - replicasets
          - controllerrevisions
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - autoscaling
        resources:
          - horizontalpodautoscalers
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - coordination.k8s.io
        resources:
          - leases
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - discovery.k8s.io
        resources:
          - endpointslices
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - events.k8s.io
        resources:
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - hostdata.kubescape.cloud
        resources:
          - APIServerInfo
          - ControlPlaneInfo
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - networking.k8s.io
        resources:
          - networkpolicies
          - Ingress
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - cilium.io
        resources:
          - ciliumnetworkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - projectcalico.org
        resources:
          - networkpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - networking.istio.io
        resources:
          - gateways
          - virtualservices
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - security.istio.io
        resources:
          - authorizationpolicies
        verbs:
          - get
          - list
          - watch
      - apiGroups:
          - policy
        resources:
          - poddisruptionbudgets
          - podsecuritypolicies
          - PodSecurityPolicy
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - rbac.authorization.k8s.io
        resources:
          - clusterroles
          - clusterrolebindings
          - roles
          - rolebindings
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - storage.k8s.io
        resources:
          - csistoragecapacities
          - storageclasses
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - networking.k8s.io
        resources:
          - ingresses
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - extensions
        resources:
          - Ingress
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - gateway.networking.k8s.io
        resources:
          - httproutes
          - gateways
          - gatewayclasses
          - tcproutes
          - tlsroutes
          - udproutes
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - namespaces
        verbs:
          - update
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - workloadconfigurationscans
          - workloadconfigurationscansummaries
        verbs:
          - create
          - get
          - update
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
  11: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: kubescape
    subjects:
      - kind: ServiceAccount
        name: kubescape
        namespace: kubescape
  12: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: kubescape
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          annotations:
            checksum/cloud-config: 8f40f001a3e31db9895e7bbb06ab070f25ab66c83b31d1929b273cfd22402097
            checksum/cloud-secret: 3248919273cee6d6f750f97ea378fc79fff1f03b131f21d584a00258bf475a80
            checksum/host-scanner-configmap: d862cc283ddba1bc317b672c9e09bec2ce2d57b32ce0d6a5c606a08d5b93db0a
          labels:
            app: kubescape
            app.kubernetes.io/component: kubescape
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - command:
                - ksserver
              env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: KS_DOWNLOAD_ARTIFACTS
                  value: "true"
                - name: RULE_PROCESSING_GOMAXPROCS
                  value: ""
                - name: KS_DEFAULT_CONFIGMAP_NAME
                  value: kubescape-config
                - name: KS_DEFAULT_CONFIGMAP_NAMESPACE
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: KS_CONTEXT
                  value: kind-kind
                - name: KS_DEFAULT_CLOUD_CONFIGMAP_NAME
                  value: ks-cloud-config
                - name: KS_ENABLE_HOST_SCANNER
                  value: "true"
                - name: KS_SKIP_UPDATE_CHECK
                  value: "false"
                - name: KS_HOST_SCAN_YAML
                  value: /home/nonroot/.kubescape/host-scanner.yaml
                - name: LARGE_CLUSTER_SIZE
                  value: "1500"
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
              image: quay.io/kubescape/kubescape:v3.0.41
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 8080
                initialDelaySeconds: 3
                periodSeconds: 3
              name: kubescape
              ports:
                - containerPort: 8080
                  name: http
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 8080
                initialDelaySeconds: 3
                periodSeconds: 3
              resources:
                limits:
                  cpu: 600m
                  memory: 1Gi
                requests:
                  cpu: 250m
                  memory: 400Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /home/nonroot/.kubescape
                  name: kubescape-volume
                  subPath: config.json
                - mountPath: /home/nonroot/.kubescape/host-scanner.yaml
                  name: host-scanner-definition
                  subPath: host-scanner-yaml
                - mountPath: /home/nonroot/results
                  name: results
                - mountPath: /home/nonroot/failed
                  name: failed
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: kubescape
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                name: host-scanner-definition
              name: host-scanner-definition
            - emptyDir: {}
              name: kubescape-volume
            - emptyDir: {}
              name: results
            - emptyDir: {}
              name: failed
  13: |
    apiVersion: v1
    data:
      host-scanner-yaml: "apiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: host-scanner\n  namespace: kubescape\n  annotations:\n    \n  labels:\n    helm.sh/chart: kubescape-operator-1.29.9\n    app.kubernetes.io/name: kubescape-operator\n    app.kubernetes.io/instance: RELEASE-NAME\n    app.kubernetes.io/component: host-scanner\n    app.kubernetes.io/version: \"1.29.9\"\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/part-of: kubescape\n    app: host-scanner\n    tier: ks-control-plane\n    kubescape.io/ignore: \"true\"\nspec:\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: kubescape-operator\n      app.kubernetes.io/instance: RELEASE-NAME\n      app.kubernetes.io/component: host-scanner\n  template:\n    metadata:\n      annotations:\n        \n      labels:\n        helm.sh/chart: kubescape-operator-1.29.9\n        app.kubernetes.io/name: kubescape-operator\n        app.kubernetes.io/instance: RELEASE-NAME\n        app.kubernetes.io/component: host-scanner\n        app.kubernetes.io/version: \"1.29.9\"\n        app.kubernetes.io/managed-by: Helm\n        app.kubernetes.io/part-of: kubescape\n        app: host-scanner\n        tier: ks-control-plane\n        kubescape.io/ignore: \"true\"\n        kubescape.io/tier: \"core\"\n        name: host-scanner\n    spec:\n      nodeSelector:\n        kubernetes.io/os: linux\n      affinity:\n      tolerations:\n        - effect: NoSchedule\n          key: node-role.kubernetes.io/control-plane\n          operator: Exists\n        - effect: NoSchedule\n          key: node-role.kubernetes.io/master\n          operator: Exists\n      containers:\n      - name: host-sensor\n        image: \"quay.io/kubescape/host-scanner:v1.0.76\"\n        imagePullPolicy: IfNotPresent\n        securityContext:\n          allowPrivilegeEscalation: true\n          privileged: true\n          readOnlyRootFilesystem: true\n          procMount: Unmasked\n        env:\n        - name: KS_LOGGER_LEVEL\n          value: \"info\"\n        - name: KS_LOGGER_NAME\n          value: \"zap\"\n        - name: OTEL_COLLECTOR_SVC\n          value: otelCollector.svc.monitoring:4317\n        ports:\n          - name: scanner # Do not change port name\n            containerPort: 7888\n            protocol: TCP\n        resources:\n          limits:\n            cpu: 0.4m\n            memory: 400Mi\n          requests:\n            cpu: 0.1m\n            memory: 200Mi\n        volumeMounts:\n        - mountPath: /host_fs\n          name: host-filesystem\n        startupProbe:\n          httpGet:\n            path: /readyz\n            port: 7888\n          failureThreshold: 30\n          periodSeconds: 1\n        livenessProbe:\n          httpGet:\n            path: /healthz\n            port: 7888\n          periodSeconds: 10\n      terminationGracePeriodSeconds: 120\n      dnsPolicy: ClusterFirstWithHostNet\n      serviceAccountName: node-agent\n      automountServiceAccountToken: false\n      volumes:\n      - hostPath:\n          path: /\n          type: Directory\n        name: host-filesystem\n      hostPID: true\n      hostIPC: true"
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: host-scanner-definition
      namespace: kubescape
  14: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    rules:
      - apiGroups:
          - apps
        resources:
          - daemonsets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  15: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: kubescape
    subjects:
      - kind: ServiceAccount
        name: kubescape
        namespace: kubescape
  16: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
    spec:
      ports:
        - name: http
          port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  17: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: kubescape
        app.kubernetes.io/component: kubescape
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape
      namespace: kubescape
  18: |
    apiVersion: v1
    data:
      request-body.json: '{"commands":[{"commandName":"scan","designators":[{"designatorType":"Attributes","attributes":{}}]}]}'
    kind: ConfigMap
    metadata:
      labels:
        app: kubevuln-scheduler
        app.kubernetes.io/component: kubevuln-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-scheduler
      namespace: kubescape
  19: |
    apiVersion: batch/v1
    kind: CronJob
    metadata:
      annotations: null
      labels:
        app: kubevuln-scheduler
        app.kubernetes.io/component: kubevuln-scheduler
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        armo.tier: vuln-scan
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-scheduler
      namespace: kubescape
    spec:
      failedJobsHistoryLimit: 1
      jobTemplate:
        spec:
          template:
            metadata:
              annotations: null
              labels:
                app: kubevuln-scheduler
                app.kubernetes.io/component: kubevuln-scheduler
                app.kubernetes.io/instance: RELEASE-NAME
                app.kubernetes.io/managed-by: Helm
                app.kubernetes.io/name: kubescape-operator
                app.kubernetes.io/part-of: kubescape
                app.kubernetes.io/version: 1.29.9
                armo.tier: vuln-scan
                helm.sh/chart: kubescape-operator-1.29.9
                kubescape.io/ignore: "true"
                kubescape.io/tier: core
                tier: ks-control-plane
            spec:
              affinity: null
              automountServiceAccountToken: false
              containers:
                - args:
                    - -method=post
                    - -scheme=http
                    - -host=operator:4002
                    - -path=v1/triggerAction
                    - -headers=Content-Type:application/json
                    - -path-body=/home/ks/request-body.json
                  image: quay.io/kubescape/http-request:v0.2.14
                  imagePullPolicy: IfNotPresent
                  name: kubevuln-scheduler
                  resources:
                    limits:
                      cpu: 10m
                      memory: 20Mi
                    requests:
                      cpu: 1m
                      memory: 10Mi
                  securityContext:
                    allowPrivilegeEscalation: false
                    readOnlyRootFilesystem: true
                    runAsNonRoot: true
                    runAsUser: 100
                  volumeMounts:
                    - mountPath: /home/ks/request-body.json
                      name: kubevuln-scheduler
                      readOnly: true
                      subPath: request-body.json
              nodeSelector:
                kubernetes.io/os: linux
              restartPolicy: Never
              securityContext:
                seccompProfile:
                  type: RuntimeDefault
              serviceAccountName: kubevuln
              tolerations: null
              volumes:
                - configMap:
                    name: kubevuln-scheduler
                  name: kubevuln-scheduler
      schedule: 1 2 3 4 5
      successfulJobsHistoryLimit: 3
  20: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
    rules:
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - vulnerabilitymanifests
          - vulnerabilitymanifestsummaries
          - openvulnerabilityexchangecontainers
          - sbomsyfts
          - sbomsyftfiltereds
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - containerprofiles
        verbs:
          - get
          - watch
          - list
  21: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: kubevuln
    subjects:
      - kind: ServiceAccount
        name: kubevuln
        namespace: kubescape
  22: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: kubevuln
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations:
            checksum/cloud-config: 8f40f001a3e31db9895e7bbb06ab070f25ab66c83b31d1929b273cfd22402097
            checksum/cloud-secret: 3248919273cee6d6f750f97ea378fc79fff1f03b131f21d584a00258bf475a80
          labels:
            app: kubevuln
            app.kubernetes.io/component: kubevuln
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - args:
                - -alsologtostderr
                - -v=4
                - 2>&1
              env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: PRINT_POST_JSON
                  value: ""
                - name: CA_MAX_VULN_SCAN_ROUTINES
                  value: "1"
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
              image: quay.io/kubescape/kubevuln:v0.3.93
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /v1/liveness
                  port: 8080
                initialDelaySeconds: 3
                periodSeconds: 3
              name: kubevuln
              ports:
                - containerPort: 8080
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /v1/readiness
                  port: 8080
              resources:
                limits:
                  cpu: 1500m
                  ephemeral-storage: 10Gi
                  memory: 5000Mi
                requests:
                  cpu: 300m
                  ephemeral-storage: 5Gi
                  memory: 1000Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /tmp
                  name: tmp-dir
                - mountPath: /home/nonroot/anchore-resources/db
                  name: grype-db-cache
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /home/nonroot/.cache/grype
                  name: grype-db
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: kubevuln
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - emptyDir: {}
              name: tmp-dir
            - emptyDir: {}
              name: grype-db-cache
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - emptyDir: {}
              name: grype-db
  23: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
    spec:
      ports:
        - port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  24: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: kubevuln
        app.kubernetes.io/component: kubevuln
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubevuln
      namespace: kubescape
  25: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
    rules:
      - apiGroups:
          - ""
        resources:
          - nodes
          - nodes/proxy
          - services
          - endpoints
          - namespaces
          - configmaps
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - pods
        verbs:
          - get
          - watch
          - list
          - delete
      - apiGroups:
          - ""
        resources:
          - events
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - deployments
          - daemonsets
          - statefulsets
          - replicasets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - applicationprofiles
          - networkneighborhoods
          - seccompprofiles
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - containerprofiles
          - sbomsyfts
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - runtimerulealertbindings
        verbs:
          - list
          - watch
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands/status
        verbs:
          - get
          - watch
          - list
          - update
          - patch
      - apiGroups:
          - events.k8s.io
        resources:
          - events
        verbs:
          - create
          - patch
          - get
  26: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: node-agent
    subjects:
      - kind: ServiceAccount
        name: node-agent
        namespace: kubescape
  27: |
    apiVersion: v1
    data:
      config.json: |
        {
            "applicationProfileServiceEnabled": true,
            "prometheusExporterEnabled": false,
            "runtimeDetectionEnabled": false,
            "httpDetectionEnabled": false,
            "networkServiceEnabled": false,
            "malwareDetectionEnabled": false,
            "hostMalwareSensorEnabled": false,
            "hostNetworkSensorEnabled": false,
            "nodeProfileServiceEnabled": false,
            "networkStreamingEnabled": false,
            "maxImageSize": 5.36870912e+09,
            "maxSBOMSize": 2.097152e+07,
            "sbomGenerationEnabled": false,
            "enableEmbeddedSBOMs": false,
            "seccompServiceEnabled": false,
            "auditDetectionEnabled": true,
            "auditDetection": {
              "exporters": {"stdoutExporter":true},
              "eventFilter": {
                "includeTypes": [1300,1302,1309,1307,1317,1007,1327,1303,1324,1306,1404,1326]
              }
            },
            "initialDelay": "2m",
            "updateDataPeriod": "10m",
            "nodeProfileInterval": "10m",
            "networkStreamingInterval": "2m",
            "maxSniffingTimePerContainer": "24h",
            "excludeLabels":null,
            "exporters": {
              "alertManagerExporterUrls":[],
              "stdoutExporter":true,
              "syslogExporterURL": ""
            },
            "excludeJsonPaths":null,
            "ruleCooldown": {
                "ruleCooldownDuration": "1h",
                "ruleCooldownAfterCount": 1,
                "ruleCooldownOnProfileFailure": true,
                "ruleCooldownMaxSize": 20000
            }
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
  28: |
    apiVersion: apps/v1
    kind: DaemonSet
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      selector:
        matchLabels:
          app.kubernetes.io/component: node-agent
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      template:
        metadata:
          annotations:
            checksum/cloud-config: 8f40f001a3e31db9895e7bbb06ab070f25ab66c83b31d1929b273cfd22402097
            checksum/cloud-secret: 3248919273cee6d6f750f97ea378fc79fff1f03b131f21d584a00258bf475a80
            checksum/node-agent-config: 031b4ba8228571bc9b701afd31a27ee67cc5662b9c358f3393e332e6ad5ced40
          labels:
            app: node-agent
            app.kubernetes.io/component: node-agent
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity:
            nodeAffinity:
              requiredDuringSchedulingIgnoredDuringExecution:
                nodeSelectorTerms:
                  - matchExpressions:
                      - key: kubernetes.io/os
                        operator: In
                        values:
                          - linux
          automountServiceAccountToken: true
          containers:
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: HOST_ROOT
                  value: /host
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
                - name: NAMESPACE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                - name: KUBELET_ROOT
                  value: /var/lib/kubelet
                - name: NodeName
              image: quay.io/benarmosec/node-agent:test-v1
              imagePullPolicy: Always
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 7888
                initialDelaySeconds: 60
                periodSeconds: 3
              name: node-agent
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 7888
                initialDelaySeconds: 3
                periodSeconds: 3
              resources:
                limits:
                  cpu: 500m
                  memory: 1400Mi
                requests:
                  cpu: 100m
                  memory: 180Mi
              securityContext:
                capabilities:
                  add:
                    - SYS_ADMIN
                    - SYS_PTRACE
                    - NET_ADMIN
                    - SYSLOG
                    - SYS_RESOURCE
                    - IPC_LOCK
                    - NET_RAW
                    - AUDIT_READ
                    - AUDIT_WRITE
                    - AUDIT_CONTROL
                privileged: false
                runAsUser: 0
                seLinuxOptions:
                  type: spc_t
              volumeMounts:
                - mountPath: /host
                  name: host
                  readOnly: true
                - mountPath: /var/lib/kubelet
                  name: kubeletdir
                - mountPath: /run
                  name: run
                - mountPath: /var
                  name: var
                  readOnly: true
                - mountPath: /lib/modules
                  name: modules
                  readOnly: true
                - mountPath: /sys/kernel/debug
                  name: debugfs
                - mountPath: /sys/fs/cgroup
                  name: cgroup
                  readOnly: true
                - mountPath: /sys/fs/bpf
                  name: bpffs
                - mountPath: /data
                  name: data
                - mountPath: /profiles
                  name: profiles
                - mountPath: /boot
                  name: boot
                  readOnly: true
                - mountPath: /clamav
                  name: clamrun
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
          hostPID: true
          nodeSelector:
            kubernetes.io/os: linux
          priorityClassName: kubescape-critical
          securityContext:
            appArmorProfile:
              type: Unconfined
          serviceAccountName: node-agent
          tolerations: null
          volumes:
            - hostPath:
                path: /
              name: host
            - hostPath:
                path: /var/lib/kubelet
              name: kubeletdir
            - hostPath:
                path: /run
              name: run
            - hostPath:
                path: /var
              name: var
            - hostPath:
                path: /sys/fs/cgroup
              name: cgroup
            - hostPath:
                path: /lib/modules
              name: modules
            - hostPath:
                path: /sys/fs/bpf
              name: bpffs
            - hostPath:
                path: /sys/kernel/debug
              name: debugfs
            - hostPath:
                path: /boot
              name: boot
            - emptyDir: null
              name: data
            - emptyDir: null
              name: profiles
            - emptyDir: {}
              name: clamdb
            - emptyDir: {}
              name: clamrun
            - configMap:
                items:
                  - key: clamd.conf
                    path: clamd.conf
                  - key: freshclam.conf
                    path: freshclam.conf
                name: clamav
              name: etc
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: node-agent
              name: config
  29: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
    spec:
      ports:
        - name: prometheus
          port: 8080
          protocol: TCP
          targetPort: 8080
      selector:
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
  30: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: node-agent
        app.kubernetes.io/component: node-agent
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: node-agent
      namespace: kubescape
  31: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
    rules:
      - apiGroups:
          - ""
        resources:
          - pods
          - nodes
          - namespaces
          - configmaps
          - services
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - ""
        resources:
          - secrets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - jobs
          - cronjobs
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - delete
          - patch
      - apiGroups:
          - apps
        resources:
          - deployments
          - daemonsets
          - statefulsets
          - replicasets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - spdx.softwarecomposition.kubescape.io
        resources:
          - vulnerabilitymanifests
          - vulnerabilitymanifestsummaries
          - workloadconfigurationscans
          - workloadconfigurationscansummaries
          - openvulnerabilityexchangecontainers
          - containerprofiles
          - sbomsyfts
        verbs:
          - get
          - watch
          - list
          - delete
      - apiGroups:
          - kubescape.io
        resources:
          - runtimerulealertbindings
        verbs:
          - list
          - watch
          - get
      - apiGroups:
          - kubescape.io
        resources:
          - servicesscanresults
        verbs:
          - get
          - watch
          - list
          - create
          - update
          - delete
          - patch
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - kubescape.io
        resources:
          - operatorcommands/status
        verbs:
          - get
          - watch
          - list
          - update
          - patch
  32: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: operator
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  33: |
    apiVersion: v1
    data:
      config.json: |
        {
          "namespace": "kubescape",
          "triggersecurityframework": true,
          "podScanGuardTime": "1h",
          "excludeJsonPaths":null,
          "httpExporterConfig":{"maxAlertsPerMinute":1000,"method":"POST","url":"http://synchronizer:8089/apis/v1/kubescape.io"}
        }
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: operator
      namespace: kubescape
  34: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: operator
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        rollingUpdate:
          maxSurge: 0%
          maxUnavailable: 100%
        type: RollingUpdate
      template:
        metadata:
          annotations:
            checksum/capabilities-config: 557a55def7ee4932bf84312f2de4808b3c60f5c6ef9b4514025169cb8d8fa68a
            checksum/cloud-config: 8f40f001a3e31db9895e7bbb06ab070f25ab66c83b31d1929b273cfd22402097
            checksum/cloud-secret: 3248919273cee6d6f750f97ea378fc79fff1f03b131f21d584a00258bf475a80
            checksum/matching-rules-config: c81857b415602f6b161db3199a16461c5acd8ba44ec7572189441f4f294a3614
            checksum/operator-config: 08ced45878e9285cb2674068a35606be7f0ba80d4ba45d4cbc13544c5223b226
          labels:
            app: operator
            app.kubernetes.io/component: operator
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          automountServiceAccountToken: true
          containers:
            - env:
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: HELM_RELEASE
                  value: kubescape-operator-1.29.9
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
              image: quay.io/kubescape/operator:v0.2.109
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /v1/liveness
                  port: readiness-port
                initialDelaySeconds: 3
                periodSeconds: 3
              name: operator
              ports:
                - containerPort: 4002
                  name: trigger-port
                  protocol: TCP
                - containerPort: 8000
                  name: readiness-port
                  protocol: TCP
              readinessProbe:
                httpGet:
                  path: /v1/readiness
                  port: readiness-port
                initialDelaySeconds: 10
                periodSeconds: 5
              resources:
                limits:
                  cpu: 300m
                  memory: 300Mi
                requests:
                  cpu: 50m
                  memory: 100Mi
              securityContext:
                allowPrivilegeEscalation: false
                readOnlyRootFilesystem: true
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /etc/credentials
                  name: cloud-secret
                  readOnly: true
                - mountPath: /tmp
                  name: tmp-dir
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/capabilities.json
                  name: ks-capabilities
                  readOnly: true
                  subPath: capabilities.json
                - mountPath: /etc/config/matchingRules.json
                  name: cs-matching-rules
                  readOnly: true
                  subPath: matchingRules.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: operator
          tolerations: null
          volumes:
            - name: cloud-secret
              secret:
                secretName: cloud-secret
            - emptyDir: {}
              name: tmp-dir
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: capabilities
                    path: capabilities.json
                name: ks-capabilities
              name: ks-capabilities
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: operator
              name: config
            - configMap:
                items:
                  - key: matchingRules.json
                    path: matchingRules.json
                name: cs-matching-rules
              name: cs-matching-rules
  35: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: kubescape-scheduler
          namespace: kubescape
          labels:
            app: kubescape-scheduler
            tier: ks-control-plane
            kubescape.io/tier: "core"
            armo.tier: "kubescape-scan"
        spec:
          schedule: "1 2 3 4 5"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "kubescape-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  containers:
                  - name: kubescape-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubescape
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: kubescape-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubescape-cronjob-template
      namespace: kubescape
  36: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: kubevuln-scheduler
          namespace: kubescape
          labels:
            app: kubevuln-scheduler
            tier: ks-control-plane
            kubescape.io/tier: "core"
            armo.tier: "vuln-scan"
        spec:
          schedule: "1 2 3 4 5"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "vuln-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  containers:
                  - name: kubevuln-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubevuln
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: kubevuln-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: kubevuln-cronjob-template
      namespace: kubescape
  37: |
    apiVersion: v1
    data:
      cronjobTemplate: |-
        apiVersion: batch/v1
        kind: CronJob
        metadata:
          name: registry-scheduler
          namespace: kubescape
          labels:
            app: registry-scheduler
            kubescape.io/tier: "core"
            tier: ks-control-plane
            armo.tier: "registry-scan"
        spec:
          schedule: "0 0 * * *"
          successfulJobsHistoryLimit: 3
          failedJobsHistoryLimit: 1
          jobTemplate:
            spec:
              template:
                metadata:
                  labels:
                    armo.tier: "registry-scan"
                    kubescape.io/tier: "core"
                spec:
                  securityContext:
                    seccompProfile:
                      type: RuntimeDefault
                  containers:
                  - name: registry-scheduler
                    image: "quay.io/kubescape/http-request:v0.2.14"
                    imagePullPolicy: IfNotPresent
                    securityContext:
                      allowPrivilegeEscalation: false
                      readOnlyRootFilesystem: true
                      runAsNonRoot: true
                      runAsUser: 100
                    resources:
                      limits:
                        cpu: 10m
                        memory: 20Mi
                      requests:
                        cpu: 1m
                        memory: 10Mi
                    args:
                      - -method=post
                      - -scheme=http
                      - -host=operator:4002
                      - -path=v1/triggerAction
                      - -headers=Content-Type:application/json
                      - -path-body=/home/ks/request-body.json
                    volumeMounts:
                      - name: "request-body-volume"
                        mountPath: /home/ks/request-body.json
                        subPath: request-body.json
                        readOnly: true
                  restartPolicy: Never
                  serviceAccountName: kubevuln
                  automountServiceAccountToken: false
                  nodeSelector:
                    kubernetes.io/os: linux
                  affinity:
                  tolerations:
                  volumes:
                    - name: "request-body-volume" # placeholder
                      configMap:
                        name: registry-scheduler
    kind: ConfigMap
    metadata:
      annotations: null
      labels:
        app: ks-cloud-config
        app.kubernetes.io/component: ks-cloud-config
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: registry-scan-cronjob-template
      namespace: kubescape
  38: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: Role
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    rules:
      - apiGroups:
          - ""
        resources:
          - configmaps
          - secrets
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
      - apiGroups:
          - batch
        resources:
          - cronjobs
        verbs:
          - create
          - get
          - update
          - watch
          - list
          - patch
          - delete
  39: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: operator
    subjects:
      - kind: ServiceAccount
        name: operator
        namespace: kubescape
  40: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
    spec:
      ports:
        - port: 4002
          protocol: TCP
          targetPort: 4002
      selector:
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
      type: ClusterIP
  41: |
    apiVersion: v1
    automountServiceAccountToken: false
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: operator
        app.kubernetes.io/component: operator
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: operator
      namespace: kubescape
  42: |
    apiVersion: apiregistration.k8s.io/v1
    kind: APIService
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: v1beta1.spdx.softwarecomposition.kubescape.io
    spec:
      caBundle: bW9jay1jYS1jZXJ0
      group: spdx.softwarecomposition.kubescape.io
      groupPriorityMinimum: 1000
      service:
        name: storage
        namespace: kubescape
      version: v1beta1
      versionPriority: 15
  43: |
    apiVersion: v1
    data:
      ca.crt: bW9jay1jYS1jZXJ0
      tls.crt: bW9jay1jZXJ0LWNlcnQ=
      tls.key: bW9jay1jZXJ0LWtleQ==
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage-ca
      namespace: kubescape
    type: kubernetes.io/tls
  44: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRole
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
    rules:
      - apiGroups:
          - ""
        resources:
          - namespaces
          - pods
          - services
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - admissionregistration.k8s.io
        resources:
          - mutatingwebhookconfigurations
          - validatingwebhookconfigurations
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - apps
        resources:
          - daemonsets
          - deployments
          - replicasets
          - statefulsets
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - batch
        resources:
          - cronjobs
          - jobs
        verbs:
          - get
          - watch
          - list
      - apiGroups:
          - flowcontrol.apiserver.k8s.io
        resources:
          - prioritylevelconfigurations
          - flowschemas
        verbs:
          - get
          - watch
          - list
  45: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage:system:auth-delegator
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: system:auth-delegator
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  46: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: ClusterRoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: ClusterRole
      name: storage
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  47: |
    apiVersion: v1
    data:
      config.json: |
        {
          "cleanupInterval": "6h",
          "disableVirtualCRDs": false,
          "excludeJsonPaths": null,
          "defaultQueueLength": 100,
          "defaultWorkerCount": 2,
          "defaultMaxObjectSize": 400000,
          "queueManagerEnabled": true,
          "kindQueues": {"applicationprofiles":{"maxObjectSize":20000000,"queueLength":50,"workerCount":2},"containerprofiles":{"maxObjectSize":2500000,"queueLength":50,"workerCount":2},"networkneighborhoods":{"maxObjectSize":10000000,"queueLength":50,"workerCount":2},"openvulnerabilityexchangecontainers":{"maxObjectSize":500000,"queueLength":50,"workerCount":1},"sbomsyftfiltereds":{"maxObjectSize":50000000,"queueLength":50,"workerCount":1},"sbomsyfts":{"maxObjectSize":100000000,"queueLength":50,"workerCount":1},"vulnerabilitymanifests":{"maxObjectSize":50000000,"queueLength":50,"workerCount":1}},
          "tlsClientCaFile": "/var/run/secrets/kubernetes.io/serviceaccount/ca.crt",
          "tlsServerCertFile": "/etc/storage-ca-certificates/tls.crt",
          "tlsServerKeyFile": "/etc/storage-ca-certificates/tls.key",
          "serverBindPort": "8443"
        }
    kind: ConfigMap
    metadata:
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: storage
      namespace: kubescape
  48: |
    apiVersion: apps/v1
    kind: Deployment
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        kubescape.io/tier: core
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      replicas: 1
      revisionHistoryLimit: 2
      selector:
        matchLabels:
          app.kubernetes.io/component: storage
          app.kubernetes.io/instance: RELEASE-NAME
          app.kubernetes.io/name: kubescape-operator
      strategy:
        type: Recreate
      template:
        metadata:
          annotations: null
          labels:
            app: storage
            app.kubernetes.io/component: storage
            app.kubernetes.io/instance: RELEASE-NAME
            app.kubernetes.io/managed-by: Helm
            app.kubernetes.io/name: kubescape-operator
            app.kubernetes.io/part-of: kubescape
            app.kubernetes.io/version: 1.29.9
            helm.sh/chart: kubescape-operator-1.29.9
            kubescape.io/ignore: "true"
            kubescape.io/tier: core
            tier: ks-control-plane
        spec:
          affinity: null
          containers:
            - env:
                - name: GOMEMLIMIT
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.memory
                - name: GOMAXPROCS
                  valueFrom:
                    resourceFieldRef:
                      divisor: "1"
                      resource: limits.cpu
                - name: KS_LOGGER_LEVEL
                  value: info
                - name: KS_LOGGER_NAME
                  value: zap
                - name: OTEL_COLLECTOR_SVC
                  value: otelCollector.svc.monitoring:4317
              image: quay.io/kubescape/storage:v0.0.220
              imagePullPolicy: IfNotPresent
              livenessProbe:
                httpGet:
                  path: /livez
                  port: 8443
                  scheme: HTTPS
              name: apiserver
              readinessProbe:
                httpGet:
                  path: /readyz
                  port: 8443
                  scheme: HTTPS
              resources:
                limits:
                  cpu: 1500m
                  memory: 1500Mi
                requests:
                  cpu: 100m
                  memory: 400Mi
              securityContext:
                allowPrivilegeEscalation: false
                runAsNonRoot: true
              volumeMounts:
                - mountPath: /data
                  name: data
                - mountPath: /etc/config/clusterData.json
                  name: ks-cloud-config
                  readOnly: true
                  subPath: clusterData.json
                - mountPath: /etc/config/config.json
                  name: config
                  readOnly: true
                  subPath: config.json
                - mountPath: /etc/storage-ca-certificates
                  name: ca-certificates
                  readOnly: true
          nodeSelector:
            kubernetes.io/os: linux
          securityContext:
            fsGroup: 65532
            runAsUser: 65532
            seccompProfile:
              type: RuntimeDefault
          serviceAccountName: storage
          tolerations: null
          volumes:
            - name: data
              persistentVolumeClaim:
                claimName: kubescape-storage
            - configMap:
                items:
                  - key: clusterData
                    path: clusterData.json
                name: ks-cloud-config
              name: ks-cloud-config
            - configMap:
                items:
                  - key: config.json
                    path: config.json
                name: storage
              name: config
            - name: ca-certificates
              secret:
                secretName: storage-ca
  49: |
    apiVersion: v1
    kind: PersistentVolumeClaim
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-storage
      namespace: kubescape
    spec:
      accessModes:
        - ReadWriteOnce
      resources:
        requests:
          storage: 5Gi
  50: |
    apiVersion: rbac.authorization.k8s.io/v1
    kind: RoleBinding
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage-auth-reader
      namespace: kube-system
    roleRef:
      apiGroup: rbac.authorization.k8s.io
      kind: Role
      name: extension-apiserver-authentication-reader
    subjects:
      - kind: ServiceAccount
        name: storage
        namespace: kubescape
  51: |
    apiVersion: v1
    kind: Service
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
    spec:
      ports:
        - name: https
          port: 443
          protocol: TCP
          targetPort: 8443
      selector:
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/name: kubescape-operator
  52: |
    apiVersion: v1
    kind: ServiceAccount
    metadata:
      annotations: null
      labels:
        app: storage
        app.kubernetes.io/component: storage
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: storage
      namespace: kubescape
with image pull secret generated:
  1: |
    apiVersion: v1
    data:
      .dockerconfigjson: eyJhdXRocyI6eyJxdWF5LmlvIjp7InVzZXJuYW1lIjoiZm9vIiwicGFzc3dvcmQiOiJ4eHh4eHh4IiwiZW1haWwiOiIiLCJhdXRoIjoiWm05dk9uaDRlSGg0ZUhnPSJ9fX0=
    kind: Secret
    metadata:
      name: quay-secret
      namespace: kubescape
    type: kubernetes.io/dockerconfigjson
with multiple private registry credentials:
  1: |
    apiVersion: v1
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: kubescape-registry-scan-secrets
        app.kubernetes.io/component: kubescape-registry-scan-secrets
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-registry-scan-secrets
      namespace: kubescape
    stringData:
      registriesAuth: |
        [
          {
            "registry": "foo.example.com",
            "username": "bar",
            "password": "baz",
            "skipTLSVerify": true,
            "auth_method": "credentials"
          },
          {
            "registry": "test.example.com",
            "username": "xxx",
            "password": "yyy",
            "http": true,
            "auth_method": "credentials"
          }
        ]
    type: Opaque
with single private registry credentials:
  1: |
    apiVersion: v1
    kind: Secret
    metadata:
      annotations: null
      labels:
        app: kubescape-registry-scan-secrets
        app.kubernetes.io/component: kubescape-registry-scan-secrets
        app.kubernetes.io/instance: RELEASE-NAME
        app.kubernetes.io/managed-by: Helm
        app.kubernetes.io/name: kubescape-operator
        app.kubernetes.io/part-of: kubescape
        app.kubernetes.io/version: 1.29.9
        helm.sh/chart: kubescape-operator-1.29.9
        kubescape.io/ignore: "true"
        tier: ks-control-plane
      name: kubescape-registry-scan-secrets
      namespace: kubescape
    stringData:
      registriesAuth: |
        [
          {
            "registry": "foo.example.com",
            "username": "bar",
            "password": "baz",
            "auth_method": "credentials"
          }
        ]
    type: Opaque
