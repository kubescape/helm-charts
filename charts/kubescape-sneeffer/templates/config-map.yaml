{{- if .Values.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Values.sneefferConfigMap }}
  namespace: {{ .Values.sneefferNamespace }}
data:
  SneefferConfigurationFile.txt: |
    innerDataDirPath=/etc/sneeffer/data
    kernelObjPath=/etc/sneeffer/resources/ebpf/kernel_obj.o
    snifferEngineLoaderPath=/etc/sneeffer/resources/ebpf/sniffer
    sbomCreatorPath=/etc/sneeffer/resources/sbom/syft
    vulnCreatorPath=/etc/sneeffer/resources/vuln/grype
    snifferTime=5
    loggerVerbose=INFO
    crdFullDetailedPath=/etc/sneeffer/resources/k8s/crd-vuln-full-detailes.yaml
    crdVulnSummaryPath=/etc/sneeffer/resources/k8s/crd-vuln-summary.yaml
{{- end}}